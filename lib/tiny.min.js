!function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var i={};e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=26)}([function(t,e){Tiny.CanvasRenderer=function(t,e,i){i=i||{},this.resolution=void 0!=i.resolution?i.resolution:1,this.clearBeforeRender=void 0==i.clearBeforeRender||i.clearBeforeRender,this.transparent=void 0!=i.transparent&&i.transparent,this.autoResize=i.autoResize||!1,this.width=t||800,this.height=e||600,this.width*=this.resolution,this.height*=this.resolution,this.view=i.view||document.createElement("canvas"),this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.view.width=this.width*this.resolution,this.view.height=this.height*this.resolution,this.count=0,Tiny.CanvasMaskManager&&(this.maskManager=new Tiny.CanvasMaskManager),this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:0,smoothProperty:null,roundPixels:!1},this.mapBlendModes(),this.resize(t,e),"imageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="oImageSmoothingEnabled":"msImageSmoothingEnabled"in this.context&&(this.renderSession.smoothProperty="msImageSmoothingEnabled")},Tiny.CanvasRenderer.prototype.constructor=Tiny.CanvasRenderer,Tiny.CanvasRenderer.prototype.render=function(t){t.updateTransform(),this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.renderSession.currentBlendMode=Tiny.blendModes.NORMAL,this.context.globalCompositeOperation=Tiny.blendModesCanvas[Tiny.blendModes.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):(this.context.fillStyle=t.backgroundColorString,this.context.fillRect(0,0,this.width,this.height))),this.renderDisplayObject(t)},Tiny.CanvasRenderer.prototype.destroy=function(t){void 0===t&&(t=!0),t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.view=null,this.context=null,this.maskManager=null,this.renderSession=null},Tiny.CanvasRenderer.prototype.resize=function(t,e){this.width=t*this.resolution,this.height=e*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px")},Tiny.CanvasRenderer.prototype.renderDisplayObject=function(t,e){this.renderSession.context=e||this.context,this.renderSession.resolution=this.resolution,t._renderCanvas(this.renderSession)},Tiny.CanvasRenderer.prototype.mapBlendModes=function(){Tiny.blendModesCanvas||(Tiny.blendModesCanvas=[],Tiny.blendModesCanvas[Tiny.blendModes.NORMAL]="source-over")}},function(t,e){Tiny.Input=function(t){this.game=t,this._active_objects=[],this.clickHandler_bind=this.clickHandler.bind(this),this.upHandler_bind=this.upHandler.bind(this),this.downHandler_bind=this.downHandler.bind(this),this.moveHandler_bind=this.moveHandler.bind(this),this.lastMove=null,this.isDown=!1;var e=this.game.canvas.addEventListener;e("touchstart",this.downHandler_bind),e("touchmove",this.moveHandler_bind),e("touchend",this.upHandler_bind),e("touchcancel",this.upHandler_bind),e("mousedown",this.downHandler_bind),e("mousemove",this.moveHandler_bind),e("mouseup",this.upHandler_bind),Tiny.EventTarget.mixin(this)},Tiny.Input.prototype={destroy:function(){var t=this.game.canvas.removeEventListener;t("touchstart",this.downHandler_bind),t("touchmove",this.moveHandler_bind),t("touchend",this.upHandler_bind),t("touchcancel",this.upHandler_bind),t("mousedown",this.downHandler_bind),t("mousemove",this.moveHandler_bind),t("mouseup",this.upHandler_bind)},_checkOnActiveObjects:function(t,e,i){if(t.inputEnabled&&t.worldVisible&&t.getBounds().contains(e,i)&&this._active_objects.push(t),t.children&&t.children.length>0)for(var n=0;n<t.children.length;n++)this._checkOnActiveObjects(t.children[n],e,i)},_getCoords:function(t,e){var i=null;return"undefined"!=typeof TouchEvent&&t instanceof TouchEvent?(this.listeningToTouchEvents=!0,t.touches.length>0?i={x:t.touches[0].pageX,y:t.touches[0].pageY}:t.pageX&&t.pageY&&(i={x:t.pageX,y:t.pageY})):i={x:t.pageX,y:t.pageY},this.listeningToTouchEvents&&t instanceof MouseEvent||null===i?null:i=this.windowToUISpace(i.x,i.y,e)},inputHandler:function(t,e,i){var n=this._getCoords(e,i);if(null!==n){if("move"!=t){this._active_objects=[],this._checkOnActiveObjects(this.game.stage,n.x,n.y);var s=this._active_objects.length;if(s>0){var r=this._active_objects[s-1];if(r.input["last_"+t]={x:n.x,y:n.y},r.input.emit(t,{x:n.x,y:n.y}),"up"==t){var h=r.input.last_down;h&&Tiny.Math.distance(h.x,h.y,n.x,n.y)<30&&r.input.emit("click",{x:n.x,y:n.y})}}}this.emit(t,{x:n.x,y:n.y})}},moveHandler:function(t){this.lastMove=t,this.inputHandler("move",t,!0)},upHandler:function(t){this.isDown=!1,this.inputHandler("up",this.lastMove,!0)},downHandler:function(t){this.isDown=!0,this.lastMove=t,this.inputHandler("down",t,!1)},clickHandler:function(t){this.inputHandler("click",t,!1)},windowToUISpace:function(t,e,i){var n=i&&this._last_bounds?this._last_bounds:(this._last_bounds=this.game.canvas.getBoundingClientRect(),this._last_bounds);return{x:t-n.left,y:e-n.top}}}},function(t,e){Tiny.Loader=function(t){this.game=t,this.cache=[]},Tiny.Loader.loadSpriteSheet=function(t,e){for(var i=e.length-1,n=0;n<=i;n++){var s=t+"_"+n;Tiny.TextureCache[s]=new Tiny.Texture(Tiny.BaseTextureCache[t],{index:n,x:Math.floor(e[n].x),y:Math.floor(e[n].y),width:Math.floor(e[n].width),height:Math.floor(e[n].height),duration:e[n].duration}),Tiny.TextureCache[s].key=t,Tiny.TextureCache[s].max_no_frame=i}return i},Tiny.Loader.parseSpriteSheet=function(t,e,i,n){var s=Tiny.BaseTextureCache[t],r=s.width,h=s.height;e<=0&&(e=Math.floor(-r/Math.min(-1,e))),i<=0&&(i=Math.floor(-h/Math.min(-1,i)));var o=Math.floor(r/e),a=Math.floor(h/i),c=o*a;if(console.log(c),0===c)return null;for(var l=0,u=0,p=c-1,d={},y=0;y<c;y++){d={index:y,x:l,y:u,width:e,height:i,duration:n};var f=t+"_"+y;Tiny.TextureCache[f]=new Tiny.Texture(s,d),Tiny.TextureCache[f].key=t,Tiny.TextureCache[f].max_no_frame=p,l+=e,l+e>r&&(l=0,u+=i)}return p},Tiny.Loader.loadAtlas=function(t,e){for(var i=0;i<e.length;i++){var n=t+"_"+e[i].name;Tiny.TextureCache[n]=new Tiny.Texture(Tiny.BaseTextureCache[t],e[i]),Tiny.TextureCache[n].key=t}},Tiny.Loader.prototype={image:function(t,e){this.cache.push({src:e,key:t,cb:function(){}})},spritesheet:function(t,e,i,n,s){this.cache.push({src:e,key:t,cb:function(){"number"==typeof i?Tiny.TextureCache[t].max_no_frame=Tiny.Loader.parseSpriteSheet(t,i,n,s):i.length>0&&(Tiny.TextureCache[t].max_no_frame=Tiny.Loader.loadSpriteSheet(t,i))}})},atlas:function(t,e,i){this.cache.push({src:e,key:t,cb:function(){Tiny.Loader.loadAtlas(t,i)}})},start:function(t){function e(){function s(){Tiny.BaseTextureCache[h.key]=new Tiny.BaseTexture(o),Tiny.TextureCache[h.key]=new Tiny.Texture(Tiny.BaseTextureCache[h.key]),Tiny.TextureCache[h.key].key=h.key,h.cb(),r||(o.onload=null,r=!0,0!=n.length?e():t.call(i))}var r=!1,h=n.shift(),o=new Image;o.onload=s,o.src=h.src}var i=this.game,n=this.cache;if(0==n.length)return void t.call(i);e()}}},function(t,e){Tiny.ObjectCreator=function(t){this.game=t},Tiny.ObjectCreator.prototype={group:function(t,e){var i=new Tiny.DisplayObjectContainer;return this.game.stage.addChild(i),i.x=t||0,i.y=e||0,i},sprite:function(t,e,i,n){var s=null;if("string"==typeof i?(n&&(i=i+"_"+n),s=Tiny.TextureCache[i]):s=i,!s)throw new Error("Cache Error: image "+i+" does`t found in cache");s.max_no_frame&&(s=Tiny.TextureCache[s.key+"_0"]);var r=new Tiny.Sprite(s);return this.game.stage.addChild(r),r.x=t||0,r.y=e||0,r},text:function(t,e,i,n){var i=new Tiny.Text(i,n);return this.game.stage.addChild(i),i.x=t||0,i.y=e||0,i},tileSprite:function(t,e,i,n,s,r){var h=null;if("string"==typeof s?(r&&(s=s+"_"+r),h=Tiny.TextureCache[s]):h=s,!h)throw new Error("Cache Error: image "+s+" does`t found in cache");var o=new Tiny.TilingSprite(h,i,n);return this.game.stage.addChild(o),o.x=t||0,o.y=e||0,o},graphics:function(t,e){var i=new Tiny.Graphics;return this.game.stage.addChild(i),i.x=t||0,i.y=e||0,i}}},function(t,e){var i=function(t,e,n,s,r){this.parentNode=n||document.body,this.canvas=document.createElement("canvas"),this.scale=i.ScaleManager.NORMAL,this.height=e||720,this.width=t||430,this.stage=new i.Stage,this.stage.game=this,this.renderer=new i.CanvasRenderer(this.width,this.height,{view:this.canvas,autoResize:!0}),i.defaultRenderer=this.renderer,this.callbackContext=null,r=r||{},this.state=0,this._preload_cb=this._preload_cb||r.preload||function(){},this._create_cb=this._create_cb||r.create||function(){},this._update_cb=this._update_cb||r.update||function(){},this._resize_cb=this._resize_cb||r.resize||function(){},this._destroy_cb=this._destroy_cb||r.destroy||function(){},i.Loader&&(this.load=new i.Loader(this)),i.ObjectCreator&&(this.add=new i.ObjectCreator(this)),i.Input&&(this.input=new i.Input(this)),i.TimerCreator&&(this.timer=new i.TimerCreator(this)),this.addCanvasToDom(),this._self_raf=s&&i.RAF,this._self_raf&&(this._raf=new i.RAF(this)),this.time={timeToCall:15},this.paused=!1,this.pauseDuration=0;var h=this;setTimeout(function(){h.preload()},0)};i.prototype.addCanvasToDom=function(){this.parentNode.appendChild(this.canvas),this.canvas.style.position="absolute",this.canvas.style.top="0px",this.canvas.style.left="0px",this.canvas.style.transformOrigin="0% 0%",this.canvas.style.perspective="1000px"},i.prototype.setPixelRatio=function(t){this.renderer.resolution=t,this.resize()},i.prototype.resize=function(t,e){this.width=t||this.width,this.height=e||this.height,this.renderer.resize(this.width,this.height),this.state>0&&this._resize_cb.call(this.callbackContext,this.width,this.height)},i.prototype.setSize=i.prototype.resize,i.prototype.render=function(){this.renderer.render(this.stage)},i.prototype.preload=function(){this._preload_cb.call(this.callbackContext),this.state=1,i.Loader?this.load.start(this.create):this.create()},i.prototype.create=function(){this._create_cb.call(this.callbackContext),this._self_raf&&this._raf.start(),this.state=2},i.prototype.update=function(t,e){this.paused?this.pauseDuration+=e:(this._update_cb.call(this.callbackContext,t,e),i._tween_enabled&&TWEEN.update(),this.timers&&this.timers.forEach(function(t){t.update(e)}),this.render())},i.prototype.pause=function(){this.paused=!0},i.prototype.resume=function(){this.paused=!1},i.prototype.stop=i.prototype.pause,i.prototype.play=i.prototype.resume,i.prototype.destroy=function(){i.Input&&this.input.destroy(),i._tween_enabled&&TWEEN.removeAll(),this.timers&&this.timer.removeAll(),this.paused=!0,this.stage.destroy();for(var t in i.TextureCache)i.TextureCache[t].destroy(!0);for(var t in i.BaseTextureCache)i.BaseTextureCache[t].destroy();i.BaseTextureCache=[],i.TextureCache=[],this.stage.children=[],this.update(),this.renderer.destroy(!0),this._self_raf&&this._raf.stop(),this.canvas=void 0,this._destroy_cb.call(this.callbackContext)},t.exports=i,window.Tiny=i},function(t,e){Tiny.CanvasGraphics=function(){},Tiny.CanvasGraphics.renderGraphics=function(t,e){var i=t.worldAlpha;t.dirty&&(this.updateGraphicsTint(t),t.dirty=!1);for(var n=0;n<t.graphicsData.length;n++){var s=t.graphicsData[n],r=s.shape,h=s._fillTint,o=s._lineTint;if(e.lineWidth=s.lineWidth,s.type===Tiny.Primitives.POLY){e.beginPath();var a=r.points;e.moveTo(a[0],a[1]);for(var c=1;c<a.length/2;c++)e.lineTo(a[2*c],a[2*c+1]);r.closed&&e.lineTo(a[0],a[1]),a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&e.closePath(),s.fill&&(e.globalAlpha=s.fillAlpha*i,e.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),e.fill()),s.lineWidth&&(e.globalAlpha=s.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|o).toString(16)).substr(-6),e.stroke())}else if(s.type===Tiny.Primitives.RECT)(s.fillColor||0===s.fillColor)&&(e.globalAlpha=s.fillAlpha*i,e.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),e.fillRect(r.x,r.y,r.width,r.height)),s.lineWidth&&(e.globalAlpha=s.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|o).toString(16)).substr(-6),e.strokeRect(r.x,r.y,r.width,r.height));else if(s.type===Tiny.Primitives.CIRC)e.beginPath(),e.arc(r.x,r.y,r.radius,0,2*Math.PI),e.closePath(),s.fill&&(e.globalAlpha=s.fillAlpha*i,e.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),e.fill()),s.lineWidth&&(e.globalAlpha=s.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|o).toString(16)).substr(-6),e.stroke());else if(s.type===Tiny.Primitives.ELIP){var l=2*r.width,u=2*r.height,p=r.x-l/2,d=r.y-u/2;e.beginPath();var y=l/2*.5522848,f=u/2*.5522848,T=p+l,g=d+u,m=p+l/2,_=d+u/2;e.moveTo(p,_),e.bezierCurveTo(p,_-f,m-y,d,m,d),e.bezierCurveTo(m+y,d,T,_-f,T,_),e.bezierCurveTo(T,_+f,m+y,g,m,g),e.bezierCurveTo(m-y,g,p,_+f,p,_),e.closePath(),s.fill&&(e.globalAlpha=s.fillAlpha*i,e.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),e.fill()),s.lineWidth&&(e.globalAlpha=s.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|o).toString(16)).substr(-6),e.stroke())}else if(s.type===Tiny.Primitives.RREC){var v=r.x,x=r.y,b=r.width,w=r.height,C=r.radius,S=Math.min(b,w)/2|0;C=C>S?S:C,e.beginPath(),e.moveTo(v,x+C),e.lineTo(v,x+w-C),e.quadraticCurveTo(v,x+w,v+C,x+w),e.lineTo(v+b-C,x+w),e.quadraticCurveTo(v+b,x+w,v+b,x+w-C),e.lineTo(v+b,x+C),e.quadraticCurveTo(v+b,x,v+b-C,x),e.lineTo(v+C,x),e.quadraticCurveTo(v,x,v,x+C),e.closePath(),(s.fillColor||0===s.fillColor)&&(e.globalAlpha=s.fillAlpha*i,e.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),e.fill()),s.lineWidth&&(e.globalAlpha=s.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|o).toString(16)).substr(-6),e.stroke())}else if(s.type===Tiny.Primitives.RREC_LJOIN){var v=r.x,x=r.y,b=r.width,w=r.height,C=r.radius;(s.fillColor||0===s.fillColor)&&(e.globalAlpha=s.fillAlpha*i,e.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),e.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6)),e.lineJoin="round",e.lineWidth=C,e.strokeRect(v+C/2,x+C/2,b-C,w-C),e.fillRect(v+C/2,x+C/2,b-C,w-C)}}},Tiny.CanvasGraphics.renderGraphicsMask=function(t,e){var i=t.graphicsData.length;if(0!==i){e.beginPath();for(var n=0;n<i;n++){var s=t.graphicsData[n],r=s.shape;if(s.type===Tiny.Primitives.POLY){var h=r.points;e.moveTo(h[0],h[1]);for(var o=1;o<h.length/2;o++)e.lineTo(h[2*o],h[2*o+1]);h[0]===h[h.length-2]&&h[1]===h[h.length-1]&&e.closePath()}else if(s.type===Tiny.Primitives.RECT)e.rect(r.x,r.y,r.width,r.height),e.closePath();else if(s.type===Tiny.Primitives.CIRC)e.arc(r.x,r.y,r.radius,0,2*Math.PI),e.closePath();else if(s.type===Tiny.Primitives.ELIP){var a=2*r.width,c=2*r.height,l=r.x-a/2,u=r.y-c/2,p=a/2*.5522848,d=c/2*.5522848,y=l+a,f=u+c,T=l+a/2,g=u+c/2;e.moveTo(l,g),e.bezierCurveTo(l,g-d,T-p,u,T,u),e.bezierCurveTo(T+p,u,y,g-d,y,g),e.bezierCurveTo(y,g+d,T+p,f,T,f),e.bezierCurveTo(T-p,f,l,g+d,l,g),e.closePath()}else if(s.type===Tiny.Primitives.RREC||s.type===Tiny.Primitives.RREC_LJOIN){var m=r.x,_=r.y,v=r.width,x=r.height,b=r.radius,w=Math.min(v,x)/2|0;b=b>w?w:b,e.moveTo(m,_+b),e.lineTo(m,_+x-b),e.quadraticCurveTo(m,_+x,m+b,_+x),e.lineTo(m+v-b,_+x),e.quadraticCurveTo(m+v,_+x,m+v,_+x-b),e.lineTo(m+v,_+b),e.quadraticCurveTo(m+v,_,m+v-b,_),e.lineTo(m+b,_),e.quadraticCurveTo(m,_,m,_+b),e.closePath()}}}},Tiny.CanvasGraphics.updateGraphicsTint=function(t){if(16777215!==t.tint)for(var e=(t.tint>>16&255)/255,i=(t.tint>>8&255)/255,n=(255&t.tint)/255,s=0;s<t.graphicsData.length;s++){var r=t.graphicsData[s],h=0|r.fillColor,o=0|r.lineColor;r._fillTint=((h>>16&255)/255*e*255<<16)+((h>>8&255)/255*i*255<<8)+(255&h)/255*n*255,r._lineTint=((o>>16&255)/255*e*255<<16)+((o>>8&255)/255*i*255<<8)+(255&o)/255*n*255}}},function(t,e){Tiny.DisplayObject=function(){this.position=new Tiny.Point(0,0),this.scale=new Tiny.Point(1,1),this.transformCallback=null,this.transformCallbackContext=null,this.pivot=new Tiny.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.hitArea=null,this.renderable=!1,this.parent=null,this.stage=null,this.worldAlpha=1,this.worldTransform=new Tiny.Matrix,this._sr=0,this._cr=1,this._bounds=new Tiny.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null,this._cacheAsBitmap=!1,this._cacheIsDirty=!1,this.input=null},Object.defineProperty(Tiny.DisplayObject.prototype,"inputEnabled",{get:function(){return this.input&&this.input.enabled},set:function(t){t?null===this.input?(this.input={enabled:!0,parent:this},Tiny.EventTarget.mixin(this.input)):this.input.enabled=!0:null!==this.input&&(this.input.enabled=!1)}}),Tiny.DisplayObject.prototype.constructor=Tiny.DisplayObject,Tiny.DisplayObject.prototype.destroy=function(){if(this.children){for(var t=this.children.length;t--;)this.children[t].destroy();this.children=[]}this.transformCallback=null,this.transformCallbackContext=null,this.hitArea=null,this.parent=null,this.stage=null,this.worldTransform=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.renderable=!1,this._destroyCachedSprite()},Object.defineProperty(Tiny.DisplayObject.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}}),Object.defineProperty(Tiny.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(t){this._mask&&(this._mask.isMask=!1),this._mask=t,this._mask&&(this._mask.isMask=!0)}}),Object.defineProperty(Tiny.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap!==t&&(t?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=t)}}),Tiny.DisplayObject.prototype.updateTransform=function(){if(this.parent){var t,e,i,n,s,r,h=this.parent.worldTransform,o=this.worldTransform;this.rotation%Tiny.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),t=this._cr*this.scale.x,e=this._sr*this.scale.x,i=-this._sr*this.scale.y,n=this._cr*this.scale.y,s=this.position.x,r=this.position.y,(this.pivot.x||this.pivot.y)&&(s-=this.pivot.x*t+this.pivot.y*i,r-=this.pivot.x*e+this.pivot.y*n),o.a=t*h.a+e*h.c,o.b=t*h.b+e*h.d,o.c=i*h.a+n*h.c,o.d=i*h.b+n*h.d,o.tx=s*h.a+r*h.c+h.tx,o.ty=s*h.b+r*h.d+h.ty):(t=this.scale.x,n=this.scale.y,s=this.position.x-this.pivot.x*t,r=this.position.y-this.pivot.y*n,o.a=t*h.a,o.b=t*h.b,o.c=n*h.c,o.d=n*h.d,o.tx=s*h.a+r*h.c+h.tx,o.ty=s*h.b+r*h.d+h.ty),this.worldAlpha=this.alpha*this.parent.worldAlpha,this.transformCallback&&this.transformCallback.call(this.transformCallbackContext,o,h)}},Tiny.DisplayObject.prototype.displayObjectUpdateTransform=Tiny.DisplayObject.prototype.updateTransform,Tiny.DisplayObject.prototype.getBounds=function(t){return t=t,Tiny.EmptyRectangle},Tiny.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(Tiny.identityMatrix)},Tiny.DisplayObject.prototype.setStageReference=function(t){this.stage=t},Tiny.DisplayObject.prototype.preUpdate=function(){},Tiny.DisplayObject.prototype.generateTexture=function(t,e,i){var n=this.getLocalBounds(),s=new Tiny.RenderTexture(0|n.width,0|n.height,i,e,t);return Tiny.DisplayObject._tempMatrix.tx=-n.x,Tiny.DisplayObject._tempMatrix.ty=-n.y,s.render(this,Tiny.DisplayObject._tempMatrix),s},Tiny.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()},Tiny.DisplayObject.prototype.toGlobal=function(t){return this.displayObjectUpdateTransform(),this.worldTransform.apply(t)},Tiny.DisplayObject.prototype.toLocal=function(t,e){return e&&(t=e.toGlobal(t)),this.displayObjectUpdateTransform(),this.worldTransform.applyInverse(t)},Tiny.DisplayObject.prototype._renderCachedSprite=function(t){this._cachedSprite.worldAlpha=this.worldAlpha,Tiny.Sprite.prototype._renderCanvas.call(this._cachedSprite,t)},Tiny.DisplayObject.prototype._generateCachedSprite=function(){this._cacheAsBitmap=!1;var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.texture.resize(0|t.width,0|t.height);else{var e=new Tiny.RenderTexture(0|t.width,0|t.height);this._cachedSprite=new Tiny.Sprite(e),this._cachedSprite.worldTransform=this.worldTransform}Tiny.DisplayObject._tempMatrix.tx=-t.x,Tiny.DisplayObject._tempMatrix.ty=-t.y,this._cachedSprite.texture.render(this,Tiny.DisplayObject._tempMatrix,!0),this._cachedSprite.anchor.x=-t.x/t.width,this._cachedSprite.anchor.y=-t.y/t.height,this._cacheAsBitmap=!0},Tiny.DisplayObject.prototype._destroyCachedSprite=function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)},Tiny.DisplayObject.prototype._renderCanvas=function(t){t=t},Object.defineProperty(Tiny.DisplayObject.prototype,"x",{get:function(){return this.position.x},set:function(t){this.position.x=t}}),Object.defineProperty(Tiny.DisplayObject.prototype,"y",{get:function(){return this.position.y},set:function(t){this.position.y=t}}),Tiny.DisplayObject._tempMatrix=new Tiny.Matrix},function(t,e){Tiny.DisplayObjectContainer=function(){Tiny.DisplayObject.call(this),this.children=[]},Tiny.DisplayObjectContainer.prototype=Object.create(Tiny.DisplayObject.prototype),Tiny.DisplayObjectContainer.prototype.constructor=Tiny.DisplayObjectContainer,Object.defineProperty(Tiny.DisplayObjectContainer.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}}),Object.defineProperty(Tiny.DisplayObjectContainer.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}}),Tiny.DisplayObjectContainer.prototype.addChild=function(t){return this.addChildAt(t,this.children.length)},Tiny.DisplayObjectContainer.prototype.addChildAt=function(t,e){if(e>=0&&e<=this.children.length)return t.parent&&t.parent.removeChild(t),t.parent=this,t.game=this.game,this.children.splice(e,0,t),this.stage&&t.setStageReference(this.stage),t;throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length)},Tiny.DisplayObjectContainer.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),n=this.getChildIndex(e);if(i<0||n<0)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[i]=e,this.children[n]=t}},Tiny.DisplayObjectContainer.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},Tiny.DisplayObjectContainer.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The supplied index is out of bounds");var i=this.getChildIndex(t);this.children.splice(i,1),this.children.splice(e,0,t)},Tiny.DisplayObjectContainer.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Supplied index "+t+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller");return this.children[t]},Tiny.DisplayObjectContainer.prototype.removeChild=function(t){var e=this.children.indexOf(t);if(-1!==e)return this.removeChildAt(e)},Tiny.DisplayObjectContainer.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return this.stage&&e.removeStageReference(),e.parent=void 0,this.children.splice(t,1),e},Tiny.DisplayObjectContainer.prototype.removeChildren=function(t,e){var i=t||0,n="number"==typeof e?e:this.children.length,s=n-i;if(s>0&&s<=n){for(var r=this.children.splice(i,s),h=0;h<r.length;h++){var o=r[h];this.stage&&o.removeStageReference(),o.parent=void 0}return r}if(0===s&&0===this.children.length)return[];throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range")},Tiny.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(this.displayObjectUpdateTransform(),!this._cacheAsBitmap))for(var t=0,e=this.children.length;t<e;t++)this.children[t].updateTransform()},Tiny.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform=Tiny.DisplayObjectContainer.prototype.updateTransform,Tiny.DisplayObjectContainer.prototype.getBounds=function(){if(0===this.children.length)return Tiny.EmptyRectangle;for(var t,e,i,n=1/0,s=1/0,r=-1/0,h=-1/0,o=!1,a=0,c=this.children.length;a<c;a++){this.children[a].visible&&(o=!0,t=this.children[a].getBounds(),n=n<t.x?n:t.x,s=s<t.y?s:t.y,e=t.width+t.x,i=t.height+t.y,r=r>e?r:e,h=h>i?h:i)}if(!o)return Tiny.EmptyRectangle;var l=this._bounds;return l.x=n,l.y=s,l.width=r-n,l.height=h-s,l},Tiny.DisplayObjectContainer.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=Tiny.identityMatrix;for(var e=0,i=this.children.length;e<i;e++)this.children[e].updateTransform();var n=this.getBounds();return this.worldTransform=t,n},Tiny.DisplayObjectContainer.prototype.setStageReference=function(t){this.stage=t;for(var e=0;e<this.children.length;e++)this.children[e].setStageReference(t)},Tiny.DisplayObjectContainer.prototype.removeStageReference=function(){for(var t=0;t<this.children.length;t++)this.children[t].removeStageReference();this.stage=null},Tiny.DisplayObjectContainer.prototype._renderCanvas=function(t){if(!1!==this.visible&&0!==this.alpha){if(this._cacheAsBitmap)return void this._renderCachedSprite(t);this._mask&&t.maskManager.pushMask(this._mask,t);for(var e=0;e<this.children.length;e++)this.children[e]._renderCanvas(t);this._mask&&t.maskManager.popMask(t)}}},function(t,e){Tiny.Stage=function(){Tiny.DisplayObjectContainer.call(this),this.worldTransform=new Tiny.Matrix,this.stage=this,this.setBackgroundColor(16777215)},Tiny.Stage.prototype=Object.create(Tiny.DisplayObjectContainer.prototype),Tiny.Stage.prototype.constructor=Tiny.Stage,Tiny.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var t=0;t<this.children.length;t++)this.children[t].updateTransform()},Tiny.Stage.prototype.setBackgroundColor=function(t){this.backgroundColor=t||0,this.backgroundColorSplit=Tiny.hex2rgb(this.backgroundColor);var e=this.backgroundColor.toString(16);e="000000".substr(0,6-e.length)+e,this.backgroundColorString="#"+e}},function(t,e){Tiny.VERSION="1.0.2",Tiny.PI_2=2*Math.PI,Tiny._UID=0,Tiny.RETINA_PREFIX="@2x",Tiny.Primitives={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4,RREC_LJOIN:5},Tiny.blendModes={NORMAL:0},Tiny.scaleModes={DEFAULT:0},Tiny.ScaleManager={NORMAL:0,SHOW_ALL:1},Tiny.hex2rgb=function(t){return[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255]},Tiny.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]},Tiny.getNextPowerOfTwo=function(t){if(t>0&&0==(t&t-1))return t;for(var e=1;e<t;)e<<=1;return e},Tiny.isPowerOfTwo=function(t,e){return t>0&&0==(t&t-1)&&e>0&&0==(e&e-1)}},function(t,e){Tiny.Math={distance:function(t,e,i,n){var s=t-i,r=e-n;return Math.sqrt(s*s+r*r)}};var i=Math.PI/180,n=180/Math.PI;Tiny.Math.degToRad=function(t){return t*i},Tiny.Math.radToDeg=function(t){return t*n}},function(t,e){Tiny.Matrix=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this.type=Tiny.MATRIX},Tiny.Matrix.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},Tiny.Matrix.prototype.toArray=function(t){this.array||(this.array=new Float32Array(9));var e=this.array;return t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.tx,e[7]=this.ty,e[8]=1):(e[0]=this.a,e[1]=this.c,e[2]=this.tx,e[3]=this.b,e[4]=this.d,e[5]=this.ty,e[6]=0,e[7]=0,e[8]=1),e},Tiny.Matrix.prototype.apply=function(t,e){e=e||new Tiny.Point;var i=t.x,n=t.y;return e.x=this.a*i+this.c*n+this.tx,e.y=this.b*i+this.d*n+this.ty,e},Tiny.Matrix.prototype.applyInverse=function(t,e){e=e||new Tiny.Point;var i=1/(this.a*this.d+this.c*-this.b),n=t.x,s=t.y;return e.x=this.d*i*n+-this.c*i*s+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*s+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,e},Tiny.Matrix.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},Tiny.Matrix.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},Tiny.Matrix.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a,s=this.c,r=this.tx;return this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=s*e-this.d*i,this.d=s*i+this.d*e,this.tx=r*e-this.ty*i,this.ty=r*i+this.ty*e,this},Tiny.Matrix.prototype.append=function(t){var e=this.a,i=this.b,n=this.c,s=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*i+t.b*s,this.c=t.c*e+t.d*n,this.d=t.c*i+t.d*s,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*s+this.ty,this},Tiny.Matrix.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Tiny.identityMatrix=new Tiny.Matrix},function(t,e){Tiny.Point=function(t,e){this.x=t||0,this.y=e||0},Tiny.Point.prototype={set:function(t,e){return this.x=t||0,this.y=e||(0!==e?this.x:0),this},setTo:function(t,e){this.set(t,e)}}},function(t,e){Tiny.Rectangle=function(t,e,i,n){t=t||0,e=e||0,i=i||0,n=n||0,this.x=t,this.y=e,this.width=i,this.height=n,this.type=Tiny.Primitives.RECT},Tiny.Rectangle.prototype={setTo:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},contains:function(t,e){return Tiny.Rectangle.contains(this,t,e)},intersects:function(t){return Tiny.Rectangle.intersects(this,t)},toString:function(){return"[{Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+" empty="+this.empty+")}]"}},Object.defineProperty(Tiny.Rectangle.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){t<=this.y?this.height=0:this.height=t-this.y}}),Object.defineProperty(Tiny.Rectangle.prototype,"right",{get:function(){return this.x+this.width},set:function(t){t<=this.x?this.width=0:this.width=t-this.x}}),Object.defineProperty(Tiny.Rectangle.prototype,"volume",{get:function(){return this.width*this.height}}),Tiny.Rectangle.prototype.constructor=Tiny.Rectangle,Tiny.Rectangle.contains=function(t,e,i){return!(t.width<=0||t.height<=0)&&(e>=t.x&&e<t.right&&i>=t.y&&i<t.bottom)},Tiny.Rectangle.containsPoint=function(t,e){return Tiny.Rectangle.contains(t,e.x,e.y)},Tiny.Rectangle.containsRect=function(t,e){return!(t.volume>e.volume)&&(t.x>=e.x&&t.y>=e.y&&t.right<e.right&&t.bottom<e.bottom)},Tiny.Rectangle.intersects=function(t,e){return!(t.width<=0||t.height<=0||e.width<=0||e.height<=0)&&!(t.right<e.x||t.bottom<e.y||t.x>e.right||t.y>e.bottom)},Tiny.EmptyRectangle=new Tiny.Rectangle(0,0,0,0)},function(t,e){Tiny.RoundedRectangle=function(t,e,i,n,s){this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0,this.radius=s||20,this.type=Tiny.Primitives.RREC},Tiny.RoundedRectangle.prototype.clone=function(){return new Tiny.RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)},Tiny.RoundedRectangle.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=this.x;if(t>=i&&t<=i+this.width){var n=this.y;if(e>=n&&e<=n+this.height)return!0}return!1},Tiny.RoundedRectangle.prototype.constructor=Tiny.RoundedRectangle},function(t,e){Tiny.GraphicsData=function(t,e,i,n,s,r,h){this.lineWidth=t,this.lineColor=e,this.lineAlpha=i,this._lineTint=e,this.fillColor=n,this.fillAlpha=s,this._fillTint=n,this.fill=r,this.shape=h,this.type=h.type},Tiny.GraphicsData.prototype.constructor=Tiny.GraphicsData,Tiny.GraphicsData.prototype.clone=function(){return new GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},Tiny.Graphics=function(){Tiny.DisplayObjectContainer.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=0,this.lineColor=0,this.graphicsData=[],this.tint=16777215,this.blendMode=Tiny.blendModes.NORMAL,this.currentPath=null,this._webGL=[],this.isMask=!1,this.boundsPadding=0,this._localBounds=new Tiny.Rectangle(0,0,1,1),this._boundsDirty=!0,this.cachedSpriteDirty=!1},Tiny.Graphics.prototype=Object.create(Tiny.DisplayObjectContainer.prototype),Tiny.Graphics.prototype.constructor=Tiny.Graphics,Tiny.Graphics.prototype.lineStyle=function(t,e,i){return this.lineWidth=t||0,this.lineColor=e||0,this.lineAlpha=void 0===i?1:i,this.currentPath&&(this.currentPath.shape.points.length?this.drawShape(new Tiny.Polygon(this.currentPath.shape.points.slice(-2))):(this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha)),this},Tiny.Graphics.prototype.moveTo=function(t,e){return this.drawShape(new Tiny.Polygon([t,e])),this},Tiny.Graphics.prototype.lineTo=function(t,e){return this.currentPath||this.moveTo(0,0),this.currentPath.shape.points.push(t,e),this._boundsDirty=!0,this.cachedSpriteDirty=!0,this},Tiny.Graphics.prototype.quadraticCurveTo=function(t,e,i,n){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var s,r,h=this.currentPath.shape.points;0===h.length&&this.moveTo(0,0);for(var o=h[h.length-2],a=h[h.length-1],c=0,l=1;l<=20;++l)c=l/20,s=o+(t-o)*c,r=a+(e-a)*c,h.push(s+(t+(i-t)*c-s)*c,r+(e+(n-e)*c-r)*c);return this._boundsDirty=!0,this.cachedSpriteDirty=!0,this},Tiny.Graphics.prototype.bezierCurveTo=function(t,e,i,n,s,r){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var h,o,a,c,l,u=this.currentPath.shape.points,p=u[u.length-2],d=u[u.length-1],y=0,f=1;f<=20;++f)y=f/20,h=1-y,o=h*h,a=o*h,c=y*y,l=c*y,u.push(a*p+3*o*y*t+3*h*c*i+l*s,a*d+3*o*y*e+3*h*c*n+l*r);return this._boundsDirty=!0,this.cachedSpriteDirty=!0,this},Tiny.Graphics.prototype.arcTo=function(t,e,i,n,s){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var r=this.currentPath.shape.points,h=r[r.length-2],o=r[r.length-1],a=o-e,c=h-t,l=n-e,u=i-t,p=Math.abs(a*u-c*l);if(p<1e-8||0===s)r[r.length-2]===t&&r[r.length-1]===e||r.push(t,e);else{var d=a*a+c*c,y=l*l+u*u,f=a*l+c*u,T=s*Math.sqrt(d)/p,g=s*Math.sqrt(y)/p,m=T*f/d,_=g*f/y,v=T*u+g*c,x=T*l+g*a,b=c*(g+m),w=a*(g+m),C=u*(T+_),S=l*(T+_),O=Math.atan2(w-x,b-v),M=Math.atan2(S-x,C-v);this.arc(v+t,x+e,s,O,M,c*l>u*a)}return this._boundsDirty=!0,this.cachedSpriteDirty=!0,this},Tiny.Graphics.prototype.arc=function(t,e,i,n,s,r){if(n===s)return this;void 0===r&&(r=!1),!r&&s<=n?s+=2*Math.PI:r&&n<=s&&(n+=2*Math.PI);var h=r?-1*(n-s):s-n,o=40*Math.ceil(Math.abs(h)/(2*Math.PI));if(0===h)return this;var a=t+Math.cos(n)*i,c=e+Math.sin(n)*i;r&&this.filling?this.moveTo(t,e):this.moveTo(a,c);for(var l=this.currentPath.shape.points,u=h/(2*o),p=2*u,d=Math.cos(u),y=Math.sin(u),f=o-1,T=f%1/f,g=0;g<=f;g++){var m=g+T*g,_=u+n+p*m,v=Math.cos(_),x=-Math.sin(_);l.push((d*v+y*x)*i+t,(d*-x+y*v)*i+e)}return this._boundsDirty=!0,this.cachedSpriteDirty=!0,this},Tiny.Graphics.prototype.beginFill=function(t,e){return this.filling=!0,this.fillColor=t||0,this.fillAlpha=void 0===e?1:e,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},Tiny.Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},Tiny.Graphics.prototype.drawRect=function(t,e,i,n){return this.drawShape(new Tiny.Rectangle(t,e,i,n)),this},Tiny.Graphics.prototype.drawRoundedRect=function(t,e,i,n,s){return this.drawShape(new Tiny.RoundedRectangle(t,e,i,n,s)),this},Tiny.Graphics.prototype.drawRoundedRect2=function(t,e,i,n,s){var r=new Tiny.RoundedRectangle(t,e,i,n,s);return r.type=Tiny.Primitives.RREC_LJOIN,this.drawShape(r),this},Tiny.Graphics.prototype.drawCircle=function(t,e,i){return this.drawShape(new Tiny.Circle(t,e,i)),this},Tiny.Graphics.prototype.drawEllipse=function(t,e,i,n){return this.drawShape(new Tiny.Ellipse(t,e,i,n)),this},Tiny.Graphics.prototype.drawPolygon=function(t){var e=t;if(!Array.isArray(e)){e=new Array(arguments.length);for(var i=0;i<e.length;++i)e[i]=arguments[i]}return this.drawShape(new Tiny.Polygon(e)),this},Tiny.Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this._boundsDirty=!0,this.cachedSpriteDirty=!0,this.graphicsData=[],this.updateLocalBounds(),this},Tiny.Graphics.prototype.destroy=function(t){if(this.children){for(var e=this.children.length;e--;)this.children[e].destroy();this.children=[]}this.clear()},Tiny.Graphics.prototype.generateTexture=function(t,e){t=t||1;var i=this.getBounds(),n=new Tiny.CanvasBuffer(i.width*t,i.height*t),s=Tiny.Texture.fromCanvas(n.canvas,e);return s.baseTexture.resolution=t,n.context.scale(t,t),n.context.translate(-i.x,-i.y),Tiny.CanvasGraphics.renderGraphics(this,n.context),s},Tiny.Graphics.prototype._renderCanvas=function(t){if(!0!==this.isMask){if(this._prevTint!==this.tint&&(this._boundsDirty=!0,this._prevTint=this.tint),this._cacheAsBitmap)return this.cachedSpriteDirty&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this._boundsDirty=!1),this._cachedSprite.alpha=this.alpha,void Tiny.Sprite.prototype._renderCanvas.call(this._cachedSprite,t);var e=t.context,i=this.worldTransform;this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,e.globalCompositeOperation=Tiny.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t);var n=t.resolution;e.setTransform(i.a*n,i.b*n,i.c*n,i.d*n,i.tx*n,i.ty*n),Tiny.CanvasGraphics.renderGraphics(this,e);for(var s=0;s<this.children.length;s++)this.children[s]._renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},Tiny.Graphics.prototype.getBounds=function(t){if(!this._currentBounds||this._boundsDirty){if(!this.renderable)return Tiny.EmptyRectangle;this._boundsDirty&&(this.updateLocalBounds(),this.cachedSpriteDirty=!0,this._boundsDirty=!1);var e=this._localBounds,i=e.x,n=e.width+e.x,s=e.y,r=e.height+e.y,h=t||this.worldTransform,o=h.a,a=h.b,c=h.c,l=h.d,u=h.tx,p=h.ty,d=o*n+c*r+u,y=l*r+a*n+p,f=o*i+c*r+u,T=l*r+a*i+p,g=o*i+c*s+u,m=l*s+a*i+p,_=o*n+c*s+u,v=l*s+a*n+p,x=d,b=y,w=d,C=y;w=f<w?f:w,w=g<w?g:w,w=_<w?_:w,C=T<C?T:C,C=m<C?m:C,C=v<C?v:C,x=f>x?f:x,x=g>x?g:x,x=_>x?_:x,b=T>b?T:b,b=m>b?m:b,b=v>b?v:b,this._bounds.x=w,this._bounds.width=x-w,this._bounds.y=C,this._bounds.height=b-C,this._currentBounds=this._bounds}return this._currentBounds},Tiny.Graphics.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,tempPoint);for(var e=this.graphicsData,i=0;i<e.length;i++){var n=e[i];if(n.fill&&(n.shape&&n.shape.contains(tempPoint.x,tempPoint.y)))return!0}return!1},Tiny.Graphics.prototype.updateLocalBounds=function(){var t=1/0,e=-1/0,i=1/0,n=-1/0;if(this.graphicsData.length)for(var s,r,h,o,a,c,l=0;l<this.graphicsData.length;l++){var u=this.graphicsData[l],p=u.type,d=u.lineWidth;if(s=u.shape,p===Tiny.Primitives.RECT||p===Tiny.Primitives.RREC||p===Tiny.Primitives.RREC_LJOIN)h=s.x-d/2,o=s.y-d/2,a=s.width+d,c=s.height+d,t=h<t?h:t,e=h+a>e?h+a:e,i=o<i?o:i,n=o+c>n?o+c:n;else if(p===Tiny.Primitives.CIRC)h=s.x,o=s.y,a=s.radius+d/2,c=s.radius+d/2,t=h-a<t?h-a:t,e=h+a>e?h+a:e,i=o-c<i?o-c:i,n=o+c>n?o+c:n;else if(p===Tiny.Primitives.ELIP)h=s.x,o=s.y,a=s.width+d/2,c=s.height+d/2,t=h-a<t?h-a:t,e=h+a>e?h+a:e,i=o-c<i?o-c:i,n=o+c>n?o+c:n;else{r=s.points;for(var y=0;y<r.length;y++)r[y]instanceof Tiny.Point?(h=r[y].x,o=r[y].y):(h=r[y],o=r[y+1],y<r.length-1&&y++),t=h-d<t?h-d:t,e=h+d>e?h+d:e,i=o-d<i?o-d:i,n=o+d>n?o+d:n}}else t=0,e=0,i=0,n=0;var f=this.boundsPadding;this._localBounds.x=t-f,this._localBounds.width=e-t+2*f,this._localBounds.y=i-f,this._localBounds.height=n-i+2*f},Tiny.Graphics.prototype._generateCachedSprite=function(){var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.buffer.resize(t.width,t.height);else{var e=new Tiny.CanvasBuffer(t.width,t.height),i=Tiny.Texture.fromCanvas(e.canvas);this._cachedSprite=new Tiny.Sprite(i),this._cachedSprite.buffer=e,this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-t.x/t.width,this._cachedSprite.anchor.y=-t.y/t.height,this._cachedSprite.buffer.context.translate(-t.x,-t.y),this.worldAlpha=1,Tiny.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context),this._cachedSprite.alpha=this.alpha},Tiny.Graphics.prototype.updateCachedSpriteTexture=function(){var t=this._cachedSprite,e=t.texture,i=t.buffer.canvas;e.baseTexture.width=i.width,e.baseTexture.height=i.height,e.crop.width=e.frame.width=i.width,e.crop.height=e.frame.height=i.height,t._width=i.width,t._height=i.height,e.baseTexture.dirty()},Tiny.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0),this._cachedSprite=null},Tiny.Graphics.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null,t instanceof Tiny.Polygon&&t.flatten();var e=new Tiny.GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,t);return this.graphicsData.push(e),e.type===Tiny.Primitives.POLY&&(e.shape.closed=this.filling,this.currentPath=e),this._boundsDirty=!0,this.cachedSpriteDirty=!0,e},Object.defineProperty(Tiny.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap=t,this._cacheAsBitmap?this._generateCachedSprite():(this.destroyCachedSprite(),this._boundsDirty=!0)}})},function(t,e){Tiny.Sprite=function(t){Tiny.DisplayObjectContainer.call(this),this.anchor=new Tiny.Point,this.texture=t,this._width=0,this._height=0,this._frame=0,this.tint=16777215,this.blendMode=Tiny.blendModes.NORMAL,this.shader=null,this.texture.baseTexture.hasLoaded&&this.onTextureUpdate(),this.renderable=!0},Tiny.Sprite.prototype=Object.create(Tiny.DisplayObjectContainer.prototype),Tiny.Sprite.prototype.constructor=Tiny.Sprite,Object.defineProperty(Tiny.Sprite.prototype,"frameName",{get:function(){return this.texture.frame.name},set:function(t){this.texture.frame.name&&this.setTexture(Tiny.TextureCache[this.texture.key+"_"+t])}}),Object.defineProperty(Tiny.Sprite.prototype,"frame",{get:function(){return this._frame},set:function(t){this.texture.max_no_frame&&(this._frame=t,this._frame>this.texture.max_no_frame&&(this._frame=0),this.setTexture(Tiny.TextureCache[this.texture.key+"_"+this._frame]))}}),Object.defineProperty(Tiny.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(Tiny.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),Tiny.Sprite.prototype.setTexture=function(t){this.texture=t,this.cachedTint=16777215},Tiny.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height)},Tiny.Sprite.prototype.animate=function(t){if(this.texture.max_no_frame&&void 0!=this.texture.frame.index){var e=t||this.texture.frame.duration||100;this.animation?(this.animation.delay=e,this.animation.start()):(this.animation=this.game.timer.loop(e,function(){this.frame+=1,this.animation.delay=t||this.texture.frame.duration||100}.bind(this)),this.animation.start())}},Tiny.Sprite.prototype.getBounds=function(t){var e=this.texture.frame.width,i=this.texture.frame.height,n=e*(1-this.anchor.x),s=e*-this.anchor.x,r=i*(1-this.anchor.y),h=i*-this.anchor.y,o=t||this.worldTransform,a=o.a,c=o.b,l=o.c,u=o.d,p=o.tx,d=o.ty,y=-1/0,f=-1/0,T=1/0,g=1/0;if(0===c&&0===l)a<0&&(a*=-1),u<0&&(u*=-1),T=a*s+p,y=a*n+p,g=u*h+d,f=u*r+d;else{var m=a*s+l*h+p,_=u*h+c*s+d,v=a*n+l*h+p,x=u*h+c*n+d,b=a*n+l*r+p,w=u*r+c*n+d,C=a*s+l*r+p,S=u*r+c*s+d;T=m<T?m:T,T=v<T?v:T,T=b<T?b:T,T=C<T?C:T,g=_<g?_:g,g=x<g?x:g,g=w<g?w:g,g=S<g?S:g,y=m>y?m:y,y=v>y?v:y,y=b>y?b:y,y=C>y?C:y,f=_>f?_:f,f=x>f?x:f,f=w>f?w:f,f=S>f?S:f}var O=this._bounds;return O.x=T,O.width=y-T,O.y=g,O.height=f-g,this._currentBounds=O,O},Tiny.Sprite.prototype._renderCanvas=function(t){if(!(!1===this.visible||0===this.alpha||!1===this.renderable||this.texture.crop.width<=0||this.texture.crop.height<=0)){if(this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,t.context.globalCompositeOperation=Tiny.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t),this.texture.valid){var e=this.texture.baseTexture.resolution/t.resolution;t.context.globalAlpha=this.worldAlpha,t.smoothProperty&&t.scaleMode!==this.texture.baseTexture.scaleMode&&(t.scaleMode=this.texture.baseTexture.scaleMode,t.context[t.smoothProperty]=0===t.scaleMode);var i=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,n=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height;t.roundPixels?(t.context.setTransform(this.worldTransform.a,this.worldTransform.b,this.worldTransform.c,this.worldTransform.d,this.worldTransform.tx*t.resolution|0,this.worldTransform.ty*t.resolution|0),i|=0,n|=0):t.context.setTransform(this.worldTransform.a,this.worldTransform.b,this.worldTransform.c,this.worldTransform.d,this.worldTransform.tx*t.resolution,this.worldTransform.ty*t.resolution),16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=Tiny.CanvasTinter.getTintedTexture(this,this.tint)),t.context.drawImage(this.tintedTexture,0,0,this.texture.crop.width,this.texture.crop.height,i/e,n/e,this.texture.crop.width/e,this.texture.crop.height/e)):t.context.drawImage(this.texture.baseTexture.source,this.texture.crop.x,this.texture.crop.y,this.texture.crop.width,this.texture.crop.height,i/e,n/e,this.texture.crop.width/e,this.texture.crop.height/e)}for(var s=0;s<this.children.length;s++)this.children[s]._renderCanvas(t);this._mask&&t.maskManager.popMask(t)}}},function(t,e){Tiny.Text=function(t,e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=1,Tiny.Sprite.call(this,Tiny.Texture.fromCanvas(this.canvas)),this.setText(t),this.setStyle(e)},Tiny.Text.prototype=Object.create(Tiny.Sprite.prototype),Tiny.Text.prototype.constructor=Tiny.Text,Object.defineProperty(Tiny.Text.prototype,"width",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(Tiny.Text.prototype,"height",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),Tiny.Text.prototype.setStyle=function(t){t=t||{},t.font=t.font||"bold 20pt Arial",t.fill=t.fill||"black",t.align=t.align||"left",t.stroke=t.stroke||"black",t.strokeThickness=t.strokeThickness||0,t.wordWrap=t.wordWrap||!1,t.wordWrapWidth=t.wordWrapWidth||100,t.dropShadow=t.dropShadow||!1,t.dropShadowAngle=t.dropShadowAngle||Math.PI/6,t.dropShadowDistance=t.dropShadowDistance||4,t.dropShadowColor=t.dropShadowColor||"black",this.style=t,this.dirty=!0},Tiny.Text.prototype.setText=function(t){this.text=t.toString()||" ",this.dirty=!0},Tiny.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this.resolution,this.context.font=this.style.font;var t=this.text;this.style.wordWrap&&(t=this.wordWrap(this.text));for(var e=t.split(/(?:\r\n|\r|\n)/),i=[],n=0,s=this.determineFontProperties(this.style.font),r=0;r<e.length;r++){var h=this.context.measureText(e[r]).width;i[r]=h,n=Math.max(n,h)}var o=n+this.style.strokeThickness;this.style.dropShadow&&(o+=this.style.dropShadowDistance),this.canvas.width=(o+this.context.lineWidth)*this.resolution;var a=s.fontSize+this.style.strokeThickness,c=a*e.length;this.style.dropShadow&&(c+=this.style.dropShadowDistance),this.canvas.height=c*this.resolution,this.context.scale(this.resolution,this.resolution),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="alphabetic",this.context.miterLimit=2;var l,u;if(this.style.dropShadow){this.context.fillStyle=this.style.dropShadowColor;var p=Math.sin(this.style.dropShadowAngle)*this.style.dropShadowDistance,d=Math.cos(this.style.dropShadowAngle)*this.style.dropShadowDistance;for(r=0;r<e.length;r++)l=this.style.strokeThickness/2,u=this.style.strokeThickness/2+r*a+s.ascent,"right"===this.style.align?l+=n-i[r]:"center"===this.style.align&&(l+=(n-i[r])/2),this.style.fill&&this.context.fillText(e[r],l+p,u+d)}for(this.context.fillStyle=this.style.fill,r=0;r<e.length;r++)l=this.style.strokeThickness/2,u=this.style.strokeThickness/2+r*a+s.ascent,"right"===this.style.align?l+=n-i[r]:"center"===this.style.align&&(l+=(n-i[r])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(e[r],l,u),this.style.fill&&this.context.fillText(e[r],l,u);this.updateTexture()},Tiny.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width,this.texture.baseTexture.height=this.canvas.height,this.texture.crop.width=this.texture.frame.width=this.canvas.width,this.texture.crop.height=this.texture.frame.height=this.canvas.height,this._width=this.canvas.width,this._height=this.canvas.height,this.texture.baseTexture.dirty()},Tiny.Text.prototype._renderCanvas=function(t){this.dirty&&(this.resolution=t.resolution,this.updateText(),this.dirty=!1),Tiny.Sprite.prototype._renderCanvas.call(this,t)},Tiny.Text.prototype.determineFontProperties=function(t){var e=Tiny.Text.fontPropertiesCache[t];if(!e){e={};var i=Tiny.Text.fontPropertiesCanvas,n=Tiny.Text.fontPropertiesContext;n.font=t;var s=Math.ceil(n.measureText("|Mq").width),r=Math.ceil(n.measureText("|Mq").width),h=2*r;r=1.4*r|0,i.width=s,i.height=h,n.fillStyle="#f00",n.fillRect(0,0,s,h),n.font=t,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText("|Mq",0,r);var o,a,c=n.getImageData(0,0,s,h).data,l=c.length,u=4*s,p=0,d=!1;for(o=0;o<r;o++){for(a=0;a<u;a+=4)if(255!==c[p+a]){d=!0;break}if(d)break;p+=u}for(e.ascent=r-o,p=l-u,d=!1,o=h;o>r;o--){for(a=0;a<u;a+=4)if(255!==c[p+a]){d=!0;break}if(d)break;p-=u}e.descent=o-r,e.descent+=6,e.fontSize=e.ascent+e.descent,Tiny.Text.fontPropertiesCache[t]=e}return e},Tiny.Text.prototype.wordWrap=function(t){for(var e="",i=t.split("\n"),n=0;n<i.length;n++){for(var s=this.style.wordWrapWidth,r=i[n].split(" "),h=0;h<r.length;h++){var o=this.context.measureText(r[h]).width,a=o+this.context.measureText(" ").width;0===h||a>s?(h>0&&(e+="\n"),e+=r[h],s=this.style.wordWrapWidth-o):(s-=a,e+=" "+r[h])}n<i.length-1&&(e+="\n")}return e},Tiny.Text.prototype.getBounds=function(t){return this.dirty&&(this.updateText(),this.dirty=!1),Tiny.Sprite.prototype.getBounds.call(this,t)},Tiny.Text.prototype.destroy=function(t){this.context=null,this.canvas=null,this.texture.destroy(void 0===t||t)},Tiny.Text.fontPropertiesCache={},Tiny.Text.fontPropertiesCanvas=document.createElement("canvas"),Tiny.Text.fontPropertiesContext=Tiny.Text.fontPropertiesCanvas.getContext("2d")},function(t,e){Tiny.BaseTextureCache={},Tiny.BaseTextureCacheIdGenerator=0,Tiny.BaseTexture=function(t,e){if(this.resolution=1,this.width=100,this.height=100,this.scaleMode=e||Tiny.scaleModes.DEFAULT,this.hasLoaded=!1,this.source=t,this._UID=Tiny._UID++,this.premultipliedAlpha=!0,this.mipmap=!1,this._dirty=[!0,!0,!0,!0],t){if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this.hasLoaded=!0,this.width=this.source.naturalWidth||this.source.width,this.height=this.source.naturalHeight||this.source.height,this.dirty();else{var i=this;this.source.onload=function(){i.hasLoaded=!0,i.width=i.source.naturalWidth||i.source.width,i.height=i.source.naturalHeight||i.source.height}}this.imageUrl=null,this._powerOf2=!1}},Tiny.BaseTexture.prototype.constructor=Tiny.BaseTexture,Tiny.BaseTexture.prototype.destroy=function(){this.imageUrl?(delete Tiny.BaseTextureCache[this.key],delete Tiny.TextureCache[this.key],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")):this.source&&this.source._pixiId&&delete Tiny.BaseTextureCache[this.source._pixiId],this.source=null},Tiny.BaseTexture.prototype.updateSourceImage=function(t){this.hasLoaded=!1,this.source.src=null,this.source.src=t},Tiny.BaseTexture.prototype.dirty=function(){},Tiny.BaseTexture.fromImage=function(t,e,i,n){var s=Tiny.BaseTextureCache[t];if(void 0===i&&-1===e.indexOf("data:")&&(i=!0),!s){var r=new Image;i&&(r.crossOrigin=""),r.src=e,s=new Tiny.BaseTexture(r,n),s.imageUrl=e,s.key=t,Tiny.BaseTextureCache[t]=s,-1!==e.indexOf(Tiny.RETINA_PREFIX+".")&&(s.resolution=2)}return s},Tiny.BaseTexture.fromCanvas=function(t,e){t._pixiId||(t._pixiId="canvas_"+Tiny.TextureCacheIdGenerator++);var i=Tiny.BaseTextureCache[t._pixiId];return i||(i=new Tiny.BaseTexture(t,e),Tiny.BaseTextureCache[t._pixiId]=i),i}},function(t,e){Tiny.TextureCache={},Tiny.FrameCache={},Tiny.TextureSilentFail=!1,Tiny.TextureCacheIdGenerator=0,Tiny.Texture=function(t,e,i,n){this.noFrame=!1,e||(this.noFrame=!0,e=new Tiny.Rectangle(0,0,1,1)),t instanceof Tiny.Texture&&(t=t.baseTexture),this.baseTexture=t,this.frame=e,this.trim=n,this.valid=!1,this.requiresUpdate=!1,this._uvs=null,this.width=0,this.height=0,this.crop=i||new Tiny.Rectangle(0,0,1,1),t.hasLoaded&&(this.noFrame&&(e=new Tiny.Rectangle(0,0,t.width,t.height)),this.setFrame(e))},Tiny.Texture.prototype.constructor=Tiny.Texture,Tiny.Texture.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;this.noFrame&&(this.frame=new Tiny.Rectangle(0,0,t.width,t.height)),this.setFrame(this.frame)},Tiny.Texture.prototype.destroy=function(t){t&&this.baseTexture.destroy(),this.valid=!1},Tiny.Texture.prototype.setFrame=function(t){if(this.noFrame=!1,this.frame=t,this.width=t.width,this.height=t.height,this.crop.x=t.x,this.crop.y=t.y,this.crop.width=t.width,this.crop.height=t.height,!this.trim&&(t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height)){if(!Tiny.TextureSilentFail)throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);return void(this.valid=!1)}this.valid=t&&t.width&&t.height&&this.baseTexture.source&&this.baseTexture.hasLoaded,this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,this.frame.height=this.trim.height),this.valid&&this._updateUvs()},Tiny.Texture.prototype._updateUvs=function(){this._uvs||(this._uvs=new Tiny.TextureUvs);var t=this.crop,e=this.baseTexture.width,i=this.baseTexture.height;this._uvs.x0=t.x/e,this._uvs.y0=t.y/i,this._uvs.x1=(t.x+t.width)/e,this._uvs.y1=t.y/i,this._uvs.x2=(t.x+t.width)/e,this._uvs.y2=(t.y+t.height)/i,this._uvs.x3=t.x/e,this._uvs.y3=(t.y+t.height)/i},Tiny.Texture.fromImage=function(t,e,i,n){var s=Tiny.TextureCache[t];return s||(s=new Tiny.Texture(Tiny.BaseTexture.fromImage(t,e,i,n)),s.key=t,Tiny.TextureCache[t]=s),s},Tiny.Texture.fromFrame=function(t){var e=Tiny.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache ');return e},Tiny.Texture.fromCanvas=function(t,e){var i=Tiny.BaseTexture.fromCanvas(t,e);return new Tiny.Texture(i)},Tiny.Texture.addTextureToCache=function(t,e){Tiny.TextureCache[e]=t},Tiny.Texture.removeTextureFromCache=function(t){var e=Tiny.TextureCache[t];return delete Tiny.TextureCache[t],delete Tiny.BaseTextureCache[t],e},Tiny.TextureUvs=function(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0}},function(t,e){Tiny.Timer=function(t,e,i,n,s,r,h,o){this.game=i,this._cb_=n||function(){},this.delay=s||1e3,this.loop=r,this._count=h||0,this._repeat=this._count>0,this.status=t,this._lastFrame=0,this.autoRemove=e,this._oncomplete=o||function(){},this._stop=function(){}},Tiny.Timer.prototype={start:function(){this.status=1},pause:function(){this.status=0},stop:function(){this.status=0,this._lastFrame=0,this._stop()},update:function(t){this.status&&(this._lastFrame+=t,this._lastFrame>=this.delay&&(this._cb_(),this._lastFrame=0,this._repeat?0===--this._count&&(this.status=0,this.autoRemove&&this.game.timer.remove(this),this._oncomplete()):this.loop||(this.status=0,this.autoRemove&&this.game.timer.remove(this))))}},Tiny.TimerCreator=function(t){this.game=t,this.game.timers=[],this.autoStart=!0,this.autoRemove=!0},Tiny.TimerCreator.prototype={removeAll:function(){this.game.timers.forEach(function(t){t.stop()}),this.game.timers=[]},remove:function(t){t.stop(),this.game.timers.splice(this.game.timers.indexOf(t),1)},add:function(t,e){var i=new Tiny.Timer(this.autoStart?1:0,this.autoRemove,this.game,e,t);return this.game.timers.push(i),i},loop:function(t,e){var i=new Tiny.Timer(this.autoStart?1:0,this.autoRemove,this.game,e,t,!0);return this.game.timers.push(i),i},repeat:function(t,e,i,n){var s=new Tiny.Timer(this.autoStart?1:0,this.autoRemove,this.game,i,t,!1,e,n);return this.game.timers.push(s),s}}},function(t,e){Tiny.EventTarget={call:function(t){t&&(t=t.prototype||t,Tiny.EventTarget.mixin(t))},mixin:function(t){t.listeners=function(t){return this._listeners=this._listeners||{},this._listeners[t]?this._listeners[t].slice():[]},t.emit=t.dispatchEvent=function(t,e){if(this._listeners=this._listeners||{},"object"==typeof t&&(e=t,t=t.type),e&&!0===e.__isEventObject||(e=new Tiny.Event(this,t,e)),this._listeners&&this._listeners[t]){var i,n=this._listeners[t].slice(0),s=n.length,r=n[0];for(i=0;i<s;r=n[++i])if(r._cb_.call(r._ctx_,e),e.stoppedImmediate)return this;if(e.stopped)return this}return this.parent&&this.parent.emit&&this.parent.emit.call(this.parent,t,e),this},t.on=t.addEventListener=function(t,e,i){return this._listeners=this._listeners||{},(this._listeners[t]=this._listeners[t]||[]).push({_cb_:e,_ctx_:i}),this},t.once=function(t,e,i){function n(){e.apply(s.off(t,n),arguments)}this._listeners=this._listeners||{};var s=this;return n._originalHandler=e,this.on(t,n,i)},t.off=t.removeEventListener=function(t,e){if(this._listeners=this._listeners||{},!this._listeners[t])return this;for(var i=this._listeners[t],n=e?i.length:0;n-- >0;)i[n]!==e&&i[n]._originalHandler!==e||i.splice(n,1);return 0===i.length&&delete this._listeners[t],this},t.removeAllListeners=function(t){return this._listeners=this._listeners||{},this._listeners[t]?(delete this._listeners[t],this):this}}},Tiny.Event=function(t,e,i){for(var n in i)this[n]=i[n];this.__isEventObject=!0,this.stopped=!1,this.stoppedImmediate=!1,this.target=t,this.type=e,this.timeStamp=Date.now()},Tiny.Event.prototype.stopPropagation=function(){this.stopped=!0},Tiny.Event.prototype.stopImmediatePropagation=function(){this.stoppedImmediate=!0}},function(t,e,i){(function(t){var e=function(){this._tweens={},this._tweensAddedDuringUpdate={}};e.prototype={getAll:function(){return Object.keys(this._tweens).map(function(t){return this._tweens[t]}.bind(this))},removeAll:function(){this._tweens={}},add:function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},remove:function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},update:function(t,e){var n=Object.keys(this._tweens);if(0===n.length)return!1;for(t=void 0!==t?t:i.now();n.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<n.length;s++){var r=this._tweens[n[s]];r&&!1===r.update(t)&&(r._isPlaying=!1,e||delete this._tweens[n[s]])}n=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var i=new e;i.Group=e,i._nextId=0,i.nextId=function(){return i._nextId++},"undefined"==typeof self&&void 0!==t&&t.hrtime?i.now=function(){var e=t.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?i.now=self.performance.now.bind(self.performance):void 0!==Date.now?i.now=Date.now:i.now=function(){return(new Date).getTime()},i.Tween=function(t,e){this._isPaused=!1,this._pauseStart=null,this._object=t,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=i.Easing.Linear.None,this._interpolationFunction=i.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onRepeatCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=e||i,this._id=i.nextId()},i.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},isPaused:function(){return this._isPaused},to:function(t,e){return this._valuesEnd=Object.create(t),void 0!==e&&(this._duration=e),this},duration:function(t){return this._duration=t,this},start:function(t){this._group.add(this),this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._startTime=void 0!==t?"string"==typeof t?i.now()+parseFloat(t):t:i.now(),this._startTime+=this._delayTime;for(var e in this._valuesEnd){if(this._valuesEnd[e]instanceof Array){if(0===this._valuesEnd[e].length)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}void 0!==this._object[e]&&(void 0===this._valuesStart[e]&&(this._valuesStart[e]=this._object[e]),this._valuesStart[e]instanceof Array==!1&&(this._valuesStart[e]*=1),this._valuesStartRepeat[e]=this._valuesStart[e]||0)}return this},stop:function(){return this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens(),this):this},end:function(){return this.update(1/0),this},pause:function(t){return this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=void 0===t?i.now():t,this._group.remove(this),this)},resume:function(t){return this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=(void 0===t?i.now():t)-this._pauseStart,this._pauseStart=0,this._group.add(this),this):this},stopChainedTweens:function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop()},group:function(t){return this._group=t,this},delay:function(t){return this._delayTime=t,this},repeat:function(t){return this._repeat=t,this},repeatDelay:function(t){return this._repeatDelayTime=t,this},yoyo:function(t){return this._yoyo=t,this},easing:function(t){return this._easingFunction=t,this},interpolation:function(t){return this._interpolationFunction=t,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(t){return this._onStartCallback=t,this},onUpdate:function(t){return this._onUpdateCallback=t,this},onRepeat:function(t){return this._onRepeatCallback=t,this},onComplete:function(t){return this._onCompleteCallback=t,this},onStop:function(t){return this._onStopCallback=t,this},update:function(t){var e,i,n;if(t<this._startTime)return!0;!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),i=(t-this._startTime)/this._duration,i=0===this._duration||i>1?1:i,n=this._easingFunction(i);for(e in this._valuesEnd)if(void 0!==this._valuesStart[e]){var s=this._valuesStart[e]||0,r=this._valuesEnd[e];r instanceof Array?this._object[e]=this._interpolationFunction(r,n):("string"==typeof r&&(r="+"===r.charAt(0)||"-"===r.charAt(0)?s+parseFloat(r):parseFloat(r)),"number"==typeof r&&(this._object[e]=s+(r-s)*n))}if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object,i),1===i){if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(e in this._valuesStartRepeat){if("string"==typeof this._valuesEnd[e]&&(this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(this._valuesEnd[e])),this._yoyo){var h=this._valuesStartRepeat[e];this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=h}this._valuesStart[e]=this._valuesStartRepeat[e]}return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,null!==this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var o=0,a=this._chainedTweens.length;o<a;o++)this._chainedTweens[o].start(this._startTime+this._duration);return!1}return!0}},i.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2,t<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1)}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-i.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*i.Easing.Bounce.In(2*t):.5*i.Easing.Bounce.Out(2*t-1)+.5}}},i.Interpolation={Linear:function(t,e){var n=t.length-1,s=n*e,r=Math.floor(s),h=i.Interpolation.Utils.Linear;return e<0?h(t[0],t[1],s):e>1?h(t[n],t[n-1],n-s):h(t[r],t[r+1>n?n:r+1],s-r)},Bezier:function(t,e){for(var n=0,s=t.length-1,r=Math.pow,h=i.Interpolation.Utils.Bernstein,o=0;o<=s;o++)n+=r(1-e,s-o)*r(e,o)*t[o]*h(s,o);return n},CatmullRom:function(t,e){var n=t.length-1,s=n*e,r=Math.floor(s),h=i.Interpolation.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(r=Math.floor(s=n*(1+e))),h(t[(r-1+n)%n],t[r],t[(r+1)%n],t[(r+2)%n],s-r)):e<0?t[0]-(h(t[0],t[0],t[1],t[1],-s)-t[0]):e>1?t[n]-(h(t[n],t[n],t[n-1],t[n-1],s-n)-t[n]):h(t[r?r-1:0],t[r],t[n<r+1?n:r+1],t[n<r+2?n:r+2],s-r)},Utils:{Linear:function(t,e,i){return(e-t)*i+t},Bernstein:function(t,e){var n=i.Interpolation.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:function(){var t=[1];return function(e){var i=1;if(t[e])return t[e];for(var n=e;n>1;n--)i*=n;return t[e]=i,i}}(),CatmullRom:function(t,e,i,n,s){var r=.5*(i-t),h=.5*(n-e),o=s*s;return(2*e-2*i+r+h)*(s*o)+(-3*e+3*i-2*r-h)*o+r*s+e}}},Tiny._tween_enabled=!0,window.TWEEN=i}).call(e,i(25))},function(t,e){Date.now||(Date.now=function(){return(new Date).getTime()}),"undefined"==typeof Float32Array&&(window.Float32Array=Array)},function(t,e){Tiny.RAF=function(t,e){void 0===e&&(e=!1),this.game=t,this.isRunning=!1,this.forceSetTimeOut=e;for(var i=["ms","moz","webkit","o"],n=0;n<i.length&&!window.requestAnimationFrame;n++)window.requestAnimationFrame=window[i[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[n]+"CancelAnimationFrame"]||window[i[n]+"CancelRequestAnimationFrame"];this._isSetTimeOut=!1,this._onLoop=null,this._timeOutID=null,this._prevTime=0},Tiny.RAF.prototype={start:function(){this.isRunning=!0;var t=this;!window.requestAnimationFrame||this.forceSetTimeOut?(this._isSetTimeOut=!0,this._onLoop=function(){return t.updateSetTimeout()},this._timeOutID=window.setTimeout(this._onLoop,0)):(this._isSetTimeOut=!1,this._onLoop=function(e){return t.updateRAF(e)},this._timeOutID=window.requestAnimationFrame(this._onLoop))},updateRAF:function(t){this.isRunning&&(this.game.update(Math.floor(t),t-this._prevTime),this._timeOutID=window.requestAnimationFrame(this._onLoop)),this._prevTime=t},updateSetTimeout:function(){var t=Date.now();this.isRunning&&(this.game.update(t-this.paused,t-this._prevTime),this._timeOutID=window.setTimeout(this._onLoop,this.game.time.timeToCall)),this._prevTime=t},stop:function(){this._isSetTimeOut?clearTimeout(this._timeOutID):window.cancelAnimationFrame(this._timeOutID),this.isRunning=!1},isSetTimeOut:function(){return this._isSetTimeOut},isRAF:function(){return!1===this._isSetTimeOut}}},function(t,e){function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function s(t){if(l===setTimeout)return setTimeout(t,0);if((l===i||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function r(t){if(u===clearTimeout)return clearTimeout(t);if((u===n||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(t);try{return u(t)}catch(e){try{return u.call(null,t)}catch(e){return u.call(this,t)}}}function h(){f&&d&&(f=!1,d.length?y=d.concat(y):T=-1,y.length&&o())}function o(){if(!f){var t=s(h);f=!0;for(var e=y.length;e;){for(d=y,y=[];++T<e;)d&&d[T].run();T=-1,e=y.length}d=null,f=!1,r(t)}}function a(t,e){this.fun=t,this.array=e}function c(){}var l,u,p=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:i}catch(t){l=i}try{u="function"==typeof clearTimeout?clearTimeout:n}catch(t){u=n}}();var d,y=[],f=!1,T=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];y.push(new a(t,e)),1!==y.length||f||s(o)},a.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.prependListener=c,p.prependOnceListener=c,p.listeners=function(t){return[]},p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(t,e,i){i(23),i(4),i(9),i(10),i(3),i(2),i(1),i(24),i(12),i(11),i(13),i(14),Tiny.Polygon=function(){},i(18),i(19),i(5),i(6),i(7),i(8),i(16),i(15),i(17),i(0),i(20),i(22),i(21)}]);