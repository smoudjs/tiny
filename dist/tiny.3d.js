!function(){var t={847:function(){Date.now||(Date.now=function(){return(new Date).getTime()}),'undefined'==typeof Float32Array&&(window.Float32Array=Array,window.Uint16Array=Array),void 0===Object.assign&&(Object.assign=function(t){'use strict';if(null==t)throw new TypeError('Cannot convert undefined or null to object');for(var i=Object(t),e=1;e<arguments.length;e++){var s=arguments[e];if(null!=s)for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(i[n]=s[n])}return i})}},i={};function e(s){var n=i[s];if(void 0!==n)return n.exports;var r=i[s]={exports:{}};return t[s](r,r.exports,e),r.exports}!function(){"use strict";e(847);var t=function(t,i,e){this.width=t,this.height=i,this.canvas=document.createElement('canvas'),this.context=this.canvas.getContext('2d',e),this.canvas.width=t,this.canvas.height=i};function i(){this.a=[],this.n=0}t.prototype.constructor=t,t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.width,this.height)},t.prototype.resize=function(t,i){this.width=this.canvas.width=t,this.height=this.canvas.height=i};var s={call:function(t){t&&(t=t.prototype||t,s.mixin(t))},mixin:function(t){const e={};function s(t,s,n,r){var h=e[t];h||(h=e[t]=new i),h.a.push(s,n||null,r||!1),h.n+=3}t.once=function(t,i,e){s(t,i,e,!0)},t.on=s,t.off=function(t,i,s){if(e[t]){var n=e[t].a;if(i)if(s)for(r=0;r<n.length;r+=3)n[r]==i&&n[r+1]==s&&(n.splice(r,3),r-=3);else for(var r=0;r<n.length;r+=3)n[r]==i&&(n.splice(r,3),r-=3);else n.length=0;0==n.length&&delete e[t]}},t.emit=function(t,i,s,n){var r=e[t];if(r){var h=r.a;r.n=0;for(var a,o,u=arguments.length,l=0;l<h.length-r.n;l+=3)a=h[l],o=h[l+1],h[l+2]&&(h.splice(l,3),l-=3),u<=1?a.call(o):2==u?a.call(o,i):3==u?a.call(o,i,s):a.call(o,i,s,n);0==h.length&&delete e[t]}}}},n=0;var r=Math.PI/180,h=180/Math.PI,a={distance:function(t,i,e,s){var n=t-e,r=i-s;return Math.sqrt(n*n+r*r)},clamp:function(t,i,e){return Math.max(i,Math.min(e,t))},degToRad:function(t){return t*r},radToDeg:function(t){return t*h},isPow2:function(t){return!(t&t-1||!t)},getNextPow2:function(t){if(t>0&&0==(t&t-1))return t;for(var i=1;i<t;)i<<=1;return i}};function o(t,i,e){return this.r=1,this.g=1,this.b=1,this.a=1,this.int=16777215,void 0===i&&void 0===e?this.set(t):this.setRGB(t,i,e)}Object.assign(o.prototype,{set:function(t){return t&&'number'==typeof t.int?this.copy(t):'number'==typeof t?this.setHex(t):'string'==typeof t&&this.setStyle(t),this},refresh:function(){return this.int=(255*this.r<<16)+(255*this.g<<8)+(255*this.b|0),this},setHex:function(t){return t|=0,this.int=t,this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,i,e){return this.r=t,this.g=i,this.b=e,this.refresh()},setStyle:function(t){var i=t.length;if(4===i){var e=t.charAt(1),s=t.charAt(2),n=t.charAt(3);return this.setHex(+('0x'+e+e+s+s+n+n))}return 7===i?this.setHex(+t.replace('#','0x')):this},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this.refresh()},toStyle(){return'#'+('00000'+this.int.toString(16)).slice(-6)},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this.refresh()},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t}}),o.WHITE=new o;var u=function(t,i){this.x=t||0,this.y=i||0};u.prototype={set:function(t,i){return this.x=t||0,this.y=i||(0!==i?this.x:0),this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},copy:function(t){return this.x=t.x,this.y=t.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this}};var l=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0};l.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},l.prototype.toArray=function(t){this.array||(this.array=new Float32Array(9));var i=this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},l.prototype.apply=function(t,i){i=i||new u;var e=t.x,s=t.y;return i.x=this.a*e+this.c*s+this.tx,i.y=this.b*e+this.d*s+this.ty,i},l.prototype.applyInverse=function(t,i){i=i||new u;var e=1/(this.a*this.d+this.c*-this.b),s=t.x,n=t.y;return i.x=this.d*e*s+-this.c*e*n+(this.ty*this.c-this.tx*this.d)*e,i.y=this.a*e*n+-this.b*e*s+(-this.ty*this.a+this.tx*this.b)*e,i},l.prototype.translate=function(t,i){return this.tx+=t,this.ty+=i,this},l.prototype.scale=function(t,i){return this.a*=t,this.d*=i,this.c*=t,this.b*=i,this.tx*=t,this.ty*=i,this},l.prototype.rotate=function(t){var i=Math.cos(t),e=Math.sin(t),s=this.a,n=this.c,r=this.tx;return this.a=s*i-this.b*e,this.b=s*e+this.b*i,this.c=n*i-this.d*e,this.d=n*e+this.d*i,this.tx=r*i-this.ty*e,this.ty=r*e+this.ty*i,this},l.prototype.append=function(t){var i=this.a,e=this.b,s=this.c,n=this.d;return this.a=t.a*i+t.b*s,this.b=t.a*e+t.b*n,this.c=t.c*i+t.d*s,this.d=t.c*e+t.d*n,this.tx=t.tx*i+t.ty*s+this.tx,this.ty=t.tx*e+t.ty*n+this.ty,this},l.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this};new l;const c={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4};var d={VERSION:'3.0.3',CanvasBuffer:t,EventEmitter:s,Math:a,Mat3:l,Vec2:u,Color:o};Object.assign(d,{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},{LINEAR:0,NEAREST:1},c),window.Tiny=d;var p=[];function f(t,i){p.push({name:t,_class_:i})}var m,y,g,x,v,_=function(){},w=function(t){this.callbackContext=this,this.state=0,this.timeScale=1,this.width=0,this.height=0,this.systems=[],this.updatable=[],this.paused=!1,this.pauseDuration=0,this.inputView=document.body,Tiny.app||(Tiny.app=this),s.mixin(this),t=t||{},this.boot=t.boot||this.boot||_,this.preload=t.preload||this.preload||_,this.create=t.create||this.create||_,this.update=t.update||this.update||_,this.render=t.render||this.render||_,this._resize_cb=t.resize||_,this._destroy_cb=t.destroy||_;var i=this;setTimeout((function(){i._boot()}),0)};w.prototype._boot=function(){for(var t=0;t<p.length;t++){var i=p[t],e=new i._class_(this);this.systems.push(e),e.update&&this.updatable.push(e),i.name&&(this[i.name]=e)}Tiny.RAF&&(this.raf=new Tiny.RAF(this)),this.boot.call(this.callbackContext);var s=this;setTimeout((function(){s.load?s._preload():s._create()}),0)},w.prototype._preload=function(){this.preload.call(this.callbackContext),this.state=1,this.load.start(this._create)},w.prototype._create=function(){this.emit('load'),this.create.call(this.callbackContext),this.raf&&this.raf.start(),this.state=2},w.prototype.pause=function(){if(this.raf&&this.raf.reset(),!this.paused){for(var t=0;t<this.systems.length;t++)this.systems[t].pause&&this.systems[t].pause();this.paused=!0}},w.prototype.resume=function(){if(this.raf&&this.raf.reset(),this.paused){for(var t=0;t<this.systems.length;t++)this.systems[t].resume&&this.systems[t].resume();this.paused=!1}},w.prototype._update=function(t,i){if(this.paused)this.pauseDuration+=i;else{i*=this.timeScale,this.update.call(this.callbackContext,t,i),this.emit('update',i);for(var e=0;e<this.updatable.length;e++)this.updatable[e].update(i)}this.render(),this.emit('postrender')},w.prototype.resize=function(t,i){this.width=t||this.width,this.height=i||this.height,this.state>0&&(this._resize_cb.call(this.callbackContext,this.width,this.height),this.emit('resize',t,i));var e=this;setTimeout((function(){e.input&&e.input.updateBounds()}),0)},w.prototype.destroy=function(t){for(var i=0;i<this.systems.length;i++)this.systems[i].destroy&&this.systems[i].destroy(t);this.paused=!0,t&&this.load.clearCache(),this.raf&&this.raf.stop(),this._destroy_cb.call(this.callbackContext),Tiny.app===this&&(Tiny.app=null)};var b=function(){return(new Date).getTime()};void 0!==self.performance&&void 0!==self.performance.now?b=self.performance.now.bind(self.performance):void 0!==Date.now&&(b=Date.now);var M=function(t,i){void 0===i&&(i=!1),this.game=t,this.isRunning=!1,this.forceSetTimeOut=i;for(var e=['ms','moz','webkit','o'],s=0;s<e.length&&!window.requestAnimationFrame;s++)window.requestAnimationFrame=window[e[s]+'RequestAnimationFrame'],window.cancelAnimationFrame=window[e[s]+'CancelAnimationFrame']||window[e[s]+'CancelRequestAnimationFrame'];m=!1,y=null,g=null,x=0,v=0};M.prototype={start:function(){x=b(),this.isRunning=!0;var t=this;!window.requestAnimationFrame||this.forceSetTimeOut?(m=!0,y=function(){return t.updateSetTimeout()},g=window.setTimeout(y,0)):(m=!1,y=function(){return t.updateRAF()},g=window.requestAnimationFrame(y))},updateRAF:function(){v=b(),this.isRunning&&(this.game._update(Math.floor(v),v-x),g=window.requestAnimationFrame(y)),x=v},updateSetTimeout:function(){v=b(),this.isRunning&&(this.game._update(Math.floor(v),v-x),g=window.setTimeout(y,M.timeToCall)),x=v},reset:function(){x=b()},stop:function(){m?clearTimeout(g):window.cancelAnimationFrame(g),this.isRunning=!1}},M.timeToCall=15;var z={image:{},texture:{}},A=function(t){s.mixin(this),t.cache=z,this.game=t,this.list=[]};A.prototype={clearCache:function(){for(var t in z.texture)z.texture[t].destroy();for(var t in z)z[t]={}},all:function(t){this.list=this.list.concat(t)},start:function(t){var i=this,e=i.game,s=i.list,n=s.length;function r(){var t=s.shift(),i=A[t.type];i?i(t,h):h()}function h(h,a){i.emit('progress',1-s.length/n),0!=s.length?r():(i.emit('complete'),t.call(e))}0!=n?r():t.call(e)}},f('load',A);var E=function(t,i){this.resolution=1,this.width=100,this.height=100,this.scaleMode=i||0,this.valid=!1,this.source=t,this._UID=++n,this.premultipliedAlpha=!0,this._glTextures=[],this.mipmap=!1,this._dirty=[!0,!0,!0,!0],t&&((t.complete||t.getContext)&&t.width&&t.height?this.onLoad():t.onload=this.onLoad.bind(this),this.imageUrl=null,this._powerOf2=!1)};E.prototype.constructor=E,E.prototype.onLoad=function(t){this.valid=!0,this.width=this.source.naturalWidth||this.source.width,this.height=this.source.naturalHeight||this.source.height,this.dirty(),this.onload&&this.onload()},E.prototype.destroy=function(){this.imageUrl?(delete BaseTextureCache[this.imageUrl],delete PIXI.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src='')):this.source&&this.source._pixiId&&delete BaseTextureCache[this.source._pixiId],this.source=null,this.unloadFromGPU()},E.prototype.dirty=function(){for(var t=0;t<this._glTextures.length;t++)this._dirty[t]=!0},E.prototype.unloadFromGPU=function(){this.dirty();for(var t=this._glTextures.length-1;t>=0;t--){var i=this._glTextures[t],e=Tiny.glContexts[t];e&&i&&e.deleteTexture(i)}this._glTextures.length=0,this.dirty()};var T=function(t,i){var e=new Image;e.addEventListener('load',(function(){var s=new E(e);z.image[t.key]=s,i(t,s)})),e.src=t.src};A.image=T,A.prototype.image=function(t,i){this.list.push({src:i,key:t,type:'image'})};var C=function(t,i,e,s){this.x=t||0,this.y=i||0,this.width=e||0,this.height=s||0,this.type=c.RECT};C.prototype.contains=function(t,i){if(this.width<=0||this.height<=0)return!1;var e=this.x;if(t>=e&&t<=e+this.width){var s=this.y;if(i>=s&&i<=s+this.height)return!0}return!1},C.prototype.constructor=C;new C(0,0,0,0);var F=function(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0},S=function(t,i,e,s){if(this.noFrame=!1,i||(this.noFrame=!0,i=new C(0,0,1,1)),'string'==typeof t){var n=t;if(!(t=z.image[n]))throw new Error('Cache Error: image '+n+' does`t found in cache');z.texture[n]=this,this.key=n}else t instanceof S?t=t.base:t instanceof E||(t=new E(t));this.base=t,this.frame=i,this.trim=s,this.valid=!1,this._uvs=null,this.width=0,this.height=0,this.crop=e||new C(0,0,1,1),t.valid?this.onBaseUpdate():t.onload=this.onBaseUpdate.bind(this)};S.prototype.constructor=S,S.prototype.onBaseUpdate=function(){var t=this.base;this.noFrame&&(this.frame=new C(0,0,t.width,t.height)),this.setFrame(this.frame)},S.prototype.addToCache=function(t,i){this.key=this.key||t,this.frame.name=this.frame.name||i,this.frame.name&&(t+='.'+this.frame.name),z.texture[t]=this},S.prototype.destroy=function(t){t&&this.base.destroy(),this.key&&delete z.texture[this.key],this.valid=!1},S.prototype.setFrame=function(t){this.noFrame=!1,this.frame=t,this.width=t.width,this.height=t.height,this.crop.x=t.x,this.crop.y=t.y,this.crop.width=t.width,this.crop.height=t.height,this.trim||!(t.x+t.width>this.base.width||t.y+t.height>this.base.height)?(this.valid=t&&t.width&&t.height&&this.base.valid,this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,this.frame.height=this.trim.height),this.valid&&this._updateUvs()):this.valid=!1},S.prototype._updateUvs=function(){this._uvs||(this._uvs=new F);var t=this.crop,i=this.base.width,e=this.base.height;this._uvs.x0=t.x/i,this._uvs.y0=t.y/e,this._uvs.x1=(t.x+t.width)/i,this._uvs.y1=t.y/e,this._uvs.x2=(t.x+t.width)/i,this._uvs.y2=(t.y+t.height)/e,this._uvs.x3=t.x/i,this._uvs.y3=(t.y+t.height)/e};A.atlas=function(t,i){var e=t.key;T(t,(function(t,s){for(var n=0;n<t.data.length;n++){var r=e+'.'+t.data[n].name,h=new S(s,t.data[n]);h.key=e,z.texture[r]=h}i()}))},A.prototype.atlas=function(t,i,e){this.list.push({src:i,key:t,data:e,type:'atlas'})};var O;A.spritesheet=function(t,i){var e=t.key;T(t,(function(t,s){var n,r,h;if(t.data){var a=t.data;n=a.length-1;for(var o=0;o<=n;o++)r=e+'.'+o,(h=new S(s,{name:o,x:Math.floor(a[o].x),y:Math.floor(a[o].y),width:Math.floor(a[o].width),height:Math.floor(a[o].height),duration:a[o].duration})).key=e,h.lastFrame=n,z.texture[r]=h}else{var u=s.width,l=s.height,c=t.width,d=t.height;c||(c=Math.floor(u/(t.cols||1))),d||(d=Math.floor(l/(t.rows||1)));var p=Math.floor(u/c)*Math.floor(l/d);if(0===p)return i();t.total&&(p=Math.min(p,t.total));var f=0,m=0;n=p-1;for(o=0;o<p;o++)r=e+'.'+o,(h=new S(s,{name:o,x:f,y:m,width:c,height:d,duration:t.duration})).key=e,h.lastFrame=n,z.texture[r]=h,(f+=c)+c>u&&(f=0,m+=d)}i()}))},A.prototype.spritesheet=function(t,i,e,s,n,r){var h={src:i,key:t,type:'spritesheet'};'number'==typeof e?(h.width=e,h.height=s,h.total=n,h.duration=r):e.length>0&&(h.data=e),this.list.push(h)};var L=function(t){this.game=t;var i=this.domElement=t.inputView;this.bounds={x:0,y:0,width:0,height:0},this.candidates=[],this.list=[],this.lastMove=null,this.isDown=!1,this.downHandler=this.downHandler.bind(this),this.moveHandler=this.moveHandler.bind(this),this.upHandler=this.upHandler.bind(this),i.addEventListener('touchstart',this.downHandler),i.addEventListener('touchmove',this.moveHandler),i.addEventListener('touchend',this.upHandler),i.addEventListener('touchcancel',this.upHandler),i.addEventListener('mousedown',this.downHandler),i.addEventListener('mousemove',this.moveHandler),i.addEventListener('mouseup',this.upHandler),s.mixin(this);for(var e=0;e<L.systems.length;e++)L.systems[e].init.call(this);this.updateBounds()};L.prototype={add:function(t,i){t.inputEnabled=!0,(i=i||{}).system=this,t.input=i,s.mixin(t.input),this.list.push(t)},remove:function(t){var i=this.list.indexOf(t);if(i>-1){var e=this.list[i];return e.input=null,e.inputEnabled=!1,this.list.splice(i,1),e}},inputHandler:function(t,i){var e=this.getCoords(i);if(null!==e){if('move'!=t){this.candidates.length=0;for(var s=0;s<L.systems.length;s++)L.systems[s].preHandle.call(this,e.x,e.y);for(var n,r=0;r<this.list.length;r++)(n=this.list[r]).inputEnabled&&n.parent&&(n.input.checkBounds?n.input.checkBounds.call(this,n,e.x,e.y):L.checkBounds.call(this,n,e.x,e.y))&&this.candidates.push(n);for(s=this.candidates.length-1;s>=0;s--){if((n=this.candidates[s]).input['last_'+t]={x:e.x,y:e.y},n.input.emit(t,{x:e.x,y:e.y}),'up'==t){var h=n.input.last_down;h&&a.distance(h.x,h.y,e.x,e.y)<30&&n.input.emit('click',{x:e.x,y:e.y})}if(!n.input.transparent)break}}this.emit(t,{x:e.x,y:e.y})}},moveHandler:function(t){this.lastMove=t,this.inputHandler('move',t)},upHandler:function(t){this.isDown=!1,this.inputHandler('up',this.lastMove)},downHandler:function(t){this.isDown=!0,this.lastMove=t,this.inputHandler('down',t)},clickHandler:function(t){this.inputHandler('click',t)},getCoords:function(t){var i=null;return'undefined'!=typeof TouchEvent&&t instanceof TouchEvent?(O=!0,t.touches.length>0?i={x:t.touches[0].clientX,y:t.touches[0].clientY}:t.clientX&&t.clientY&&(i={x:t.clientX,y:t.clientY})):i={x:t.clientX,y:t.clientY},O&&t instanceof MouseEvent||null===i?null:i={x:i.x-this.bounds.x,y:i.y-this.bounds.y}},updateBounds:function(){var t=this.bounds,i=this.domElement.getBoundingClientRect();t.x=i.left,t.y=i.top,t.width=i.width,t.height=i.height},destroy:function(){var t=this.domElement;t.removeEventListener('touchstart',this.downHandler),t.removeEventListener('touchmove',this.moveHandler),t.removeEventListener('touchend',this.upHandler),t.removeEventListener('touchcancel',this.upHandler),t.removeEventListener('mousedown',this.downHandler),t.removeEventListener('mousemove',this.moveHandler),t.removeEventListener('mouseup',this.upHandler)}},L.checkBounds=function(t,i,e){if(t.worldVisible&&t.getBounds().contains(i,e))return!0},L.systems=[],f('input',L);var R=function(){},I=function(t,i,e,s,n,r,h,a,o){this.game=e,this.cb=s||R,this.ctx=n||this,this.delay=null==r?1e3:r,this.loop=h,this.count=a||0,this.repeat=this.count>0,this.running=!!t,this._lastFrame=0,this.autoRemove=i,this.onComplete=o||R};I.prototype={start:function(){this.running=!0},pause:function(){this.running=!1},stop:function(){this.running=!1,this._lastFrame=0},update:function(t){this.running&&(this._lastFrame+=t,this._lastFrame>=this.delay&&(this.cb.call(this.ctx),this._lastFrame=0,this.repeat?(this.count--,0===this.count&&(this.running=!1,this.autoRemove&&this.game.timer.remove(this),this.onComplete())):this.loop||(this.running=!1,this.autoRemove&&this.game.timer.remove(this))))}};var U=function(t){this.game=t,this.list=[],this.autoStart=!0,this.autoRemove=!0};U.prototype={update:function(t){for(var i=0;i<this.list.length;i++)this.list[i].update(t)},removeAll:function(){for(var t=0;t<this.list.length;t++)this.list[t].stop();this.list=[]},remove:function(t){var i=this.list.indexOf(t);i>-1&&(t.stop(),this.list.splice(i,1))},add:function(t,i,e,s,n){s=null!=s?s:this.autoStart,n=null!=n?n:this.autoRemove;var r=new I(s,n,this.game,i,e,t);return this.list.push(r),r},loop:function(t,i,e,s,n){s=null!=s?s:this.autoStart,n=null!=n?n:this.autoRemove;var r=new I(s,n,this.game,i,e,t,!0);return this.list.push(r),r},repeat:function(t,i,e,s,n,r,h){n=null!=n?n:this.autoStart,r=null!=r?r:this.autoRemove;var a=new I(n,r,this.game,e,s,t,!1,i,h);return this.list.push(a),a},destroy:function(){this.removeAll()}},f('timer',U);var j=function(){this._tweens={},this._tweensAddedDuringUpdate={}};j.prototype={getAll:function(){return Object.keys(this._tweens).map(function(t){return this._tweens[t]}.bind(this))},removeAll:function(){this._tweens={}},add:function(t){var i=t.getId();this._tweens[i]=t,this._tweensAddedDuringUpdate[i]=t},remove:function(t){var i=t.getId();delete this._tweens[i],delete this._tweensAddedDuringUpdate[i]},update:function(t,i){var e=Object.keys(this._tweens);if(0===e.length)return!1;for(;e.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<e.length;s++){var n=this._tweens[e[s]];n&&!1===n.update(t)&&(n._isPlaying=!1,i||delete this._tweens[e[s]])}e=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var k=new j;k.Group=j,k._nextId=0,k.nextId=function(){return k._nextId++};var P=function(t,i){this._isPaused=!1,this._object=t,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._time=0,this._easingFunction=D.Linear.None,this._interpolationFunction=B.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onRepeatCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=i||k,this._id=k.nextId()};P.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},isPaused:function(){return this._isPaused},to:function(t,i){return this._valuesEnd=Object.create(t),void 0!==i&&(this._duration=i),this},duration:function(t){return this._duration=t,this},start:function(t){for(var i in this._group.add(this),this._isPlaying=!0,this._isPaused=!1,this._time=0,this._onStartCallbackFired=!1,this._startTime=this._delayTime,this._valuesEnd){if(this._valuesEnd[i]instanceof Array){if(0===this._valuesEnd[i].length)continue;this._valuesEnd[i]=[this._object[i]].concat(this._valuesEnd[i])}void 0!==this._object[i]&&(1!=t&&void 0!==this._valuesStart[i]||(this._valuesStart[i]=this._object[i]),this._valuesStart[i]instanceof Array==!1&&(this._valuesStart[i]*=1),this._valuesStartRepeat[i]=this._valuesStart[i]||0)}return this},stop:function(){return this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens(),this):this},end:function(){return this.update(1/0),this},pause:function(){return this._isPaused||!this._isPlaying||(this._isPaused=!0,this._group.remove(this)),this},resume:function(){return this._isPaused&&this._isPlaying?(this._isPaused=!1,this._group.add(this),this):this},stopChainedTweens:function(){for(var t=0,i=this._chainedTweens.length;t<i;t++)this._chainedTweens[t].stop()},group:function(t){return this._group=t,this},delay:function(t){return this._delayTime=t,this},repeat:function(t){return this._repeat=t,this},repeatDelay:function(t){return this._repeatDelayTime=t,this},yoyo:function(t){return this._yoyo=t,this},easing:function(t){return this._easingFunction=t,this},interpolation:function(t){return this._interpolationFunction=t,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(t){return this._onStartCallback=t,this},onUpdate:function(t){return this._onUpdateCallback=t,this},onRepeat:function(t){return this._onRepeatCallback=t,this},onComplete:function(t){return this._onCompleteCallback=t,this},onStop:function(t){return this._onStopCallback=t,this},update:function(t){var i,e,s;if(this._time+=t,this._time<this._startTime)return!0;for(i in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),e=(this._time-this._startTime)/this._duration,e=0===this._duration||e>1?1:e,s=this._easingFunction(e),this._valuesEnd)if(void 0!==this._valuesStart[i]){var n=this._valuesStart[i]||0,r=this._valuesEnd[i];r instanceof Array?this._object[i]=this._interpolationFunction(r,s):('string'==typeof r&&(r='+'===r.charAt(0)||'-'===r.charAt(0)?n+parseFloat(r):parseFloat(r)),'number'==typeof r&&(this._object[i]=n+(r-n)*s))}if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object,e),1===e){if(this._time=0,this._repeat>0){for(i in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat){if('string'==typeof this._valuesEnd[i]&&(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo){var h=this._valuesStartRepeat[i];this._valuesStartRepeat[i]=this._valuesEnd[i],this._valuesEnd[i]=h}this._valuesStart[i]=this._valuesStartRepeat[i]}return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=this._repeatDelayTime:this._startTime=this._delayTime,null!==this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,o=this._chainedTweens.length;a<o;a++)this._chainedTweens[a].start();return!1}return!0}};var V,D={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){var i=1.70158;return t*t*((i+1)*t-i)},Out:function(t){var i=1.70158;return--t*t*((i+1)*t+i)+1},InOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)}},Bounce:{In:function(t){return 1-D.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*D.Bounce.In(2*t):.5*D.Bounce.Out(2*t-1)+.5}}},B={Linear:function(t,i){var e=t.length-1,s=e*i,n=Math.floor(s),r=B.Utils.Linear;return i<0?r(t[0],t[1],s):i>1?r(t[e],t[e-1],e-s):r(t[n],t[n+1>e?e:n+1],s-n)},Bezier:function(t,i){for(var e=0,s=t.length-1,n=Math.pow,r=B.Utils.Bernstein,h=0;h<=s;h++)e+=n(1-i,s-h)*n(i,h)*t[h]*r(s,h);return e},CatmullRom:function(t,i){var e=t.length-1,s=e*i,n=Math.floor(s),r=B.Utils.CatmullRom;return t[0]===t[e]?(i<0&&(n=Math.floor(s=e*(1+i))),r(t[(n-1+e)%e],t[n],t[(n+1)%e],t[(n+2)%e],s-n)):i<0?t[0]-(r(t[0],t[0],t[1],t[1],-s)-t[0]):i>1?t[e]-(r(t[e],t[e],t[e-1],t[e-1],s-e)-t[e]):r(t[n?n-1:0],t[n],t[e<n+1?e:n+1],t[e<n+2?e:n+2],s-n)},Utils:{Linear:function(t,i,e){return(i-t)*e+t},Bernstein:function(t,i){var e=B.Utils.Factorial;return e(t)/e(i)/e(t-i)},Factorial:(V=[1],function(t){var i=1;if(V[t])return V[t];for(var e=t;e>1;e--)i*=e;return V[t]=i,i}),CatmullRom:function(t,i,e,s,n){var r=.5*(e-t),h=.5*(s-i),a=n*n;return(2*i-2*e+r+h)*(n*a)+(-3*i+3*e-2*r-h)*a+r*n+i}}},N=function(t){this.game=t,this.bufferList=[],this.group=new j};N.prototype={remove:function(t){this.group.remove(t)},add:function(t){return new P(t,this.group)},pause:function(){for(var t in this.bufferList.length=0,this.group._tweens)this.bufferList.push(this.group._tweens[t]),this.group._tweens[t].pause()},resume(){for(var t=0;t<this.bufferList.length;t++)this.bufferList[t].resume();this.bufferList.length=0},update:function(t){this.group.update(t)},destroy:function(){this.bufferList.length=0,this.group.removeAll(),this.group=null}},f('tweens',N),Tiny.App=w,Tiny.RAF=M,Tiny.registerSystem=f,Tiny.systems=p,Tiny.TweenManager=N,Tiny.Cache=z,Tiny.Loader=A,Tiny.Easing=D,Tiny.Interpolation=B,Tiny.Input=L,Tiny.Timer=I;for(var X=[],G=0;G<256;G++)X[G]=(G<16?'0':'')+G.toString(16);var W={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,s=4294967295*Math.random()|0;return(X[255&t]+X[t>>8&255]+X[t>>16&255]+X[t>>24&255]+'-'+X[255&i]+X[i>>8&255]+'-'+X[i>>16&15|64]+X[i>>24&255]+'-'+X[63&e|128]+X[e>>8&255]+'-'+X[e>>16&255]+X[e>>24&255]+X[255&s]+X[s>>8&255]+X[s>>16&255]+X[s>>24&255]).toUpperCase()},clamp:function(t,i,e){return Math.max(i,Math.min(e,t))},euclideanModulo:function(t,i){return(t%i+i)%i},mapLinear:function(t,i,e,s,n){return s+(t-i)*(n-s)/(e-i)},lerp:function(t,i,e){return(1-e)*t+e*i},smoothstep:function(t,i,e){return t<=i?0:t>=e?1:(t=(t-i)/(e-i))*t*(3-2*t)},smootherstep:function(t,i,e){return t<=i?0:t>=e?1:(t=(t-i)/(e-i))*t*t*(t*(6*t-15)+10)},randInt:function(t,i){return t+Math.floor(Math.random()*(i-t+1))},randFloat:function(t,i){return t+Math.random()*(i-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*W.DEG2RAD},radToDeg:function(t){return t*W.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};function q(t,i,e,s){this._x=t||0,this._y=i||0,this._z=e||0,this._w=void 0!==s?s:1}Object.assign(q,{slerp:function(t,i,e,s){return e.copy(t).slerp(i,s)},slerpFlat:function(t,i,e,s,n,r,h){var a=e[s+0],o=e[s+1],u=e[s+2],l=e[s+3],c=n[r+0],d=n[r+1],p=n[r+2],f=n[r+3];if(l!==f||a!==c||o!==d||u!==p){var m=1-h,y=a*c+o*d+u*p+l*f,g=y>=0?1:-1,x=1-y*y;if(x>Number.EPSILON){var v=Math.sqrt(x),_=Math.atan2(v,y*g);m=Math.sin(m*_)/v,h=Math.sin(h*_)/v}var w=h*g;if(a=a*m+c*w,o=o*m+d*w,u=u*m+p*w,l=l*m+f*w,m===1-h){var b=1/Math.sqrt(a*a+o*o+u*u+l*l);a*=b,o*=b,u*=b,l*=b}}t[i]=a,t[i+1]=o,t[i+2]=u,t[i+3]=l}}),Object.defineProperties(q.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(q.prototype,{isQuaternion:!0,set:function(t,i,e,s){return this._x=t,this._y=i,this._z=e,this._w=s,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,i){if(!t||!t.isEuler)throw new Error('Tiny.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.');var e=t._x,s=t._y,n=t._z,r=t.order,h=Math.cos,a=Math.sin,o=h(e/2),u=h(s/2),l=h(n/2),c=a(e/2),d=a(s/2),p=a(n/2);return'XYZ'===r?(this._x=c*u*l+o*d*p,this._y=o*d*l-c*u*p,this._z=o*u*p+c*d*l,this._w=o*u*l-c*d*p):'YXZ'===r?(this._x=c*u*l+o*d*p,this._y=o*d*l-c*u*p,this._z=o*u*p-c*d*l,this._w=o*u*l+c*d*p):'ZXY'===r?(this._x=c*u*l-o*d*p,this._y=o*d*l+c*u*p,this._z=o*u*p+c*d*l,this._w=o*u*l-c*d*p):'ZYX'===r?(this._x=c*u*l-o*d*p,this._y=o*d*l+c*u*p,this._z=o*u*p-c*d*l,this._w=o*u*l+c*d*p):'YZX'===r?(this._x=c*u*l+o*d*p,this._y=o*d*l+c*u*p,this._z=o*u*p-c*d*l,this._w=o*u*l-c*d*p):'XZY'===r&&(this._x=c*u*l-o*d*p,this._y=o*d*l-c*u*p,this._z=o*u*p+c*d*l,this._w=o*u*l+c*d*p),!1!==i&&this._onChangeCallback(),this},setFromAxisAngle:function(t,i){var e=i/2,s=Math.sin(e);return this._x=t.x*s,this._y=t.y*s,this._z=t.z*s,this._w=Math.cos(e),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var i,e=t.elements,s=e[0],n=e[4],r=e[8],h=e[1],a=e[5],o=e[9],u=e[2],l=e[6],c=e[10],d=s+a+c;return d>0?(i=.5/Math.sqrt(d+1),this._w=.25/i,this._x=(l-o)*i,this._y=(r-u)*i,this._z=(h-n)*i):s>a&&s>c?(i=2*Math.sqrt(1+s-a-c),this._w=(l-o)/i,this._x=.25*i,this._y=(n+h)/i,this._z=(r+u)/i):a>c?(i=2*Math.sqrt(1+a-s-c),this._w=(r-u)/i,this._x=(n+h)/i,this._y=.25*i,this._z=(o+l)/i):(i=2*Math.sqrt(1+c-s-a),this._w=(h-n)/i,this._x=(r+u)/i,this._y=(o+l)/i,this._z=.25*i),this._onChangeCallback(),this},setFromUnitVectors:function(t,i){var e=t.dot(i)+1;return e<1e-6?(e=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=e):(this._x=0,this._y=-t.z,this._z=t.y,this._w=e)):(this._x=t.y*i.z-t.z*i.y,this._y=t.z*i.x-t.x*i.z,this._z=t.x*i.y-t.y*i.x,this._w=e),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(W.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,i){var e=this.angleTo(t);if(0===e)return this;var s=Math.min(1,i/e);return this.slerp(t,s),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,i){return void 0!==i?this.multiplyQuaternions(t,i):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,i){var e=t._x,s=t._y,n=t._z,r=t._w,h=i._x,a=i._y,o=i._z,u=i._w;return this._x=e*u+r*h+s*o-n*a,this._y=s*u+r*a+n*h-e*o,this._z=n*u+r*o+e*a-s*h,this._w=r*u-e*h-s*a-n*o,this._onChangeCallback(),this},slerp:function(t,i){if(0===i)return this;if(1===i)return this.copy(t);var e=this._x,s=this._y,n=this._z,r=this._w,h=r*t._w+e*t._x+s*t._y+n*t._z;if(h<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,h=-h):this.copy(t),h>=1)return this._w=r,this._x=e,this._y=s,this._z=n,this;var a=1-h*h;if(a<=Number.EPSILON){var o=1-i;return this._w=o*r+i*this._w,this._x=o*e+i*this._x,this._y=o*s+i*this._y,this._z=o*n+i*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(a),l=Math.atan2(u,h),c=Math.sin((1-i)*l)/u,d=Math.sin(i*l)/u;return this._w=r*c+this._w*d,this._x=e*c+this._x*d,this._y=s*c+this._y*d,this._z=n*c+this._z*d,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,i){return void 0===i&&(i=0),this._x=t[i],this._y=t[i+1],this._z=t[i+2],this._w=t[i+3],this._onChangeCallback(),this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._w,t},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var Y=new Z,H=new q;function Z(t,i,e){this.x=t||0,this.y=i||0,this.z=e||0}Object.assign(Z.prototype,{isVector3:!0,set:function(t,i,e){return this.x=t,this.y=i,this.z=e,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error('index is out of range: '+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error('index is out of range: '+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,i){return void 0!==i?this.addVectors(t,i):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this},sub:function(t,i){return void 0!==i?this.subVectors(t,i):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this},multiply:function(t,i){return void 0!==i?this.multiplyVectors(t,i):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this},applyEuler:function(t){return!t||t.isEuler,this.applyQuaternion(H.setFromEuler(t))},applyAxisAngle:function(t,i){return this.applyQuaternion(H.setFromAxisAngle(t,i))},applyMatrix3:function(t){var i=this.x,e=this.y,s=this.z,n=t.elements;return this.x=n[0]*i+n[3]*e+n[6]*s,this.y=n[1]*i+n[4]*e+n[7]*s,this.z=n[2]*i+n[5]*e+n[8]*s,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var i=this.x,e=this.y,s=this.z,n=t.elements,r=1/(n[3]*i+n[7]*e+n[11]*s+n[15]);return this.x=(n[0]*i+n[4]*e+n[8]*s+n[12])*r,this.y=(n[1]*i+n[5]*e+n[9]*s+n[13])*r,this.z=(n[2]*i+n[6]*e+n[10]*s+n[14])*r,this},applyQuaternion:function(t){var i=this.x,e=this.y,s=this.z,n=t.x,r=t.y,h=t.z,a=t.w,o=a*i+r*s-h*e,u=a*e+h*i-n*s,l=a*s+n*e-r*i,c=-n*i-r*e-h*s;return this.x=o*a+c*-n+u*-h-l*-r,this.y=u*a+c*-r+l*-n-o*-h,this.z=l*a+c*-h+o*-r-u*-n,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var i=this.x,e=this.y,s=this.z,n=t.elements;return this.x=n[0]*i+n[4]*e+n[8]*s,this.y=n[1]*i+n[5]*e+n[9]*s,this.z=n[2]*i+n[6]*e+n[10]*s,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this},clampScalar:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this},clampLength:function(t,i){var e=this.length();return this.divideScalar(e||1).multiplyScalar(Math.max(t,Math.min(i,e)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this},lerpVectors:function(t,i,e){return this.subVectors(i,t).multiplyScalar(e).add(t)},cross:function(t,i){return void 0!==i?this.crossVectors(t,i):this.crossVectors(this,t)},crossVectors:function(t,i){var e=t.x,s=t.y,n=t.z,r=i.x,h=i.y,a=i.z;return this.x=s*a-n*h,this.y=n*r-e*a,this.z=e*h-s*r,this},projectOnVector:function(t){var i=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(i)},projectOnPlane:function(t){return Y.copy(this).projectOnVector(t),this.sub(Y)},reflect:function(t){return this.sub(Y.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var i=Math.sqrt(this.lengthSq()*t.lengthSq()),e=this.dot(t)/i;return Math.acos(W.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,e=this.y-t.y,s=this.z-t.z;return i*i+e*e+s*s},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,i,e){var s=Math.sin(i)*t;return this.x=s*Math.sin(e),this.y=Math.cos(i)*t,this.z=s*Math.cos(e),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,i,e){return this.x=t*Math.sin(i),this.y=e,this.z=t*Math.cos(i),this},setFromMatrixPosition:function(t){var i=t.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this},setFromMatrixScale:function(t){var i=this.setFromMatrixColumn(t,0).length(),e=this.setFromMatrixColumn(t,1).length(),s=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=e,this.z=s,this},setFromMatrixColumn:function(t,i){return this.fromArray(t.elements,4*i)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,i){return void 0===i&&(i=0),this.x=t[i],this.y=t[i+1],this.z=t[i+2],this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t},fromAttribute:function(t,i){return this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this}});var Q=new Z,K=new st,$=new Z(0,0,0),J=new Z(1,1,1),tt=new Z,it=new Z,et=new Z;function st(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}Object.assign(st.prototype,{isMatrix4:!0,set:function(t,i,e,s,n,r,h,a,o,u,l,c,d,p,f,m){var y=this.elements;return y[0]=t,y[4]=i,y[8]=e,y[12]=s,y[1]=n,y[5]=r,y[9]=h,y[13]=a,y[2]=o,y[6]=u,y[10]=l,y[14]=c,y[3]=d,y[7]=p,y[11]=f,y[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new st).fromArray(this.elements)},copy:function(t){var i=this.elements,e=t.elements;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],this},copyPosition:function(t){var i=this.elements,e=t.elements;return i[12]=e[12],i[13]=e[13],i[14]=e[14],this},extractBasis:function(t,i,e){return t.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),e.setFromMatrixColumn(this,2),this},makeBasis:function(t,i,e){return this.set(t.x,i.x,e.x,0,t.y,i.y,e.y,0,t.z,i.z,e.z,0,0,0,0,1),this},extractRotation:function(t){var i=this.elements,e=t.elements,s=1/Q.setFromMatrixColumn(t,0).length(),n=1/Q.setFromMatrixColumn(t,1).length(),r=1/Q.setFromMatrixColumn(t,2).length();return i[0]=e[0]*s,i[1]=e[1]*s,i[2]=e[2]*s,i[3]=0,i[4]=e[4]*n,i[5]=e[5]*n,i[6]=e[6]*n,i[7]=0,i[8]=e[8]*r,i[9]=e[9]*r,i[10]=e[10]*r,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},makeRotationFromEuler:function(t){!t||t.isEuler;var i=this.elements,e=t.x,s=t.y,n=t.z,r=Math.cos(e),h=Math.sin(e),a=Math.cos(s),o=Math.sin(s),u=Math.cos(n),l=Math.sin(n);if('XYZ'===t.order){var c=r*u,d=r*l,p=h*u,f=h*l;i[0]=a*u,i[4]=-a*l,i[8]=o,i[1]=d+p*o,i[5]=c-f*o,i[9]=-h*a,i[2]=f-c*o,i[6]=p+d*o,i[10]=r*a}else if('YXZ'===t.order){var m=a*u,y=a*l,g=o*u,x=o*l;i[0]=m+x*h,i[4]=g*h-y,i[8]=r*o,i[1]=r*l,i[5]=r*u,i[9]=-h,i[2]=y*h-g,i[6]=x+m*h,i[10]=r*a}else if('ZXY'===t.order){m=a*u,y=a*l,g=o*u,x=o*l;i[0]=m-x*h,i[4]=-r*l,i[8]=g+y*h,i[1]=y+g*h,i[5]=r*u,i[9]=x-m*h,i[2]=-r*o,i[6]=h,i[10]=r*a}else if('ZYX'===t.order){c=r*u,d=r*l,p=h*u,f=h*l;i[0]=a*u,i[4]=p*o-d,i[8]=c*o+f,i[1]=a*l,i[5]=f*o+c,i[9]=d*o-p,i[2]=-o,i[6]=h*a,i[10]=r*a}else if('YZX'===t.order){var v=r*a,_=r*o,w=h*a,b=h*o;i[0]=a*u,i[4]=b-v*l,i[8]=w*l+_,i[1]=l,i[5]=r*u,i[9]=-h*u,i[2]=-o*u,i[6]=_*l+w,i[10]=v-b*l}else if('XZY'===t.order){v=r*a,_=r*o,w=h*a,b=h*o;i[0]=a*u,i[4]=-l,i[8]=o*u,i[1]=v*l+b,i[5]=r*u,i[9]=_*l-w,i[2]=w*l-_,i[6]=h*u,i[10]=b*l+v}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose($,t,J)},lookAt:function(t,i,e){var s=this.elements;return et.subVectors(t,i),0===et.lengthSq()&&(et.z=1),et.normalize(),tt.crossVectors(e,et),0===tt.lengthSq()&&(1===Math.abs(e.z)?et.x+=1e-4:et.z+=1e-4,et.normalize(),tt.crossVectors(e,et)),tt.normalize(),it.crossVectors(et,tt),s[0]=tt.x,s[4]=it.x,s[8]=et.x,s[1]=tt.y,s[5]=it.y,s[9]=et.y,s[2]=tt.z,s[6]=it.z,s[10]=et.z,this},multiply:function(t,i){return void 0!==i?this.multiplyMatrices(t,i):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,i){var e=t.elements,s=i.elements,n=this.elements,r=e[0],h=e[4],a=e[8],o=e[12],u=e[1],l=e[5],c=e[9],d=e[13],p=e[2],f=e[6],m=e[10],y=e[14],g=e[3],x=e[7],v=e[11],_=e[15],w=s[0],b=s[4],M=s[8],z=s[12],A=s[1],E=s[5],T=s[9],C=s[13],F=s[2],S=s[6],O=s[10],L=s[14],R=s[3],I=s[7],U=s[11],j=s[15];return n[0]=r*w+h*A+a*F+o*R,n[4]=r*b+h*E+a*S+o*I,n[8]=r*M+h*T+a*O+o*U,n[12]=r*z+h*C+a*L+o*j,n[1]=u*w+l*A+c*F+d*R,n[5]=u*b+l*E+c*S+d*I,n[9]=u*M+l*T+c*O+d*U,n[13]=u*z+l*C+c*L+d*j,n[2]=p*w+f*A+m*F+y*R,n[6]=p*b+f*E+m*S+y*I,n[10]=p*M+f*T+m*O+y*U,n[14]=p*z+f*C+m*L+y*j,n[3]=g*w+x*A+v*F+_*R,n[7]=g*b+x*E+v*S+_*I,n[11]=g*M+x*T+v*O+_*U,n[15]=g*z+x*C+v*L+_*j,this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this},applyToBufferAttribute:function(t){for(var i=0,e=t.count;i<e;i++)Q.x=t.getX(i),Q.y=t.getY(i),Q.z=t.getZ(i),Q.applyMatrix4(this),t.setXYZ(i,Q.x,Q.y,Q.z);return t},determinant:function(){var t=this.elements,i=t[0],e=t[4],s=t[8],n=t[12],r=t[1],h=t[5],a=t[9],o=t[13],u=t[2],l=t[6],c=t[10],d=t[14];return t[3]*(+n*a*l-s*o*l-n*h*c+e*o*c+s*h*d-e*a*d)+t[7]*(+i*a*d-i*o*c+n*r*c-s*r*d+s*o*u-n*a*u)+t[11]*(+i*o*l-i*h*d-n*r*l+e*r*d+n*h*u-e*o*u)+t[15]*(-s*h*u-i*a*l+i*h*c+s*r*l-e*r*c+e*a*u)},transpose:function(){var t,i=this.elements;return t=i[1],i[1]=i[4],i[4]=t,t=i[2],i[2]=i[8],i[8]=t,t=i[6],i[6]=i[9],i[9]=t,t=i[3],i[3]=i[12],i[12]=t,t=i[7],i[7]=i[13],i[13]=t,t=i[11],i[11]=i[14],i[14]=t,this},setPosition:function(t,i,e){var s=this.elements;return t.isVector3?(s[12]=t.x,s[13]=t.y,s[14]=t.z):(s[12]=t,s[13]=i,s[14]=e),this},getInverse:function(t,i){var e=this.elements,s=t.elements,n=s[0],r=s[1],h=s[2],a=s[3],o=s[4],u=s[5],l=s[6],c=s[7],d=s[8],p=s[9],f=s[10],m=s[11],y=s[12],g=s[13],x=s[14],v=s[15],_=p*x*c-g*f*c+g*l*m-u*x*m-p*l*v+u*f*v,w=y*f*c-d*x*c-y*l*m+o*x*m+d*l*v-o*f*v,b=d*g*c-y*p*c+y*u*m-o*g*m-d*u*v+o*p*v,M=y*p*l-d*g*l-y*u*f+o*g*f+d*u*x-o*p*x,z=n*_+r*w+h*b+a*M;if(0===z){if(!0===i)throw new Error("Tiny.Matrix4: .getInverse() can't invert matrix, determinant is 0");return this.identity()}var A=1/z;return e[0]=_*A,e[1]=(g*f*a-p*x*a-g*h*m+r*x*m+p*h*v-r*f*v)*A,e[2]=(u*x*a-g*l*a+g*h*c-r*x*c-u*h*v+r*l*v)*A,e[3]=(p*l*a-u*f*a-p*h*c+r*f*c+u*h*m-r*l*m)*A,e[4]=w*A,e[5]=(d*x*a-y*f*a+y*h*m-n*x*m-d*h*v+n*f*v)*A,e[6]=(y*l*a-o*x*a-y*h*c+n*x*c+o*h*v-n*l*v)*A,e[7]=(o*f*a-d*l*a+d*h*c-n*f*c-o*h*m+n*l*m)*A,e[8]=b*A,e[9]=(y*p*a-d*g*a-y*r*m+n*g*m+d*r*v-n*p*v)*A,e[10]=(o*g*a-y*u*a+y*r*c-n*g*c-o*r*v+n*u*v)*A,e[11]=(d*u*a-o*p*a-d*r*c+n*p*c+o*r*m-n*u*m)*A,e[12]=M*A,e[13]=(d*g*h-y*p*h+y*r*f-n*g*f-d*r*x+n*p*x)*A,e[14]=(y*u*h-o*g*h-y*r*l+n*g*l+o*r*x-n*u*x)*A,e[15]=(o*p*h-d*u*h+d*r*l-n*p*l-o*r*f+n*u*f)*A,this},scale:function(t){var i=this.elements,e=t.x,s=t.y,n=t.z;return i[0]*=e,i[4]*=s,i[8]*=n,i[1]*=e,i[5]*=s,i[9]*=n,i[2]*=e,i[6]*=s,i[10]*=n,i[3]*=e,i[7]*=s,i[11]*=n,this},getMaxScaleOnAxis:function(){var t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],e=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],s=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(i,e,s))},makeTranslation:function(t,i,e){return this.set(1,0,0,t,0,1,0,i,0,0,1,e,0,0,0,1),this},makeRotationX:function(t){var i=Math.cos(t),e=Math.sin(t);return this.set(1,0,0,0,0,i,-e,0,0,e,i,0,0,0,0,1),this},makeRotationY:function(t){var i=Math.cos(t),e=Math.sin(t);return this.set(i,0,e,0,0,1,0,0,-e,0,i,0,0,0,0,1),this},makeRotationZ:function(t){var i=Math.cos(t),e=Math.sin(t);return this.set(i,-e,0,0,e,i,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,i){var e=Math.cos(i),s=Math.sin(i),n=1-e,r=t.x,h=t.y,a=t.z,o=n*r,u=n*h;return this.set(o*r+e,o*h-s*a,o*a+s*h,0,o*h+s*a,u*h+e,u*a-s*r,0,o*a-s*h,u*a+s*r,n*a*a+e,0,0,0,0,1),this},makeScale:function(t,i,e){return this.set(t,0,0,0,0,i,0,0,0,0,e,0,0,0,0,1),this},makeShear:function(t,i,e){return this.set(1,i,e,0,t,1,e,0,t,i,1,0,0,0,0,1),this},compose:function(t,i,e){var s=this.elements,n=i._x,r=i._y,h=i._z,a=i._w,o=n+n,u=r+r,l=h+h,c=n*o,d=n*u,p=n*l,f=r*u,m=r*l,y=h*l,g=a*o,x=a*u,v=a*l,_=e.x,w=e.y,b=e.z;return s[0]=(1-(f+y))*_,s[1]=(d+v)*_,s[2]=(p-x)*_,s[3]=0,s[4]=(d-v)*w,s[5]=(1-(c+y))*w,s[6]=(m+g)*w,s[7]=0,s[8]=(p+x)*b,s[9]=(m-g)*b,s[10]=(1-(c+f))*b,s[11]=0,s[12]=t.x,s[13]=t.y,s[14]=t.z,s[15]=1,this},decompose:function(t,i,e){var s=this.elements,n=Q.set(s[0],s[1],s[2]).length(),r=Q.set(s[4],s[5],s[6]).length(),h=Q.set(s[8],s[9],s[10]).length();this.determinant()<0&&(n=-n),t.x=s[12],t.y=s[13],t.z=s[14],K.copy(this);var a=1/n,o=1/r,u=1/h;return K.elements[0]*=a,K.elements[1]*=a,K.elements[2]*=a,K.elements[4]*=o,K.elements[5]*=o,K.elements[6]*=o,K.elements[8]*=u,K.elements[9]*=u,K.elements[10]*=u,i.setFromRotationMatrix(K),e.x=n,e.y=r,e.z=h,this},makePerspective:function(t,i,e,s,n,r){var h=this.elements,a=2*n/(i-t),o=2*n/(e-s),u=(i+t)/(i-t),l=(e+s)/(e-s),c=-(r+n)/(r-n),d=-2*r*n/(r-n);return h[0]=a,h[4]=0,h[8]=u,h[12]=0,h[1]=0,h[5]=o,h[9]=l,h[13]=0,h[2]=0,h[6]=0,h[10]=c,h[14]=d,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this},makeOrthographic:function(t,i,e,s,n,r){var h=this.elements,a=1/(i-t),o=1/(e-s),u=1/(r-n),l=(i+t)*a,c=(e+s)*o,d=(r+n)*u;return h[0]=2*a,h[4]=0,h[8]=0,h[12]=-l,h[1]=0,h[5]=2*o,h[9]=0,h[13]=-c,h[2]=0,h[6]=0,h[10]=-2*u,h[14]=-d,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this},equals:function(t){for(var i=this.elements,e=t.elements,s=0;s<16;s++)if(i[s]!==e[s])return!1;return!0},fromArray:function(t,i){void 0===i&&(i=0);for(var e=0;e<16;e++)this.elements[e]=t[e+i];return this},toArray:function(t,i){void 0===t&&(t=[]),void 0===i&&(i=0);var e=this.elements;return t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=e[3],t[i+4]=e[4],t[i+5]=e[5],t[i+6]=e[6],t[i+7]=e[7],t[i+8]=e[8],t[i+9]=e[9],t[i+10]=e[10],t[i+11]=e[11],t[i+12]=e[12],t[i+13]=e[13],t[i+14]=e[14],t[i+15]=e[15],t}});var nt=new st,rt=new q;function ht(t,i,e,s){this._x=t||0,this._y=i||0,this._z=e||0,this._order=s||ht.DefaultOrder}ht.RotationOrders=['XYZ','YZX','ZXY','XZY','YXZ','ZYX'],ht.DefaultOrder='XYZ',Object.defineProperties(ht.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(ht.prototype,{isEuler:!0,set:function(t,i,e,s){return this._x=t,this._y=i,this._z=e,this._order=s||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,i,e){var s=a.clamp,n=t.elements,r=n[0],h=n[4],o=n[8],u=n[1],l=n[5],c=n[9],d=n[2],p=n[6],f=n[10];return'XYZ'===(i=i||this._order)?(this._y=Math.asin(s(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-h,r)):(this._x=Math.atan2(p,l),this._z=0)):'YXZ'===i?(this._x=Math.asin(-s(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,f),this._z=Math.atan2(u,l)):(this._y=Math.atan2(-d,r),this._z=0)):'ZXY'===i?(this._x=Math.asin(s(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-d,f),this._z=Math.atan2(-h,l)):(this._y=0,this._z=Math.atan2(u,r))):'ZYX'===i?(this._y=Math.asin(-s(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(p,f),this._z=Math.atan2(u,r)):(this._x=0,this._z=Math.atan2(-h,l))):'YZX'===i?(this._z=Math.asin(s(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-d,r)):(this._x=0,this._y=Math.atan2(o,f))):'XZY'===i&&(this._z=Math.asin(-s(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(p,l),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-c,f),this._y=0)),this._order=i,!1!==e&&this._onChangeCallback(),this},setFromQuaternion:function(t,i,e){return nt.makeRotationFromQuaternion(t),this.setFromRotationMatrix(nt,i,e)},setFromVector3:function(t,i){return this.set(t.x,t.y,t.z,i||this._order)},reorder:function(t){return rt.setFromEuler(this),this.setFromQuaternion(rt,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new Z(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var at=new q,ot=new st,ut=new Z,lt=new Z;function ct(){this.parent=null,this.children=[],this.visible=!0,this.matrix=new st,this.worldMatrix=new st,this.matrixAutoUpdate=!0,this.position=new Z,this.quaternion=new q,this.scale=new Z(1,1,1),this.rotation=new ht,this.up=new Z(0,1,0),this.rotation._onChange((()=>{this.quaternion.setFromEuler(this.rotation,!1)})),this.quaternion._onChange((()=>{this.rotation.setFromQuaternion(this.quaternion,void 0,!1)}))}function dt(t,i,e,s){this.x=t||0,this.y=i||0,this.z=e||0,this.w=void 0!==s?s:1}ct.prototype={constructor:ct,isObject3D:!0,clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,i){if(void 0===i&&(i=!0),this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.worldMatrix.copy(t.worldMatrix),this.matrixAutoUpdate=t.matrixAutoUpdate,!0===i)for(var e=0;e<t.children.length;e++){var s=t.children[e];this.add(s.clone())}return this},getObjectByName:function(t=""){var i=null;return this.traverse((e=>{e.name===t&&(i=e)})),i},add:function(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t)},remove:function(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1)),this},updateTransform:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.worldMatrixNeedsUpdate||t)&&(null===this.parent?this.worldMatrix.copy(this.matrix):this.worldMatrix.multiplyMatrices(this.parent.worldMatrix,this.matrix),this.worldMatrixNeedsUpdate=!1,t=!0);for(var i=0,e=this.children.length;i<e;i++)this.children[i].updateTransform(t)},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.worldMatrixNeedsUpdate=!0},traverse:function(t){if(!t(this))for(var i=0,e=this.children.length;i<e;i++)this.children[i].traverse(t)},decompose:function(){this.matrix.getTranslation(this.position),this.matrix.getRotation(this.quaternion),this.matrix.getScaling(this.scale),this.rotation.fromQuaternion(this.quaternion)},lookAt:function(t,i,e){t.isVector3?ut.copy(t):ut.set(t,i,e);var s=this.parent;this.updateTransform(!0,!1),lt.setFromMatrixPosition(this.worldMatrix),this.isCamera||this.isLight?ot.lookAt(lt,ut,this.up):ot.lookAt(ut,lt,this.up),this.quaternion.setFromRotationMatrix(ot),s&&(ot.extractRotation(s.worldMatrix),at.setFromRotationMatrix(ot),this.quaternion.premultiply(at.inverse()))}},Object.defineProperties(dt.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(dt.prototype,{isVector4:!0,set:function(t,i,e,s){return this.x=t,this.y=i,this.z=e,this.w=s,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error('index is out of range: '+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error('index is out of range: '+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,i){return void 0!==i?this.addVectors(t,i):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this.w=t.w+i.w,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this.w+=t.w*i,this},sub:function(t,i){return void 0!==i?this.subVectors(t,i):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this.w=t.w-i.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var i=this.x,e=this.y,s=this.z,n=this.w,r=t.elements;return this.x=r[0]*i+r[4]*e+r[8]*s+r[12]*n,this.y=r[1]*i+r[5]*e+r[9]*s+r[13]*n,this.z=r[2]*i+r[6]*e+r[10]*s+r[14]*n,this.w=r[3]*i+r[7]*e+r[11]*s+r[15]*n,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var i=Math.sqrt(1-t.w*t.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/i,this.y=t.y/i,this.z=t.z/i),this},setAxisAngleFromRotationMatrix:function(t){var i,e,s,n,r=.01,h=.1,a=t.elements,o=a[0],u=a[4],l=a[8],c=a[1],d=a[5],p=a[9],f=a[2],m=a[6],y=a[10];if(Math.abs(u-c)<r&&Math.abs(l-f)<r&&Math.abs(p-m)<r){if(Math.abs(u+c)<h&&Math.abs(l+f)<h&&Math.abs(p+m)<h&&Math.abs(o+d+y-3)<h)return this.set(1,0,0,0),this;i=Math.PI;var g=(o+1)/2,x=(d+1)/2,v=(y+1)/2,_=(u+c)/4,w=(l+f)/4,b=(p+m)/4;return g>x&&g>v?g<r?(e=0,s=.707106781,n=.707106781):(s=_/(e=Math.sqrt(g)),n=w/e):x>v?x<r?(e=.707106781,s=0,n=.707106781):(e=_/(s=Math.sqrt(x)),n=b/s):v<r?(e=.707106781,s=.707106781,n=0):(e=w/(n=Math.sqrt(v)),s=b/n),this.set(e,s,n,i),this}var M=Math.sqrt((m-p)*(m-p)+(l-f)*(l-f)+(c-u)*(c-u));return Math.abs(M)<.001&&(M=1),this.x=(m-p)/M,this.y=(l-f)/M,this.z=(c-u)/M,this.w=Math.acos((o+d+y-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this.w=Math.max(t.w,Math.min(i.w,this.w)),this},clampScalar:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this.w=Math.max(t,Math.min(i,this.w)),this},clampLength:function(t,i){var e=this.length();return this.divideScalar(e||1).multiplyScalar(Math.max(t,Math.min(i,e)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this.w+=(t.w-this.w)*i,this},lerpVectors:function(t,i,e){return this.subVectors(i,t).multiplyScalar(e).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,i){return void 0===i&&(i=0),this.x=t[i],this.y=t[i+1],this.z=t[i+2],this.w=t[i+3],this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t[i+3]=this.w,t},fromBufferAttribute:function(t,i,e){return this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this.w=t.getW(i),this}});var pt=0;function ft(t,i,{mode:e=WebGLRenderingContext.TRIANGLES,frustumCulled:s=!0,renderOrder:n=0}={}){ct.call(this),this.id=pt++,this.geometry=t,this.material=i,this.mode=e,this.frustumCulled=s,this.renderOrder=n,this.beforeRenderCallbacks=[],this.afterRenderCallbacks=[]}ft.prototype=Object.assign(Object.create(ct.prototype),{constructor:ft,isMesh:!0,clone:function(){return new this.constructor(this.geometry,this.material).copy(this)},copy:function(t){return ct.prototype.copy.call(this,t),this.renderOrder=t.renderOrder,this.frustumCulled=t.frustumCulled,this.mode=t.mode,this},onBeforeRender:function(t){return this.beforeRenderCallbacks.push(t),this},onAfterRender:function(t){return this.afterRenderCallbacks.push(t),this},draw:function({camera:t,directionalLight:i,ambientLight:e}={}){this.material.gl.renderer.state.currentProgram!==this.material.id&&(this.material.isMeshLambertMaterial||this.material.isInstancedMeshLambertMaterial)&&(e&&this.material.uniforms.ambientLight.set(new dt(e.color.r,e.color.g,e.color.b,e.visible?e.intensity:0)),i&&(this.material.uniforms.directionalLight.set(new dt(i.color.r,i.color.g,i.color.b,i.visible?i.intensity:0)),this.material.uniforms.directionalLightDirection.set(i.position))),t.projectMatrixDirty&&this.material.uniforms.projectViewMatrix.set(t.projectionViewMatrix),this.material.uniforms.modelMatrix.set(this.worldMatrix),this.beforeRenderCallbacks.forEach((i=>i&&i({mesh:this,camera:t})));var s=this.material.cullFace&&this.worldMatrix.determinant()<0;this.material.use({flipFaces:s}),this.geometry.draw({mode:this.mode,material:this.material}),this.afterRenderCallbacks.forEach((i=>i&&i({mesh:this,camera:t})))}});function mt(t,i,e){if(e=void 0!==e?e:1,!t.attributes.instanceMatrix){var s=new Float32Array(16*e);t.setAttribute('instanceMatrix',new Tiny.Float32Attribute(s,16)),t.attributes.instanceMatrix.instanced=1}t.isInstanced=!0,t.instancedCount=e,ft.call(this,t,i),this.frustumCulled=!1,this.isInstancedMesh=!0}mt.prototype=Object.assign(Object.create(ft.prototype),{constructor:mt,setMatrixAt:function(t,i){this.geometry.attributes.instanceMatrix.set(i.elements,16*t)},draw:function({camera:t,directionalLight:i,ambientLight:e}={}){this.dynamic&&(this.needsUpdate=!0),ft.prototype.draw.call(this,{camera:t,directionalLight:i,ambientLight:e})}});var yt=function(t,i){ct.call(this),this.color=new o(t),this.intensity=void 0!==i?i:1};(yt.prototype=Object.create(ct.prototype)).constructor=yt;var gt=function(t,i){yt.call(this,t,i),this.isAmbientLight=!0};(gt.prototype=Object.create(yt.prototype)).constructor=gt;var xt=function(t,i){yt.call(this,t,i),this.isDirectionalLight=!0};function vt(){ct.call(this),this.isCamera=!0,this.projectMatrixDirty=!1}(xt.prototype=Object.create(yt.prototype)).constructor=xt,vt.prototype=Object.assign(Object.create(ct.prototype),{constructor:vt,updateProjectionMatrix:function(){this.projectMatrixDirty=!0}});var _t=new st,wt=new Z,bt=new Z;function Mt(t=.1,i=100,e=-1,s=1,n=-1,r=1,h=1){vt.call(this),this.near=t,this.far=i,this.left=e,this.right=s,this.bottom=n,this.top=r,this.zoom=h,this.view=null,this.projectionMatrix=new st,this.viewMatrix=new st,this.projectionViewMatrix=new st,this.updateProjectionMatrix()}function zt(t,i){switch(i.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error('Invalid component type.')}}function At(t,i){switch(i.constructor){case Float32Array:return t;case Uint32Array:return Math.round(4294967295*t);case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int32Array:return Math.round(2147483647*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error('Invalid component type.')}}function Et(t,i){this.x=t||0,this.y=i||0}Mt.prototype=Object.assign(Object.create(vt.prototype),{constructor:Mt,isOrthographicCamera:!0,updateProjectionMatrix:function(){vt.prototype.updateProjectionMatrix.call(this);var t=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),e=(this.right+this.left)/2,s=(this.top+this.bottom)/2,n=e-t,r=e+t,h=s+i,a=s-i;if(null!==this.view&&this.view.enabled){var o=this.zoom/(this.view.width/this.view.fullWidth),u=this.zoom/(this.view.height/this.view.fullHeight),l=(this.right-this.left)/this.view.width,c=(this.top-this.bottom)/this.view.height;r=(n+=l*(this.view.offsetX/o))+l*(this.view.width/o),a=(h-=c*(this.view.offsetY/u))-c*(this.view.height/u)}this.projectionMatrix.makeOrthographic(n,r,h,a,this.near,this.far)},updateTransform:function(){return vt.prototype.updateTransform.call(this),this.viewMatrix.getInverse(this.worldMatrix),this.projectionViewMatrix.multiplyMatrices(this.projectionMatrix,this.viewMatrix),this},project:function(t){return t.applyMatrix4(this.viewMatrix),t.applyMatrix4(this.projectionMatrix),this},unproject:function(t){return t.applyMatrix4(_t.inverse(this.projectionMatrix)),t.applyMatrix4(this.worldMatrix),this},updateFrustum:function(){this.frustum||(this.frustum=[new Z,new Z,new Z,new Z,new Z,new Z]);var t=this.projectionViewMatrix.elements;this.frustum[0].set(t[3]-t[0],t[7]-t[4],t[11]-t[8]).constant=t[15]-t[12],this.frustum[1].set(t[3]+t[0],t[7]+t[4],t[11]+t[8]).constant=t[15]+t[12],this.frustum[2].set(t[3]+t[1],t[7]+t[5],t[11]+t[9]).constant=t[15]+t[13],this.frustum[3].set(t[3]-t[1],t[7]-t[5],t[11]-t[9]).constant=t[15]-t[13],this.frustum[4].set(t[3]-t[2],t[7]-t[6],t[11]-t[10]).constant=t[15]-t[14],this.frustum[5].set(t[3]+t[2],t[7]+t[6],t[11]+t[10]).constant=t[15]+t[14];for(var i=0;i<6;i++){var e=1/this.frustum[i].length();this.frustum[i].multiplyScalar(e),this.frustum[i].constant*=e}},frustumIntersectsMesh:function(t,i=t.worldMatrix){if(!t.geometry.attributes.position)return!0;if(t.geometry.bounds&&t.geometry.bounds.radius!==1/0||t.geometry.computeBoundingSphere(),!t.geometry.bounds)return!0;var e=wt;e.copy(t.geometry.bounds.center),e.applyMatrix4(i);var s=t.geometry.bounds.radius*i.getMaxScaleOnAxis();return this.frustumIntersectsSphere(e,s)},frustumIntersectsSphere:function(t,i){for(var e=bt,s=0;s<6;s++){var n=this.frustum[s];if(e.copy(n).dot(t)+n.constant<-i)return!1}return!0}}),Object.defineProperties(Et.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(Et.prototype,{isVector2:!0,set:function(t,i){return this.x=t,this.y=i,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error('index is out of range: '+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error('index is out of range: '+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,i){return void 0!==i?this.addVectors(t,i):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this},sub:function(t,i){return void 0!==i?this.subVectors(t,i):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var i=this.x,e=this.y,s=t.elements;return this.x=s[0]*i+s[3]*e+s[6],this.y=s[1]*i+s[4]*e+s[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this},clampScalar:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this},clampLength:function(t,i){var e=this.length();return this.divideScalar(e||1).multiplyScalar(Math.max(t,Math.min(i,e)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,e=this.y-t.y;return i*i+e*e},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this},lerpVectors:function(t,i,e){return this.subVectors(i,t).multiplyScalar(e).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,i){return void 0===i&&(i=0),this.x=t[i],this.y=t[i+1],this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t},fromBufferAttribute:function(t,i,e){return this.x=t.getX(i),this.y=t.getY(i),this},rotateAround:function(t,i){var e=Math.cos(i),s=Math.sin(i),n=this.x-t.x,r=this.y-t.y;return this.x=n*e-r*s+t.x,this.y=n*s+r*e+t.y,this}});var Tt=new Uint8Array(4);function Ct(t){return 0==(t&t-1)}var Ft=1;function St(t,{image:i,target:e=t.TEXTURE_2D,type:s=t.UNSIGNED_BYTE,format:n=t.RGBA,internalFormat:r=n,wrapS:h=t.CLAMP_TO_EDGE,wrapT:a=t.CLAMP_TO_EDGE,generateMipmaps:o=!0,minFilter:u=(o?t.NEAREST_MIPMAP_LINEAR:t.LINEAR),magFilter:l=t.LINEAR,premultiplyAlpha:c=!1,unpackAlignment:d=4,flipY:p=e==t.TEXTURE_2D,anisotropy:f=0,level:m=0,width:y,height:g=y}={}){this.gl=t,this.id=Ft++,this.image=i,this.target=e,this.type=s,this.format=n,this.internalFormat=r,this.minFilter=u,this.magFilter=l,this.wrapS=h,this.wrapT=a,this.generateMipmaps=o,this.premultiplyAlpha=c,this.unpackAlignment=d,this.flipY=p,this.anisotropy=Math.min(f,this.gl.renderer.parameters.maxAnisotropy),this.level=m,this.width=y,this.height=g,this.texture=this.gl.createTexture(),this.store={image:null},this.glState=this.gl.renderer.state,this.state={},this.state.minFilter=this.gl.NEAREST_MIPMAP_LINEAR,this.state.magFilter=this.gl.LINEAR,this.state.wrapS=this.gl.REPEAT,this.state.wrapT=this.gl.REPEAT,this.state.anisotropy=0}St.prototype={constructor:St,bind:function(){this.glState.textureUnits[this.glState.activeTextureUnit]!==this.id&&(this.gl.bindTexture(this.target,this.texture),this.glState.textureUnits[this.glState.activeTextureUnit]=this.id)},update:function(t=0){var i=!(this.image===this.store.image&&!this.needsUpdate);if((i||this.glState.textureUnits[t]!==this.id)&&(this.gl.renderer.activeTexture(t),this.bind()),i){if(this.needsUpdate=!1,this.flipY!==this.glState.flipY&&(this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,this.flipY),this.glState.flipY=this.flipY),this.premultiplyAlpha!==this.glState.premultiplyAlpha&&(this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),this.glState.premultiplyAlpha=this.premultiplyAlpha),this.unpackAlignment!==this.glState.unpackAlignment&&(this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,this.unpackAlignment),this.glState.unpackAlignment=this.unpackAlignment),this.minFilter!==this.state.minFilter&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_MIN_FILTER,this.minFilter),this.state.minFilter=this.minFilter),this.magFilter!==this.state.magFilter&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_MAG_FILTER,this.magFilter),this.state.magFilter=this.magFilter),this.wrapS!==this.state.wrapS&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_S,this.wrapS),this.state.wrapS=this.wrapS),this.wrapT!==this.state.wrapT&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_T,this.wrapT),this.state.wrapT=this.wrapT),this.anisotropy&&this.anisotropy!==this.state.anisotropy&&(this.gl.texParameterf(this.target,this.gl.renderer.getExtension('EXT_texture_filter_anisotropic').TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropy),this.state.anisotropy=this.anisotropy),this.image){if(this.image.width&&(this.width=this.image.width,this.height=this.image.height),this.target===this.gl.TEXTURE_CUBE_MAP)for(var e=0;e<6;e++)this.gl.texImage2D(this.gl.TEXTURE_CUBE_MAP_POSITIVE_X+e,this.level,this.internalFormat,this.format,this.type,this.image[e]);else if(ArrayBuffer.isView(this.image))this.gl.texImage2D(this.target,this.level,this.internalFormat,this.width,this.height,0,this.format,this.type,this.image);else if(this.image.isCompressedTexture)for(var s=0;s<this.image.length;s++)this.gl.compressedTexImage2D(this.target,s,this.internalFormat,this.image[s].width,this.image[s].height,0,this.image[s].data);else this.gl.texImage2D(this.target,this.level,this.internalFormat,this.format,this.type,this.image);this.generateMipmaps&&(this.gl.renderer.isWebgl2||Ct(this.image.width)&&Ct(this.image.height)?this.gl.generateMipmap(this.target):(this.generateMipmaps=!1,this.wrapS=this.wrapT=this.gl.CLAMP_TO_EDGE,this.minFilter=this.gl.LINEAR)),this.onUpdate&&this.onUpdate()}else if(this.target===this.gl.TEXTURE_CUBE_MAP)for(e=0;e<6;e++)this.gl.texImage2D(this.gl.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,Tt);else this.width?this.gl.texImage2D(this.target,this.level,this.internalFormat,this.width,this.height,0,this.format,this.type,null):this.gl.texImage2D(this.target,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,Tt);this.store.image=this.image}}};var Ot=new Z,Lt=1;function Rt({canvas:t=document.createElement('canvas'),width:i=300,height:e=150,dpr:s=1,alpha:n=!1,depth:r=!0,stencil:h=!0,antialias:a=!1,premultipliedAlpha:o=!1,preserveDrawingBuffer:u=!0,powerPreference:l="default",autoClear:c=!0,webgl:d=2}={}){var p={alpha:n,depth:r,stencil:h,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:u,powerPreference:l};this.dpr=s,this.alpha=n,this.color=!0,this.depth=r,this.stencil=h,this.premultipliedAlpha=o,this.autoClear=c,this.id=Lt++,this.domElement=t,2===d&&(this.gl=t.getContext('webgl2',p)),this.isWebgl2=!!this.gl,this.gl||(this.gl=t.getContext('webgl',p)),this.gl,this.gl.renderer=this,this.resize(i,e),this.state={},this.state.blendFunc={src:this.gl.ONE,dst:this.gl.ZERO},this.state.blendEquation={modeRGB:this.gl.FUNC_ADD},this.state.cullFace=null,this.state.frontFace=this.gl.CCW,this.state.depthMask=!0,this.state.depthFunc=this.gl.LESS,this.state.premultiplyAlpha=!1,this.state.flipY=!1,this.state.unpackAlignment=4,this.state.framebuffer=null,this.state.viewport={x:0,y:0,width:null,height:null},this.state.textureUnits=[],this.state.activeTextureUnit=0,this.state.boundBuffer=null,this.state.uniformLocations=new Map,this.state.currentProgram=null,this.extensions={},this.isWebgl2?(this.getExtension('EXT_color_buffer_float'),this.getExtension('OES_texture_float_linear')):(this.getExtension('OES_texture_float'),this.getExtension('OES_texture_float_linear'),this.getExtension('OES_texture_half_float'),this.getExtension('OES_texture_half_float_linear'),this.getExtension('OES_element_index_uint'),this.getExtension('OES_standard_derivatives'),this.getExtension('EXT_sRGB'),this.getExtension('WEBGL_depth_texture'),this.getExtension('WEBGL_draw_buffers')),this.getExtension('WEBGL_compressed_texture_astc'),this.getExtension('EXT_texture_compression_bptc'),this.getExtension('WEBGL_compressed_texture_s3tc'),this.getExtension('WEBGL_compressed_texture_etc1'),this.getExtension('WEBGL_compressed_texture_pvrtc'),this.getExtension('WEBKIT_WEBGL_compressed_texture_pvrtc'),this.vertexAttribDivisor=this.getExtension('ANGLE_instanced_arrays','vertexAttribDivisor','vertexAttribDivisorANGLE'),this.drawArraysInstanced=this.getExtension('ANGLE_instanced_arrays','drawArraysInstanced','drawArraysInstancedANGLE'),this.drawElementsInstanced=this.getExtension('ANGLE_instanced_arrays','drawElementsInstanced','drawElementsInstancedANGLE'),this.createVertexArray=this.getExtension('OES_vertex_array_object','createVertexArray','createVertexArrayOES'),this.bindVertexArray=this.getExtension('OES_vertex_array_object','bindVertexArray','bindVertexArrayOES'),this.deleteVertexArray=this.getExtension('OES_vertex_array_object','deleteVertexArray','deleteVertexArrayOES'),this.drawBuffers=this.getExtension('WEBGL_draw_buffers','drawBuffers','drawBuffersWEBGL'),this.parameters={},this.parameters.maxTextureUnits=this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.parameters.maxAnisotropy=this.getExtension('EXT_texture_filter_anisotropic')?this.gl.getParameter(this.getExtension('EXT_texture_filter_anisotropic').MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,St.WHITE=new St(this.gl,{image:new Uint8Array([255,255,255,255]),width:1,height:1})}Rt.prototype={constructor:Rt,setClearColor:function(t,i){this.gl.clearColor(t.r,t.g,t.b,i)},setPixelRatio:function(t){this.dpr=t,this.resize(this.width,this.height)},resize:function(t,i){this.width=t,this.height=i,this.gl.canvas.width=t*this.dpr,this.gl.canvas.height=i*this.dpr,this.gl.canvas.style&&Object.assign(this.gl.canvas.style,{width:t+'px',height:i+'px'})},setViewport:function(t,i,e=0,s=0){this.state.viewport.width===t&&this.state.viewport.height===i||(this.state.viewport.width=t,this.state.viewport.height=i,this.state.viewport.x=e,this.state.viewport.y=s,this.gl.viewport(e,s,t,i))},setScissor:function(t,i,e=0,s=0){this.gl.scissor(e,s,t,i)},enable:function(t){!0!==this.state[t]&&(this.gl.enable(t),this.state[t]=!0)},disable:function(t){!1!==this.state[t]&&(this.gl.disable(t),this.state[t]=!1)},setBlendFunc:function(t,i,e,s){this.state.blendFunc.src===t&&this.state.blendFunc.dst===i&&this.state.blendFunc.srcAlpha===e&&this.state.blendFunc.dstAlpha===s||(this.state.blendFunc.src=t,this.state.blendFunc.dst=i,this.state.blendFunc.srcAlpha=e,this.state.blendFunc.dstAlpha=s,void 0!==e?this.gl.blendFuncSeparate(t,i,e,s):this.gl.blendFunc(t,i))},setBlendEquation:function(t,i){t=t||this.gl.FUNC_ADD,this.state.blendEquation.modeRGB===t&&this.state.blendEquation.modeAlpha===i||(this.state.blendEquation.modeRGB=t,this.state.blendEquation.modeAlpha=i,void 0!==i?this.gl.blendEquationSeparate(t,i):this.gl.blendEquation(t))},setCullFace:function(t){this.state.cullFace!==t&&(this.state.cullFace=t,this.gl.cullFace(t))},setFrontFace:function(t){this.state.frontFace!==t&&(this.state.frontFace=t,this.gl.frontFace(t))},setDepthMask:function(t){this.state.depthMask!==t&&(this.state.depthMask=t,this.gl.depthMask(t))},setDepthFunc:function(t){this.state.depthFunc!==t&&(this.state.depthFunc=t,this.gl.depthFunc(t))},activeTexture:function(t){this.state.activeTextureUnit!==t&&(this.state.activeTextureUnit=t,this.gl.activeTexture(this.gl.TEXTURE0+t))},bindFramebuffer:function({target:t=this.gl.FRAMEBUFFER,buffer:i=null}={}){this.state.framebuffer!==i&&(this.state.framebuffer=i,this.gl.bindFramebuffer(t,i))},getExtension:function(t,i,e){return i&&this.gl[i]?this.gl[i].bind(this.gl):(this.extensions[t]||(this.extensions[t]=this.gl.getExtension(t)),i?this.extensions[t]?this.extensions[t][e].bind(this.extensions[t]):null:this.extensions[t])},sortOpaque:function(t,i){return t.renderOrder!==i.renderOrder?t.renderOrder-i.renderOrder:t.material.id!==i.material.id?t.material.id-i.material.id:t.zDepth!==i.zDepth?t.zDepth-i.zDepth:i.id-t.id},sortTransparent:function(t,i){return t.renderOrder!==i.renderOrder?t.renderOrder-i.renderOrder:t.zDepth!==i.zDepth?i.zDepth-t.zDepth:i.id-t.id},sortUI:function(t,i){return t.renderOrder!==i.renderOrder?t.renderOrder-i.renderOrder:t.material.id!==i.material.id?t.material.id-i.material.id:i.id-t.id},getRenderList:function({scene:t,camera:i,frustumCull:e,sort:s}){var n=[];if(i&&e&&i.updateFrustum(),t.traverse((t=>{if(!t.visible)return!0;t.draw&&(e&&t.frustumCulled&&i&&!i.frustumIntersectsMesh(t)||n.push(t))})),s){for(var r=[],h=[],a=[],o=0;o<n.length;o++){var u=n[o];u.material.transparent?u.material.depthTest?h.push(u):a.push(u):r.push(u),u.zDepth=0,0===u.renderOrder&&u.material.depthTest&&i&&(Ot.set(u.worldMatrix.elements[12],u.worldMatrix.elements[13],u.worldMatrix.elements[14]),Ot.applyMatrix4(i.projectionViewMatrix),u.zDepth=Ot.z)}h.sort(this.sortTransparent),n=r.concat(h,a)}return n},render:function({scene:t,camera:i,directionalLight:e,ambientLight:s,target:n=null,update:r=!0,sort:h=!0,frustumCull:a=!1,clear:o}){null===n?(this.bindFramebuffer(),this.setViewport(this.width*this.dpr,this.height*this.dpr)):(this.bindFramebuffer(n),this.setViewport(n.width,n.height)),(o||this.autoClear&&!1!==o)&&(!this.depth||n&&!n.depth||(this.enable(this.gl.DEPTH_TEST),this.setDepthMask(!0)),this.gl.clear((this.color?this.gl.COLOR_BUFFER_BIT:0)|(this.depth?this.gl.DEPTH_BUFFER_BIT:0)|(this.stencil?this.gl.STENCIL_BUFFER_BIT:0))),r&&t.updateTransform(),i&&i.updateTransform();for(var u=this.getRenderList({scene:t,camera:i,frustumCull:a,sort:h}),l=0;l<u.length;l++){var c=u[l];c.geometry.gl||c.geometry.initialize(this.gl),c.material.gl||c.material.initialize(this.gl),c.draw({camera:i,directionalLight:e,ambientLight:s})}i.projectMatrixDirty=!1}};const It=35044,Ut=new Z,jt=new Et;function kt(t,i=1,e=!1){this.isAttribute=!0,this.array=t,this.itemSize=i,this.count=void 0!==t?t.length/i:0,this.normalized=e,this.usage=It,this.updateRange={offset:0,count:-1},this.offset=0,this.stride=0,this.instanced=0,this.needsUpdate=!0}function Pt(t,i,e){kt.call(this,new Int8Array(t),i,e)}function Vt(t,i,e){kt.call(this,new Uint8Array(t),i,e)}function Dt(t,i,e){kt.call(this,new Uint8ClampedArray(t),i,e)}function Bt(t,i,e){kt.call(this,new Int16Array(t),i,e)}function Nt(t,i,e){kt.call(this,new Uint16Array(t),i,e)}function Xt(t,i,e){kt.call(this,new Int32Array(t),i,e)}function Gt(t,i,e){kt.call(this,new Uint32Array(t),i,e)}function Wt(t,i,e){kt.call(this,new Uint16Array(t),i,e)}function qt(t,i,e){kt.call(this,new Float32Array(t),i,e)}function Yt(t,i,e){kt.call(this,new Float64Array(t),i,e)}kt.prototype={constructor:kt,copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},applyMatrix3(t){if(2===this.itemSize)for(let i=0,e=this.count;i<e;i++)jt.fromAttribute(this,i),jt.applyMatrix3(t),this.setXY(i,jt.x,jt.y);else if(3===this.itemSize)for(let i=0,e=this.count;i<e;i++)Ut.fromAttribute(this,i),Ut.applyMatrix3(t),this.setXYZ(i,Ut.x,Ut.y,Ut.z);return this},applyMatrix4(t){for(let i=0,e=this.count;i<e;i++)Ut.fromAttribute(this,i),Ut.applyMatrix4(t),this.setXYZ(i,Ut.x,Ut.y,Ut.z);return this},applyNormalMatrix(t){for(let i=0,e=this.count;i<e;i++)Ut.fromAttribute(this,i),Ut.applyNormalMatrix(t),this.setXYZ(i,Ut.x,Ut.y,Ut.z);return this},transformDirection(t){for(let i=0,e=this.count;i<e;i++)Ut.fromAttribute(this,i),Ut.transformDirection(t),this.setXYZ(i,Ut.x,Ut.y,Ut.z);return this},set(t,i=0){return this.array.set(t,i),this.needsUpdate=!0,this},getX(t){let i=this.array[t*this.itemSize];return this.normalized&&(i=zt(i,this.array)),i},setX(t,i){return this.normalized&&(i=At(i,this.array)),this.array[t*this.itemSize]=i,this},getY(t){let i=this.array[t*this.itemSize+1];return this.normalized&&(i=zt(i,this.array)),i},setY(t,i){return this.normalized&&(i=At(i,this.array)),this.array[t*this.itemSize+1]=i,this},getZ(t){let i=this.array[t*this.itemSize+2];return this.normalized&&(i=zt(i,this.array)),i},setZ(t,i){return this.normalized&&(i=At(i,this.array)),this.array[t*this.itemSize+2]=i,this},getW(t){let i=this.array[t*this.itemSize+3];return this.normalized&&(i=zt(i,this.array)),i},setW(t,i){return this.normalized&&(i=At(i,this.array)),this.array[t*this.itemSize+3]=i,this},setXY(t,i,e){return t*=this.itemSize,this.normalized&&(i=At(i,this.array),e=At(e,this.array)),this.array[t+0]=i,this.array[t+1]=e,this},setXYZ(t,i,e,s){return t*=this.itemSize,this.normalized&&(i=At(i,this.array),e=At(e,this.array),s=At(s,this.array)),this.array[t+0]=i,this.array[t+1]=e,this.array[t+2]=s,this},setXYZW(t,i,e,s,n){return t*=this.itemSize,this.normalized&&(i=At(i,this.array),e=At(e,this.array),s=At(s,this.array),n=At(n,this.array)),this.array[t+0]=i,this.array[t+1]=e,this.array[t+2]=s,this.array[t+3]=n,this},clone(){return new this.constructor(this.array,this.itemSize).copy(this)}},Pt.prototype=Object.assign(Object.create(kt.prototype),{constructor:Pt}),Vt.prototype=Object.assign(Object.create(kt.prototype),{constructor:Vt}),Dt.prototype=Object.assign(Object.create(kt.prototype),{constructor:Dt}),Bt.prototype=Object.assign(Object.create(kt.prototype),{constructor:Bt}),Nt.prototype=Object.assign(Object.create(kt.prototype),{constructor:Nt}),Xt.prototype=Object.assign(Object.create(kt.prototype),{constructor:Xt}),Gt.prototype=Object.assign(Object.create(kt.prototype),{constructor:Gt}),Wt.prototype=Object.assign(Object.create(kt.prototype),{constructor:Wt}),qt.prototype=Object.assign(Object.create(kt.prototype),{constructor:qt}),Yt.prototype=Object.assign(Object.create(kt.prototype),{constructor:Yt});var Ht=1;function Zt({vertex:t,fragment:i,uniforms:e={},transparent:s=!1,cullFace:n=WebGLRenderingContext.BACK,frontFace:r=WebGLRenderingContext.CCW,depthTest:h=!0,depthWrite:a=!0,depthFunc:o=WebGLRenderingContext.LESS}={}){this.id=Ht++,this.uniforms=e,this.vertex=t,this.fragment=i,this.transparent=s,this.cullFace=n,this.frontFace=r,this.depthTest=h,this.depthWrite=a,this.depthFunc=o,this.blendFunc={},this.blendEquation={}}Zt.prototype={constructor:Zt,initialize:function(t){var{vertex:i,fragment:e,uniforms:s}=this;this.gl=t,this.transparent&&!this.blendFunc.src&&(this.gl.renderer.premultipliedAlpha?this.setBlendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA):this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA));var n=t.createShader(t.VERTEX_SHADER);t.shaderSource(n,i),t.compileShader(n),t.getShaderInfoLog(n);var r=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(r,e),t.compileShader(r),t.getShaderInfoLog(r),this.program=t.createProgram(),t.attachShader(this.program,n),t.attachShader(this.program,r),t.linkProgram(this.program),t.getProgramParameter(this.program,t.LINK_STATUS)){t.deleteShader(n),t.deleteShader(r),this.uniformLocations=new Map;for(var h=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS),a=0;a<h;a++){var o=t.getActiveUniform(this.program,a),u=t.getUniformLocation(this.program,o.name);this.uniformLocations.set(o,u);var l=o.name.match(/(\w+)/g);o.uniformName=l[0],o.nameComponents=l.slice(1),s[o.name]&&(s[o.name].location=u)}this.attributeLocations=new Map;for(var c=[],d=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES),p=0;p<d;p++){var f=t.getActiveAttrib(this.program,p);-1!==(u=t.getAttribLocation(this.program,f.name))&&(c[u]=f.name,this.attributeLocations.set(f,u))}this.attributeOrder=c.join('')}},setBlendFunc:function(t,i,e,s){this.blendFunc.src=t,this.blendFunc.dst=i,this.blendFunc.srcAlpha=e,this.blendFunc.dstAlpha=s,t&&(this.transparent=!0)},setBlendEquation:function(t,i){this.blendEquation.modeRGB=t,this.blendEquation.modeAlpha=i},applyState:function(){this.depthTest?this.gl.renderer.enable(this.gl.DEPTH_TEST):this.gl.renderer.disable(this.gl.DEPTH_TEST),this.cullFace?this.gl.renderer.enable(this.gl.CULL_FACE):this.gl.renderer.disable(this.gl.CULL_FACE),this.blendFunc.src?this.gl.renderer.enable(this.gl.BLEND):this.gl.renderer.disable(this.gl.BLEND),this.cullFace&&this.gl.renderer.setCullFace(this.cullFace),this.gl.renderer.setFrontFace(this.frontFace),this.gl.renderer.setDepthMask(this.depthWrite),this.gl.renderer.setDepthFunc(this.depthFunc),this.blendFunc.src&&this.gl.renderer.setBlendFunc(this.blendFunc.src,this.blendFunc.dst,this.blendFunc.srcAlpha,this.blendFunc.dstAlpha),this.gl.renderer.setBlendEquation(this.blendEquation.modeRGB,this.blendEquation.modeAlpha)},use:function({flipFaces:t=!1}={}){var i=-1;this.gl.renderer.state.currentProgram===this.id||(this.gl.useProgram(this.program),this.gl.renderer.state.currentProgram=this.id),this.uniformLocations.forEach(((t,e)=>{var s=this.uniforms[e.uniformName];for(var n of e.nameComponents){if(!s)break;if(!(n in s)){if(Array.isArray(s.value))break;s=void 0;break}s=s[n]}return s?s&&void 0===s.value?Kt(`${e.name} uniform is missing a value parameter`):(s.isTextureUniform&&this.gl.renderer.state.currentTexture!==s.value&&(this.gl.renderer.state.currentTexture=s.value,i+=1,s.value.update(i),s.apply(this.gl,i)),void(s.dirty&&s.apply(this.gl))):Kt(`Active uniform ${e.name} has not been supplied`)})),this.applyState(),t&&this.gl.renderer.setFrontFace(this.frontFace===this.gl.CCW?this.gl.CW:this.gl.CCW)},remove:function(){this.gl.deleteProgram(this.program)}};var Qt=0;function Kt(t){Qt>100||Qt++}function $t({value:t,boundary:i,itemSize:e}){this.boundary=i,this.itemSize=e,this.location=null,this.glValue=1===e?0:new Float32Array(this.itemSize),this.dirty=!1,t&&this.set(t)}function Jt(t){$t.call(this,{value:t,boundary:0,itemSize:1})}function ti(t){$t.call(this,{value:t,boundary:0,itemSize:1})}function ii(t){$t.call(this,{value:t,boundary:8,itemSize:2})}function ei(t){$t.call(this,{value:t,boundary:12,itemSize:3})}function si(t){$t.call(this,{value:t,boundary:16,itemSize:4})}function ni(t){$t.call(this,{value:t,boundary:16,itemSize:3})}function ri(t){$t.call(this,{value:t,boundary:48,itemSize:12})}function hi(t){$t.call(this,{value:t,boundary:64,itemSize:16})}$t.prototype={constructor:$t,set(t){this.value=t,this.dirty=!0},apply(t){}},Jt.prototype=Object.assign(Object.create($t),{constructor:Jt,set:function(t){$t.prototype.set.call(this,t),this.glValue=t},apply:function(t){t.uniform1f(this.location,this.glValue),this.dirty=!1}}),ti.prototype=Object.assign($t.prototype,{constructor:ti,isTextureUniform:!0,apply:function(t,i){t.uniform1i(this.location,i),this.dirty=!1}}),ii.prototype=Object.assign(Object.create($t),{constructor:ii,set:function(t){$t.prototype.set.call(this).call(this,t),this.glValue[0]=t.x,this.glValue[1]=t.y},apply:function(t){t.uniform2fv(this.location,this.glValue),this.dirty=!1}}),ei.prototype=Object.assign(Object.create($t),{constructor:ei,set:function(t){$t.prototype.set.call(this,t),this.glValue[0]=t.x,this.glValue[1]=t.y,this.glValue[2]=t.z},apply:function(t){t.uniform3fv(this.location,this.glValue),this.dirty=!1}}),si.prototype=Object.assign(Object.create($t),{constructor:si,set:function(t){$t.prototype.set.call(this,t),this.glValue[0]=t.x,this.glValue[1]=t.y,this.glValue[2]=t.z,this.glValue[3]=t.w},apply:function(t){t.uniform4fv(this.location,this.glValue),this.dirty=!1}}),ni.prototype=Object.assign(Object.create($t),{constructor:ni,set:function(t){$t.prototype.set.call(this,t),this.glValue[0]=t.r,this.glValue[1]=t.g,this.glValue[2]=t.b},apply:function(t){t.uniform3fv(this.location,this.glValue),this.dirty=!1}}),ri.prototype=Object.assign(Object.create($t),{constructor:ri,set:function(t){$t.prototype.set.call(this,t),this.glValue.set(t.elements)},apply:function(t){t.uniformMatrix3fv(this.location,!1,this.glValue),this.dirty=!1}}),hi.prototype=Object.assign(Object.create($t),{constructor:hi,set:function(t){$t.prototype.set.call(this,t),this.glValue.set(t.elements)},apply:function(t){t.uniformMatrix4fv(this.location,!1,this.glValue),this.dirty=!1}});function ai({map:t=St.WHITE,color:i=o.WHITE,opacity:e=1,transparent:s=!1,cullFace:n=WebGLRenderingContext.BACK,frontFace:r=WebGLRenderingContext.CCW,depthTest:h=!0,depthWrite:a=!0,depthFunc:u=WebGLRenderingContext.LESS}={}){Zt.call(this,{vertex:"\n    attribute vec3 position;\n    attribute float size;\n\n    uniform mat4 projectViewMatrix;\n    uniform mat4 modelMatrix;\n\n    void main() {\n        gl_Position = projectViewMatrix * modelMatrix * vec4(position, 1.0);\n        gl_PointSize = size;\n    }\n",fragment:"\n    precision highp float;\n\n    uniform sampler2D uMap;\n    uniform vec3 uColor;\n    uniform float uOpacity;\n    \n    void main() {\n      vec4 tex = texture2D(uMap, gl_PointCoord);\n        \n      gl_FragColor = tex * vec4(uColor, uOpacity);\n    }\n",uniforms:{uMap:new ti(t),uColor:new ni(i),uOpacity:new Jt(e),modelMatrix:new hi,projectViewMatrix:new hi},transparent:s,cullFace:n,frontFace:r,depthTest:h,depthWrite:a,depthFunc:u})}ai.prototype=Object.create(Zt.prototype),ai.prototype.constructor=ai;function oi({map:t=St.WHITE,color:i=o.WHITE,opacity:e=1,transparent:s=!1,cullFace:n=WebGLRenderingContext.BACK,frontFace:r=WebGLRenderingContext.CCW,depthTest:h=!0,depthWrite:a=!0,depthFunc:u=WebGLRenderingContext.LESS}={}){Zt.call(this,{vertex:"\n    attribute vec2 uv;\n    attribute vec3 position;\n\n    uniform mat4 projectViewMatrix;\n    uniform mat4 modelMatrix;\n\n    varying vec2 vUv;\n\n    void main() {\n        vUv = uv;\n        \n        gl_Position = projectViewMatrix * modelMatrix * vec4(position, 1.0);\n    }\n",fragment:"\n    precision highp float;\n\n    uniform sampler2D uMap;\n    uniform vec3 uColor;\n    uniform float uOpacity;\n\n    varying vec2 vUv;\n\n    void main() {\n        vec4 tex = texture2D(uMap, vUv);\n        \n        gl_FragColor = tex * vec4(uColor, uOpacity);\n    }\n",uniforms:{uMap:new ti(t),uColor:new ni(i),uOpacity:new Jt(e),modelMatrix:new hi,projectViewMatrix:new hi},transparent:s,cullFace:n,frontFace:r,depthTest:h,depthWrite:a,depthFunc:u})}oi.prototype=Object.create(Zt.prototype),oi.prototype.constructor=oi;function ui({map:t=St.WHITE,color:i=o.WHITE,opacity:e=1,transparent:s=!1,cullFace:n=WebGLRenderingContext.BACK,frontFace:r=WebGLRenderingContext.CCW,depthTest:h=!0,depthWrite:a=!0,depthFunc:u=WebGLRenderingContext.LESS}={}){Zt.call(this,{vertex:"\n    attribute vec2 uv;\n    attribute vec3 position;\n    attribute vec3 normal;\n    \n    uniform mat4 projectViewMatrix;\n    uniform mat4 modelMatrix;\n\n    varying vec2 vUv;\n    varying vec3 vNormal;\n\n    void main() {\n        vUv = uv;\n        vNormal = mat3(modelMatrix) * normal;\n        \n        gl_Position = projectViewMatrix * modelMatrix * vec4(position, 1.0);\n    }\n",fragment:"\n    precision highp float;\n    \n    uniform vec4 ambientLight;\n    \n    uniform vec4 directionalLight;\n    uniform vec3 directionalLightDirection;\n\n    uniform sampler2D uMap;\n    uniform vec3 uColor;\n    uniform float uOpacity;\n\n    varying vec2 vUv;\n    varying vec3 vNormal;\n\n    void main() {\n        vec3 normal = normalize(vNormal);\n        vec4 tex = texture2D(uMap, vUv);\n        \n        float directional = max(dot(normal, normalize(directionalLightDirection)), 0.0);\n        \n        vec3 directLightColor = directionalLight.rgb * directionalLight.a * directional;\n        \n        vec3 ambLightColor = ambientLight.rgb * ambientLight.a;\n        \n        gl_FragColor.rgb = tex.rgb * (ambLightColor + directLightColor) * uColor;\n        gl_FragColor.a = tex.a * uOpacity;\n    }\n",uniforms:{uColor:new ni(i),uMap:new ti(t),uOpacity:new Jt(e),modelMatrix:new hi,projectViewMatrix:new hi,directionalLight:new si,directionalLightDirection:new ei,ambientLight:new si},transparent:s,cullFace:n,frontFace:r,depthTest:h,depthWrite:a,depthFunc:u}),this.isMeshLambertMaterial=!0}ui.prototype=Object.create(Zt.prototype),ui.prototype.constructor=ui;function li({map:t=St.WHITE,color:i=o.WHITE,opacity:e=1,transparent:s=!1,cullFace:n=WebGLRenderingContext.BACK,frontFace:r=WebGLRenderingContext.CCW,depthTest:h=!0,depthWrite:a=!0,depthFunc:u=WebGLRenderingContext.LESS}={}){Zt.call(this,{vertex:"\n    attribute vec2 uv;\n    attribute vec3 position;\n    \n    attribute mat4 instanceMatrix;\n\n    uniform mat4 projectViewMatrix;\n    uniform mat4 modelMatrix;\n\n    varying vec2 vUv;\n\n    void main() {\n        vUv = uv;\n        \n        gl_Position = projectViewMatrix * instanceMatrix * modelMatrix * vec4(position, 1.0);\n    }\n",fragment:"\n    precision highp float;\n\n    uniform sampler2D uMap;\n    uniform vec3 uColor;\n    uniform float uOpacity;\n\n    varying vec2 vUv;\n\n    void main() {\n        vec4 tex = texture2D(uMap, vUv);\n        \n        gl_FragColor = tex * vec4(uColor, uOpacity);\n    }\n",uniforms:{uMap:new ti(t),uColor:new ni(i),uOpacity:new Jt(e),modelMatrix:new hi,projectViewMatrix:new hi},transparent:s,cullFace:n,frontFace:r,depthTest:h,depthWrite:a,depthFunc:u}),this.InstancedMeshBasicMaterial=!0}li.prototype=Object.create(Zt.prototype),li.prototype.constructor=li;function ci({map:t=St.WHITE,color:i=o.WHITE,opacity:e=1,transparent:s=!1,cullFace:n=WebGLRenderingContext.BACK,frontFace:r=WebGLRenderingContext.CCW,depthTest:h=!0,depthWrite:a=!0,depthFunc:u=WebGLRenderingContext.LESS}={}){Zt.call(this,{vertex:"\n    attribute vec2 uv;\n    attribute vec3 position;\n    attribute vec3 normal;\n    \n    attribute mat4 instanceMatrix;\n    \n    uniform mat4 projectViewMatrix;\n    uniform mat4 modelMatrix;\n    \n    varying vec2 vUv;\n    varying vec3 vNormal;\n    \n    void main() {\n        vUv = uv;\n    \n        mat4 modelInstancedMatrix = modelMatrix * instanceMatrix;\n    \n        vNormal = mat3(modelInstancedMatrix) * normal;\n    \n        gl_Position = projectViewMatrix * modelInstancedMatrix * vec4(position, 1.0);\n    }\n",fragment:"\n    precision highp float;\n    \n    uniform vec4 ambientLight;\n    \n    uniform vec4 directionalLight;\n    uniform vec3 directionalLightDirection;\n\n    uniform sampler2D uMap;\n    uniform vec3 uColor;\n    uniform float uOpacity;\n\n    varying vec2 vUv;\n    varying vec3 vNormal;\n\n    void main() {\n        vec3 normal = normalize(vNormal);\n        vec4 tex = texture2D(uMap, vUv);\n        \n        float directional = max(dot(normal, normalize(directionalLightDirection)), 0.0);\n        \n        vec3 directLightColor = directionalLight.rgb * directionalLight.a * directional;\n        \n        vec3 ambLightColor = ambientLight.rgb * ambientLight.a;\n        \n        gl_FragColor.rgb = tex.rgb * (ambLightColor + directLightColor) * uColor;\n        gl_FragColor.a = tex.a * uOpacity;\n    }\n",uniforms:{uColor:new ni(i),uMap:new ti(t),uOpacity:new Jt(e),modelMatrix:new hi,projectViewMatrix:new hi,directionalLight:new si,directionalLightDirection:new ei,ambientLight:new si},transparent:s,cullFace:n,frontFace:r,depthTest:h,depthWrite:a,depthFunc:u}),this.isInstancedMeshLambertMaterial=!0}ci.prototype=Object.create(Zt.prototype),ci.prototype.constructor=ci;var di=new Z;function pi(){this.elements=[1,0,0,0,1,0,0,0,1]}Object.assign(pi.prototype,{isMatrix3:!0,set:function(t,i,e,s,n,r,h,a,o){var u=this.elements;return u[0]=t,u[1]=s,u[2]=h,u[3]=i,u[4]=n,u[5]=a,u[6]=e,u[7]=r,u[8]=o,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var i=this.elements,e=t.elements;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],this},setFromMatrix4:function(t){var i=t.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this},applyToBufferAttribute:function(t){for(var i=0,e=t.count;i<e;i++)di.x=t.getX(i),di.y=t.getY(i),di.z=t.getZ(i),di.applyMatrix3(this),t.setXYZ(i,di.x,di.y,di.z);return t},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,i){var e=t.elements,s=i.elements,n=this.elements,r=e[0],h=e[3],a=e[6],o=e[1],u=e[4],l=e[7],c=e[2],d=e[5],p=e[8],f=s[0],m=s[3],y=s[6],g=s[1],x=s[4],v=s[7],_=s[2],w=s[5],b=s[8];return n[0]=r*f+h*g+a*_,n[3]=r*m+h*x+a*w,n[6]=r*y+h*v+a*b,n[1]=o*f+u*g+l*_,n[4]=o*m+u*x+l*w,n[7]=o*y+u*v+l*b,n[2]=c*f+d*g+p*_,n[5]=c*m+d*x+p*w,n[8]=c*y+d*v+p*b,this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=t,i[4]*=t,i[7]*=t,i[2]*=t,i[5]*=t,i[8]*=t,this},determinant:function(){var t=this.elements,i=t[0],e=t[1],s=t[2],n=t[3],r=t[4],h=t[5],a=t[6],o=t[7],u=t[8];return i*r*u-i*h*o-e*n*u+e*h*a+s*n*o-s*r*a},getInverse:function(t,i){t&&t.isMatrix4;var e=t.elements,s=this.elements,n=e[0],r=e[1],h=e[2],a=e[3],o=e[4],u=e[5],l=e[6],c=e[7],d=e[8],p=d*o-u*c,f=u*l-d*a,m=c*a-o*l,y=n*p+r*f+h*m;if(0===y){if(!0===i)throw new Error("Tiny.Matrix3: .getInverse() can't invert matrix, determinant is 0");return this.identity()}var g=1/y;return s[0]=p*g,s[1]=(h*c-d*r)*g,s[2]=(u*r-h*o)*g,s[3]=f*g,s[4]=(d*n-h*l)*g,s[5]=(h*a-u*n)*g,s[6]=m*g,s[7]=(r*l-c*n)*g,s[8]=(o*n-r*a)*g,this},transpose:function(){var t,i=this.elements;return t=i[1],i[1]=i[3],i[3]=t,t=i[2],i[2]=i[6],i[6]=t,t=i[5],i[5]=i[7],i[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var i=this.elements;return t[0]=i[0],t[1]=i[3],t[2]=i[6],t[3]=i[1],t[4]=i[4],t[5]=i[7],t[6]=i[2],t[7]=i[5],t[8]=i[8],this},setUvTransform:function(t,i,e,s,n,r,h){var a=Math.cos(n),o=Math.sin(n);this.set(e*a,e*o,-e*(a*r+o*h)+r+t,-s*o,s*a,-s*(-o*r+a*h)+h+i,0,0,1)},scale:function(t,i){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=i,e[4]*=i,e[7]*=i,this},rotate:function(t){var i=Math.cos(t),e=Math.sin(t),s=this.elements,n=s[0],r=s[3],h=s[6],a=s[1],o=s[4],u=s[7];return s[0]=i*n+e*a,s[3]=i*r+e*o,s[6]=i*h+e*u,s[1]=-e*n+i*a,s[4]=-e*r+i*o,s[7]=-e*h+i*u,this},translate:function(t,i){var e=this.elements;return e[0]+=t*e[2],e[3]+=t*e[5],e[6]+=t*e[8],e[1]+=i*e[2],e[4]+=i*e[5],e[7]+=i*e[8],this},equals:function(t){for(var i=this.elements,e=t.elements,s=0;s<9;s++)if(i[s]!==e[s])return!1;return!0},fromArray:function(t,i){void 0===i&&(i=0);for(var e=0;e<9;e++)this.elements[e]=t[e+i];return this},toArray:function(t,i){void 0===t&&(t=[]),void 0===i&&(i=0);var e=this.elements;return t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=e[3],t[i+4]=e[4],t[i+5]=e[5],t[i+6]=e[6],t[i+7]=e[7],t[i+8]=e[8],t}});var fi=new st,mi=new Z,yi=1,gi=!1;function xi(t={}){this.id=yi++,this.attributes=t,this.index=null,this.VAOs={},this.drawRange={start:0,count:0},this.instancedCount=0}function vi(t,i,e,s){t=t||1,i=i||1;const n=e||1,r=s||1,h=(n+1)*(r+1),a=n*r*6,o=new Float32Array(3*h),u=new Float32Array(3*h),l=new Float32Array(2*h),c=a>65536?new Uint32Array(a):new Uint16Array(a);vi.buildPlane(o,u,l,c,t,i,0,n,r),xi.call(this,{position:new qt(o,3),normal:new qt(u,3),uv:new qt(l,2)}),this.setIndex(new Nt(c))}function _i(t,i,e,s,n,r){t=t||1,i=i||1,e=e||1;const h=s||1,a=n||1,o=r||1,u=(h+1)*(a+1)*2+(h+1)*(o+1)*2+(a+1)*(o+1)*2,l=6*(h*a*2+h*o*2+a*o*2),c=new Float32Array(3*u),d=new Float32Array(3*u),p=new Float32Array(2*u),f=u>65536?new Uint32Array(l):new Uint16Array(l);let m=0,y=0;vi.buildPlane(c,d,p,f,e,i,t,o,a,2,1,0,-1,-1,m,y),m+=(o+1)*(a+1),y+=o*a,vi.buildPlane(c,d,p,f,e,i,-t,o,a,2,1,0,1,-1,m,y),m+=(o+1)*(a+1),y+=o*a,vi.buildPlane(c,d,p,f,t,e,i,o,h,0,2,1,1,1,m,y),m+=(h+1)*(o+1),y+=h*o,vi.buildPlane(c,d,p,f,t,e,-i,o,h,0,2,1,1,-1,m,y),m+=(h+1)*(o+1),y+=h*o,vi.buildPlane(c,d,p,f,t,i,-e,h,a,0,1,2,-1,-1,m,y),m+=(h+1)*(a+1),y+=h*a,vi.buildPlane(c,d,p,f,t,i,e,h,a,0,1,2,1,-1,m,y),xi.call(this,{position:new qt(c,3),normal:new qt(d,3),uv:new qt(p,2)}),this.setIndex(new Nt(f))}xi.prototype={constructor:xi,initialize:function(t){var{attributes:i}=this;for(var e in this.gl=t,this.gl.renderer.bindVertexArray(null),this.gl.renderer.currentGeometry=null,this.glState=this.gl.renderer.state,i)this.setAttribute(e,i[e])},translate:function(t,i,e){return fi.makeTranslation(t,i,e),this.applyMatrix4(fi),this},clone:function(){return(new this.constructor).copy(this)},scale:function(t,i,e){return fi.makeScale(t,i,e),this.applyMatrix4(fi),this},applyMatrix4:function(t){var i=this.attributes.position;void 0!==i&&(i.applyMatrix4(t),i.needsUpdate=!0);var e=this.attributes.normal;if(void 0!==e){var s=(new pi).getNormalMatrix(t);e.applyNormalMatrix(s),e.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},copy:function(t){this.index=null,this.attributes={},this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var i=t.attributes;for(var e in i)this.attributes[e]=i[e].clone();return t.index&&this.setIndex(t.index.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this},setAttribute:function(t,i){return this.attributes[t]=i,this.index||(this.drawRange.count=Math.max(this.drawRange.count,i.count)),this},updateAttribute:function(t,i=this.gl.ARRAY_BUFFER){var e=!t.buffer;e&&(t.buffer=this.gl.createBuffer()),this.glState.boundBuffer!==t.buffer&&(this.gl.bindBuffer(i,t.buffer),this.glState.boundBuffer=t.buffer),e?this.gl.bufferData(i,t.array,t.usage):this.gl.bufferSubData(i,0,t.array),t.needsUpdate=!1},setIndex:function(t){this.index=t,this.drawRange.count=t.count},setDrawRange:function(t,i){this.drawRange.start=t,this.drawRange.count=i},setInstancedCount:function(t){this.instancedCount=t},createVAO:function(t){this.VAOs[t.attributeOrder]=this.gl.renderer.createVertexArray(),this.gl.renderer.bindVertexArray(this.VAOs[t.attributeOrder]),this.bindAttributes(t)},bindAttributes:function(t){t.attributeLocations.forEach(((t,{name:i,type:e})=>{if(this.attributes[i]){var s=this.attributes[i];s.buffer||this.updateAttribute(s),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s.buffer),this.glState.boundBuffer=s.buffer;var n=1;35674===e&&(n=2),35675===e&&(n=3),35676===e&&(n=4);for(var r=s.itemSize/n,h=1===n?0:n*n*4,a=1===n?0:4*n,o=0;o<n;o++)this.gl.vertexAttribPointer(t+o,r,this.gl.FLOAT,s.normalized,s.stride+h,s.offset+o*a),this.gl.enableVertexAttribArray(t+o),this.gl.renderer.vertexAttribDivisor(t+o,s.instanced)}})),this.index&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.index.buffer)},draw:function({material:t,mode:i=WebGLRenderingContext.TRIANGLES}){this.gl.renderer.currentGeometry!==`${this.id}_${t.attributeOrder}`&&(this.VAOs[t.attributeOrder]||this.createVAO(t),this.gl.renderer.bindVertexArray(this.VAOs[t.attributeOrder]),this.gl.renderer.currentGeometry=`${this.id}_${t.attributeOrder}`),t.attributeLocations.forEach(((t,{name:i})=>{var e=this.attributes[i];e&&e.needsUpdate&&this.updateAttribute(e)})),this.index&&this.index.needsUpdate&&this.updateAttribute(this.index,this.gl.ELEMENT_ARRAY_BUFFER);var e=2;this.index?.type===this.gl.UNSIGNED_INT&&(e=4),this.isInstanced?this.index?this.gl.renderer.drawElementsInstanced(i,this.drawRange.count,this.gl.UNSIGNED_SHORT,this.index.offset+this.drawRange.start*e,this.instancedCount):this.gl.renderer.drawArraysInstanced(i,this.drawRange.start,this.drawRange.count,this.instancedCount):this.index?this.gl.drawElements(i,this.drawRange.count,this.gl.UNSIGNED_SHORT,this.index.offset+this.drawRange.start*e):this.gl.drawArrays(i,this.drawRange.start,this.drawRange.count)},getPosition:function(){var t=this.attributes.position;return t.array?t:gi?void 0:gi=!0},computeBoundingBox:function(t){t||(t=this.getPosition());var i=t.array,e=t.itemSize;this.bounds||(this.bounds={min:new Z,max:new Z,center:new Z,scale:new Z,radius:1/0});var s=this.bounds.min,n=this.bounds.max,r=this.bounds.center,h=this.bounds.scale;s.set(1/0,1/0,1/0),n.set(-1/0,-1/0,-1/0);for(var a=0,o=i.length;a<o;a+=e){var u=i[a],l=i[a+1],c=i[a+2];s.x=Math.min(u,s.x),s.y=Math.min(l,s.y),s.z=Math.min(c,s.z),n.x=Math.max(u,n.x),n.y=Math.max(l,n.y),n.z=Math.max(c,n.z)}h.subVectors(n,s),r.subVectors(s,n).divideScalar(2)},computeBoundingSphere:function(t){t||(t=this.getPosition());var i=t.array,e=t.itemSize;this.bounds||this.computeBoundingBox(t);for(var s=0,n=0,r=i.length;n<r;n+=e)mi.fromArray(i,n),s=Math.max(s,this.bounds.center.distanceToSquared(mi));this.bounds.radius=Math.sqrt(s)},computeVertexNormals:function(){var t=this.index,i=this.attributes.position;if(void 0!==i){var e=this.attributes.normal;void 0===e&&(this.setAttribute('normal',new qt(new Float32Array(3*i.count),3)),e=this.attributes.normal);var s=new Z,n=new Z,r=new Z,h=new Z,a=new Z,o=new Z,u=new Z,l=new Z;if(t)for(var c=0,d=t.count;c<d;c+=3){var p=t.getX(c),f=t.getX(c+1),m=t.getX(c+2);s.fromAttribute(i,p),n.fromAttribute(i,f),r.fromAttribute(i,m),u.subVectors(r,n),l.subVectors(s,n),u.cross(l),h.fromAttribute(e,p),a.fromAttribute(e,f),o.fromAttribute(e,m),h.add(u),a.add(u),o.add(u),e.setXYZ(p,h.x,h.y,h.z),e.setXYZ(f,a.x,a.y,a.z),e.setXYZ(m,o.x,o.y,o.z)}e.needsUpdate=!0}},remove:function(){for(var t in this.VAOs)this.gl.renderer.deleteVertexArray(this.VAOs[t]),delete this.VAOs[t];for(var t in this.attributes)this.gl.deleteBuffer(this.attributes[t].buffer),delete this.attributes[t]}},Tiny.Geometry=xi,vi.prototype=Object.create(xi.prototype),vi.prototype.constructor=vi,vi.buildPlane=function(t,i,e,s,n,r,h,a,o,u,l,c,d,p,f,m){u=u||0,l=void 0!==l?l:1,c=void 0!==c?c:2,d=void 0!==d?d:1,p=void 0!==p?p:-1,m=m||0;const y=f=f||0,g=n/a,x=r/o;for(let v=0;v<=o;v++){let _=v*x-r/2;for(let r=0;r<=a;r++,f++){let x=r*g-n/2;if(t[3*f+u]=x*d,t[3*f+l]=_*p,t[3*f+c]=h/2,i[3*f+u]=0,i[3*f+l]=0,i[3*f+c]=h>=0?1:-1,e[2*f]=r/a,e[2*f+1]=1-v/o,v===o||r===a)continue;let w=y+r+v*(a+1),b=y+r+(v+1)*(a+1),M=y+r+(v+1)*(a+1)+1,z=y+r+v*(a+1)+1;s[6*m]=w,s[6*m+1]=b,s[6*m+2]=z,s[6*m+3]=b,s[6*m+4]=M,s[6*m+5]=z,m++}}},_i.prototype=Object.create(xi.prototype),_i.prototype.constructor=_i,Tiny.Vec3=Z,Tiny.Mat4=st,Tiny.Quat=q,Tiny.Object3D=ct,Tiny.Mesh=ft,Tiny.InstancedMesh=mt,Tiny.Light=yt,Tiny.AmbientLight=gt,Tiny.DirectionalLight=xt,Tiny.Camera=vt,Tiny.OrthographicCamera=Mt,Tiny.WebGLRenderer=Rt,Tiny.WebGlTexture=St,Tiny.PlaneGeometry=vi,Tiny.BoxGeometry=_i,Tiny.Material=Zt,Tiny.MeshBasicMaterial=oi,Tiny.MeshLambertMaterial=ui,Tiny.PointsMaterial=ai,Tiny.InstancedMeshBasicMaterial=li,Tiny.InstancedMeshLambertMaterial=ci,Tiny.Uniform=$t,Tiny.FloatUniform=Jt,Tiny.TextureUniform=ti,Tiny.Vector2Uniform=ii,Tiny.Vector3Uniform=ei,Tiny.Vector4Uniform=si,Tiny.ColorUniform=ni,Tiny.Matrix3Uniform=ri,Tiny.Matrix4Uniform=hi,Tiny.Attribute=kt,Tiny.Float64Attribute=Yt,Tiny.Float32Attribute=qt,Tiny.Float16Attribute=Wt,Tiny.Uint32Attribute=Gt,Tiny.Int32Attribute=Xt,Tiny.Uint16Attribute=Nt,Tiny.Int16Attribute=Bt,Tiny.Uint8ClampedAttribute=Dt,Tiny.Uint8Attribute=Vt,Tiny.Int8Attribute=Pt}()}();