!function(){var t={498:function(){window.Tiny={},Tiny.VERSION='2.2.2',Tiny.Primitives={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},Tiny.rnd=function(t,i){return t+Math.floor(Math.random()*(i-t+1))},Tiny.style2hex=function(t){return+t.replace('#','0x')},Tiny.hex2style=function(t){return'#'+('00000'+(0|t).toString(16)).substr(-6)},Tiny.hex2rgb=function(t){return[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255]},Tiny.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]}},847:function(){Date.now||(Date.now=function(){return(new Date).getTime()}),"undefined"==typeof Float32Array&&(window.Float32Array=Array)}},i={};function e(s){var r=i[s];if(void 0!==r)return r.exports;var n=i[s]={exports:{}};return t[s](n,n.exports,e),n.exports}!function(){"use strict";e(847),e(498);function t(){this.a=[],this.n=0}var i={call:function(t){t&&(t=t.prototype||t,i.mixin(t))},mixin:function(i){const e={};function s(i,s,r,n){var h=e[i];h||(h=e[i]=new t),h.a.push(s,r||null,n||!1),h.n+=3}i.once=function(t,i,e){s(t,i,e,!0)},i.on=s,i.off=function(t,i,s){if(e[t]){var r=e[t].a;if(i)if(s)for(n=0;n<r.length;n+=3)r[n]==i&&r[n+1]==s&&(r.splice(n,3),n-=3);else for(var n=0;n<r.length;n+=3)r[n]==i&&(r.splice(n,3),n-=3);else r.length=0;0==r.length&&delete e[t]}},i.emit=function(t,i,s,r){var n=e[t];if(n){var h=n.a;n.n=0;for(var a,o,u=arguments.length,l=0;l<h.length-n.n;l+=3)a=h[l],o=h[l+1],h[l+2]&&(h.splice(l,3),l-=3),u<=1?a.call(o):2==u?a.call(o,i):3==u?a.call(o,i,s):a.call(o,i,s,r);0==h.length&&delete e[t]}}}},s=[];function r(t,i){s.push({name:t,_class_:i})}var n,h,a,o,u,l=function(){},c=function(t){this.callbackContext=this,this.state=0,this.timeScale=1,this.width=0,this.height=0,this.systems=[],this.updatable=[],this.paused=!1,this.pauseDuration=0,this.inputView=document.body,Tiny.app||(Tiny.app=this),i.mixin(this),t=t||{},this.boot=t.boot||this.boot||l,this.preload=t.preload||this.preload||l,this.create=t.create||this.create||l,this.update=t.update||this.update||l,this.render=t.render||this.render||l,this._resize_cb=t.resize||l,this._destroy_cb=t.destroy||l;var e=this;setTimeout((function(){e._boot()}),0)};c.prototype._boot=function(){for(var t=0;t<s.length;t++){var i=s[t],e=new i._class_(this);this.systems.push(e),e.update&&this.updatable.push(e),i.name&&(this[i.name]=e)}Tiny.RAF&&(this.raf=new Tiny.RAF(this)),this.boot.call(this.callbackContext);var r=this;setTimeout((function(){r.load?r._preload():r._create()}),0)},c.prototype._preload=function(){this.preload.call(this.callbackContext),this.state=1,this.load.start(this._create)},c.prototype._create=function(){this.emit('load'),this.create.call(this.callbackContext),this.raf&&this.raf.start(),this.state=2},c.prototype.pause=function(){if(this.raf&&this.raf.reset(),!this.paused){for(var t=0;t<this.systems.length;t++)this.systems[t].pause&&this.systems[t].pause();this.paused=!0}},c.prototype.resume=function(){if(this.raf&&this.raf.reset(),this.paused){for(var t=0;t<this.systems.length;t++)this.systems[t].resume&&this.systems[t].resume();this.paused=!1}},c.prototype._update=function(t,i){if(this.paused)this.pauseDuration+=i;else{i*=this.timeScale,this.update.call(this.callbackContext,t,i),this.emit('update',i);for(var e=0;e<this.updatable.length;e++)this.updatable[e].update(i)}this.render(),this.emit('postrender')},c.prototype.resize=function(t,i){this.width=t||this.width,this.height=i||this.height,this.state>0&&(this._resize_cb.call(this.callbackContext,this.width,this.height),this.emit('resize',t,i));var e=this;setTimeout((function(){e.input&&e.input.updateBounds()}),0)},c.prototype.destroy=function(t){for(var i=0;i<this.systems.length;i++)this.systems[i].destroy&&this.systems[i].destroy(t);this.paused=!0,t&&this.load.clearCache(),this.raf&&this.raf.stop(),this._destroy_cb.call(this.callbackContext),Tiny.app===this&&(Tiny.app=null)};var d=function(){return(new Date).getTime()};void 0!==self.performance&&void 0!==self.performance.now?d=self.performance.now.bind(self.performance):void 0!==Date.now&&(d=Date.now);var p=function(t,i){void 0===i&&(i=!1),this.game=t,this.isRunning=!1,this.forceSetTimeOut=i;for(var e=['ms','moz','webkit','o'],s=0;s<e.length&&!window.requestAnimationFrame;s++)window.requestAnimationFrame=window[e[s]+'RequestAnimationFrame'],window.cancelAnimationFrame=window[e[s]+'CancelAnimationFrame']||window[e[s]+'CancelRequestAnimationFrame'];n=!1,h=null,a=null,o=0,u=0};p.prototype={start:function(){o=d(),this.isRunning=!0;var t=this;!window.requestAnimationFrame||this.forceSetTimeOut?(n=!0,h=function(){return t.updateSetTimeout()},a=window.setTimeout(h,0)):(n=!1,h=function(){return t.updateRAF()},a=window.requestAnimationFrame(h))},updateRAF:function(){u=d(),this.isRunning&&(this.game._update(Math.floor(u),u-o),a=window.requestAnimationFrame(h)),o=u},updateSetTimeout:function(){u=d(),this.isRunning&&(this.game._update(Math.floor(u),u-o),a=window.setTimeout(h,p.timeToCall)),o=u},reset:function(){o=d()},stop:function(){n?clearTimeout(a):window.cancelAnimationFrame(a),this.isRunning=!1}},p.timeToCall=15;var f={image:{},texture:{}},m=function(t){i.mixin(this),t.cache=f,this.game=t,this.list=[]};m.prototype={clearCache:function(){for(var t in f.texture)f.texture[t].destroy();for(var t in f)f[t]={}},all:function(t){this.list=this.list.concat(t)},image:function(t,i){this.list.push({src:i,key:t,type:'image'})},spritesheet:function(t,i,e,s,r,n){var h={src:i,key:t,type:'spritesheet'};'number'==typeof e?(h.width=e,h.height=s,h.total=r,h.duration=n):e.length>0&&(h.data=e),this.list.push(h)},atlas:function(t,i,e){this.list.push({src:i,key:t,data:e,type:'atlas'})},start:function(t){var i=this,e=i.game,s=i.list,r=s.length;function n(){var t=s.shift(),i=m[t.type];i?i(t,h):h()}function h(h,a){i.emit('progress',1-s.length/r),0!=s.length?n():(i.emit('complete'),t.call(e))}0!=r?n():t.call(e)}},m.atlas=function(t,i){var e=t.key;m.image(t,(function(t,s){for(var r=0;r<t.data.length;r++){var n=e+'.'+t.data[r].name,h=new Tiny.Texture(s,t.data[r]);h.key=e,f.texture[n]=h}i()}))},m.spritesheet=function(t,i){var e=t.key;m.image(t,(function(t,s){var r,n,h;if(t.data){var a=t.data;r=a.length-1;for(var o=0;o<=r;o++)n=e+'.'+o,(h=new Tiny.Texture(s,{name:o,x:Math.floor(a[o].x),y:Math.floor(a[o].y),width:Math.floor(a[o].width),height:Math.floor(a[o].height),duration:a[o].duration})).key=e,h.lastFrame=r,f.texture[n]=h}else{var u=s.naturalWidth||s.width,l=s.naturalHeight||s.height,c=t.width,d=t.height;c||(c=Math.floor(u/(t.cols||1))),d||(d=Math.floor(l/(t.rows||1)));var p=Math.floor(u/c)*Math.floor(l/d);if(0===p)return i();t.total&&(p=Math.min(p,t.total));var m=0,y=0;r=p-1;for(o=0;o<p;o++)n=e+'.'+o,(h=new Tiny.Texture(s,{name:o,x:m,y,width:c,height:d,duration:t.duration})).key=e,h.lastFrame=r,f.texture[n]=h,(m+=c)+c>u&&(m=0,y+=d)}i()}))},m.image=function(t,i){const e=new Image;e.addEventListener('load',(function(){f.image[t.key]=e,i(t,e)})),e.src=t.src},r('load',m);var y,g=Math.PI/180,x=180/Math.PI,v={distance:function(t,i,e,s){var r=t-e,n=i-s;return Math.sqrt(r*r+n*n)},degToRad:function(t){return t*g},radToDeg:function(t){return t*x},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t}},_=function(t){this.game=t;var e=this.domElement=t.inputView;this.bounds={x:0,y:0,width:0,height:0},this.candidates=[],this.list=[],this.lastMove=null,this.isDown=!1,this.downHandler=this.downHandler.bind(this),this.moveHandler=this.moveHandler.bind(this),this.upHandler=this.upHandler.bind(this),e.addEventListener('touchstart',this.downHandler),e.addEventListener('touchmove',this.moveHandler),e.addEventListener('touchend',this.upHandler),e.addEventListener('touchcancel',this.upHandler),e.addEventListener('mousedown',this.downHandler),e.addEventListener('mousemove',this.moveHandler),e.addEventListener('mouseup',this.upHandler),i.mixin(this);for(var s=0;s<_.systems.length;s++)_.systems[s].init.call(this);this.updateBounds()};_.prototype={add:function(t,e){t.inputEnabled=!0,(e=e||{}).system=this,t.input=e,i.mixin(t.input),this.list.push(t)},remove:function(t){var i=this.list.indexOf(t);if(i>-1){var e=this.list[i];return e.input=null,e.inputEnabled=!1,this.list.splice(i,1),e}},inputHandler:function(t,i){var e=this.getCoords(i);if(null!==e){if('move'!=t){this.candidates.length=0;for(var s=0;s<_.systems.length;s++)_.systems[s].preHandle.call(this,e.x,e.y);for(var r,n=0;n<this.list.length;n++)(r=this.list[n]).inputEnabled&&r.parent&&(r.input.checkBounds?r.input.checkBounds.call(this,r,e.x,e.y):_.checkBounds.call(this,r,e.x,e.y))&&this.candidates.push(r);for(s=this.candidates.length-1;s>=0;s--){if((r=this.candidates[s]).input['last_'+t]={x:e.x,y:e.y},r.input.emit(t,{x:e.x,y:e.y}),'up'==t){var h=r.input.last_down;h&&v.distance(h.x,h.y,e.x,e.y)<30&&r.input.emit('click',{x:e.x,y:e.y})}if(!r.input.transparent)break}}this.emit(t,{x:e.x,y:e.y})}},moveHandler:function(t){this.lastMove=t,this.inputHandler('move',t)},upHandler:function(t){this.isDown=!1,this.inputHandler('up',this.lastMove)},downHandler:function(t){this.isDown=!0,this.lastMove=t,this.inputHandler('down',t)},clickHandler:function(t){this.inputHandler('click',t)},getCoords:function(t){var i=null;return'undefined'!=typeof TouchEvent&&t instanceof TouchEvent?(y=!0,t.touches.length>0?i={x:t.touches[0].clientX,y:t.touches[0].clientY}:t.clientX&&t.clientY&&(i={x:t.clientX,y:t.clientY})):i={x:t.clientX,y:t.clientY},y&&t instanceof MouseEvent||null===i?null:i={x:i.x-this.bounds.x,y:i.y-this.bounds.y}},updateBounds:function(){var t=this.bounds,i=this.domElement.getBoundingClientRect();t.x=i.left,t.y=i.top,t.width=i.width,t.height=i.height},destroy:function(){var t=this.domElement;t.removeEventListener('touchstart',this.downHandler),t.removeEventListener('touchmove',this.moveHandler),t.removeEventListener('touchend',this.upHandler),t.removeEventListener('touchcancel',this.upHandler),t.removeEventListener('mousedown',this.downHandler),t.removeEventListener('mousemove',this.moveHandler),t.removeEventListener('mouseup',this.upHandler)}},_.checkBounds=function(t,i,e){if(t.worldVisible&&t.getBounds().contains(i,e))return!0},_.systems=[],r('input',_);var w=function(){},b=function(t,i,e,s,r,n,h,a,o){this.game=e,this.cb=s||w,this.ctx=r||this,this.delay=null==n?1e3:n,this.loop=h,this.count=a||0,this.repeat=this.count>0,this.running=!!t,this._lastFrame=0,this.autoRemove=i,this.onComplete=o||w};b.prototype={start:function(){this.running=!0},pause:function(){this.running=!1},stop:function(){this.running=!1,this._lastFrame=0},update:function(t){this.running&&(this._lastFrame+=t,this._lastFrame>=this.delay&&(this.cb.call(this.ctx),this._lastFrame=0,this.repeat?(this.count--,0===this.count&&(this.running=!1,this.autoRemove&&this.game.timer.remove(this),this.onComplete())):this.loop||(this.running=!1,this.autoRemove&&this.game.timer.remove(this))))}};var M=function(t){this.game=t,this.list=[],this.autoStart=!0,this.autoRemove=!0};M.prototype={update:function(t){for(var i=0;i<this.list.length;i++)this.list[i].update(t)},removeAll:function(){for(var t=0;t<this.list.length;t++)this.list[t].stop();this.list=[]},remove:function(t){var i=this.list.indexOf(t);i>-1&&(t.stop(),this.list.splice(i,1))},add:function(t,i,e,s,r){s=null!=s?s:this.autoStart,r=null!=r?r:this.autoRemove;var n=new b(s,r,this.game,i,e,t);return this.list.push(n),n},loop:function(t,i,e,s,r){s=null!=s?s:this.autoStart,r=null!=r?r:this.autoRemove;var n=new b(s,r,this.game,i,e,t,!0);return this.list.push(n),n},repeat:function(t,i,e,s,r,n,h){r=null!=r?r:this.autoStart,n=null!=n?n:this.autoRemove;var a=new b(r,n,this.game,e,s,t,!1,i,h);return this.list.push(a),a},destroy:function(){this.removeAll()}},r('timer',M);var T=function(){this._tweens={},this._tweensAddedDuringUpdate={}};T.prototype={getAll:function(){return Object.keys(this._tweens).map(function(t){return this._tweens[t]}.bind(this))},removeAll:function(){this._tweens={}},add:function(t){var i=t.getId();this._tweens[i]=t,this._tweensAddedDuringUpdate[i]=t},remove:function(t){var i=t.getId();delete this._tweens[i],delete this._tweensAddedDuringUpdate[i]},update:function(t,i){var e=Object.keys(this._tweens);if(0===e.length)return!1;for(;e.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<e.length;s++){var r=this._tweens[e[s]];r&&!1===r.update(t)&&(r._isPlaying=!1,i||delete this._tweens[e[s]])}e=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var A=new T;A.Group=T,A._nextId=0,A.nextId=function(){return A._nextId++};var C=function(t,i){this._isPaused=!1,this._object=t,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._time=0,this._easingFunction=z.Linear.None,this._interpolationFunction=E.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onRepeatCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=i||A,this._id=A.nextId()};C.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},isPaused:function(){return this._isPaused},to:function(t,i){return this._valuesEnd=Object.create(t),void 0!==i&&(this._duration=i),this},duration:function(t){return this._duration=t,this},start:function(t){for(var i in this._group.add(this),this._isPlaying=!0,this._isPaused=!1,this._time=0,this._onStartCallbackFired=!1,this._startTime=this._delayTime,this._valuesEnd){if(this._valuesEnd[i]instanceof Array){if(0===this._valuesEnd[i].length)continue;this._valuesEnd[i]=[this._object[i]].concat(this._valuesEnd[i])}void 0!==this._object[i]&&(1!=t&&void 0!==this._valuesStart[i]||(this._valuesStart[i]=this._object[i]),this._valuesStart[i]instanceof Array==!1&&(this._valuesStart[i]*=1),this._valuesStartRepeat[i]=this._valuesStart[i]||0)}return this},stop:function(){return this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens(),this):this},end:function(){return this.update(1/0),this},pause:function(){return this._isPaused||!this._isPlaying||(this._isPaused=!0,this._group.remove(this)),this},resume:function(){return this._isPaused&&this._isPlaying?(this._isPaused=!1,this._group.add(this),this):this},stopChainedTweens:function(){for(var t=0,i=this._chainedTweens.length;t<i;t++)this._chainedTweens[t].stop()},group:function(t){return this._group=t,this},delay:function(t){return this._delayTime=t,this},repeat:function(t){return this._repeat=t,this},repeatDelay:function(t){return this._repeatDelayTime=t,this},yoyo:function(t){return this._yoyo=t,this},easing:function(t){return this._easingFunction=t,this},interpolation:function(t){return this._interpolationFunction=t,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(t){return this._onStartCallback=t,this},onUpdate:function(t){return this._onUpdateCallback=t,this},onRepeat:function(t){return this._onRepeatCallback=t,this},onComplete:function(t){return this._onCompleteCallback=t,this},onStop:function(t){return this._onStopCallback=t,this},update:function(t){var i,e,s;if(this._time+=t,this._time<this._startTime)return!0;for(i in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),e=(this._time-this._startTime)/this._duration,e=0===this._duration||e>1?1:e,s=this._easingFunction(e),this._valuesEnd)if(void 0!==this._valuesStart[i]){var r=this._valuesStart[i]||0,n=this._valuesEnd[i];n instanceof Array?this._object[i]=this._interpolationFunction(n,s):('string'==typeof n&&(n='+'===n.charAt(0)||'-'===n.charAt(0)?r+parseFloat(n):parseFloat(n)),'number'==typeof n&&(this._object[i]=r+(n-r)*s))}if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object,e),1===e){if(this._time=0,this._repeat>0){for(i in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat){if('string'==typeof this._valuesEnd[i]&&(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo){var h=this._valuesStartRepeat[i];this._valuesStartRepeat[i]=this._valuesEnd[i],this._valuesEnd[i]=h}this._valuesStart[i]=this._valuesStartRepeat[i]}return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=this._repeatDelayTime:this._startTime=this._delayTime,null!==this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,o=this._chainedTweens.length;a<o;a++)this._chainedTweens[a].start();return!1}return!0}};var S,z={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){var i=1.70158;return t*t*((i+1)*t-i)},Out:function(t){var i=1.70158;return--t*t*((i+1)*t+i)+1},InOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)}},Bounce:{In:function(t){return 1-z.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*z.Bounce.In(2*t):.5*z.Bounce.Out(2*t-1)+.5}}},E={Linear:function(t,i){var e=t.length-1,s=e*i,r=Math.floor(s),n=E.Utils.Linear;return i<0?n(t[0],t[1],s):i>1?n(t[e],t[e-1],e-s):n(t[r],t[r+1>e?e:r+1],s-r)},Bezier:function(t,i){for(var e=0,s=t.length-1,r=Math.pow,n=E.Utils.Bernstein,h=0;h<=s;h++)e+=r(1-i,s-h)*r(i,h)*t[h]*n(s,h);return e},CatmullRom:function(t,i){var e=t.length-1,s=e*i,r=Math.floor(s),n=E.Utils.CatmullRom;return t[0]===t[e]?(i<0&&(r=Math.floor(s=e*(1+i))),n(t[(r-1+e)%e],t[r],t[(r+1)%e],t[(r+2)%e],s-r)):i<0?t[0]-(n(t[0],t[0],t[1],t[1],-s)-t[0]):i>1?t[e]-(n(t[e],t[e],t[e-1],t[e-1],s-e)-t[e]):n(t[r?r-1:0],t[r],t[e<r+1?e:r+1],t[e<r+2?e:r+2],s-r)},Utils:{Linear:function(t,i,e){return(i-t)*e+t},Bernstein:function(t,i){var e=E.Utils.Factorial;return e(t)/e(i)/e(t-i)},Factorial:(S=[1],function(t){var i=1;if(S[t])return S[t];for(var e=t;e>1;e--)i*=e;return S[t]=i,i}),CatmullRom:function(t,i,e,s,r){var n=.5*(e-t),h=.5*(s-i),a=r*r;return(2*i-2*e+n+h)*(r*a)+(-3*i+3*e-2*n-h)*a+n*r+i}}},P=function(t){this.game=t,this.bufferList=[],this.group=new T};P.prototype={remove:function(t){this.group.remove(t)},add:function(t){return new C(t,this.group)},pause:function(){for(var t in this.bufferList.length=0,this.group._tweens)this.bufferList.push(this.group._tweens[t]),this.group._tweens[t].pause()},resume(){for(var t=0;t<this.bufferList.length;t++)this.bufferList[t].resume();this.bufferList.length=0},update:function(t){this.group.update(t)},destroy:function(){this.bufferList.length=0,this.group.removeAll(),this.group=null}},r('tweens',P);var k=function(t,i,e){this.width=t,this.height=i,this.canvas=document.createElement('canvas'),this.context=this.canvas.getContext('2d',e),this.canvas.width=t,this.canvas.height=i};k.prototype.constructor=k,k.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.width,this.height)},k.prototype.resize=function(t,i){this.width=this.canvas.width=t,this.height=this.canvas.height=i},Tiny.App=c,Tiny.RAF=p,Tiny.registerSystem=r,Tiny.systems=s,Tiny.TweenManager=P,Tiny.Cache=f,Tiny.Loader=m,Tiny.Easing=z,Tiny.Interpolation=E,Tiny.Input=_,Tiny.CanvasBuffer=k,Tiny.EventEmitter=i,Tiny.Math=v;var F=function(t,i){this.x=t||0,this.y=i||0};F.prototype={set:function(t,i){return this.x=t||0,this.y=i||(0!==i?this.x:0),this}};var R=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0};R.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},R.prototype.toArray=function(t){this.array||(this.array=new Float32Array(9));var i=this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},R.prototype.apply=function(t,i){i=i||new F;var e=t.x,s=t.y;return i.x=this.a*e+this.c*s+this.tx,i.y=this.b*e+this.d*s+this.ty,i},R.prototype.applyInverse=function(t,i){i=i||new F;var e=1/(this.a*this.d+this.c*-this.b),s=t.x,r=t.y;return i.x=this.d*e*s+-this.c*e*r+(this.ty*this.c-this.tx*this.d)*e,i.y=this.a*e*r+-this.b*e*s+(-this.ty*this.a+this.tx*this.b)*e,i},R.prototype.translate=function(t,i){return this.tx+=t,this.ty+=i,this},R.prototype.scale=function(t,i){return this.a*=t,this.d*=i,this.c*=t,this.b*=i,this.tx*=t,this.ty*=i,this},R.prototype.rotate=function(t){var i=Math.cos(t),e=Math.sin(t),s=this.a,r=this.c,n=this.tx;return this.a=s*i-this.b*e,this.b=s*e+this.b*i,this.c=r*i-this.d*e,this.d=r*e+this.d*i,this.tx=n*i-this.ty*e,this.ty=n*e+this.ty*i,this},R.prototype.append=function(t){var i=this.a,e=this.b,s=this.c,r=this.d;return this.a=t.a*i+t.b*s,this.b=t.a*e+t.b*r,this.c=t.c*i+t.d*s,this.d=t.c*e+t.d*r,this.tx=t.tx*i+t.ty*s+this.tx,this.ty=t.tx*e+t.ty*r+this.ty,this},R.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this};var I=new R,L=function(t,i,e,s){t=t||0,i=i||0,e=e||0,s=s||0,this.x=t,this.y=i,this.width=e,this.height=s,this.type=Tiny.Primitives.RECT};L.prototype={setTo:function(t,i,e,s){return this.x=t,this.y=i,this.width=e,this.height=s,this},contains:function(t,i){return L.contains(this,t,i)},intersects:function(t){return L.intersects(this,t)}},Object.defineProperty(L.prototype,'bottom',{get:function(){return this.y+this.height},set:function(t){t<=this.y?this.height=0:this.height=t-this.y}}),Object.defineProperty(L.prototype,'right',{get:function(){return this.x+this.width},set:function(t){t<=this.x?this.width=0:this.width=t-this.x}}),Object.defineProperty(L.prototype,'volume',{get:function(){return this.width*this.height}}),L.prototype.constructor=L,L.contains=function(t,i,e){return!(t.width<=0||t.height<=0)&&(i>=t.x&&i<t.right&&e>=t.y&&e<t.bottom)},L.containsPoint=function(t,i){return L.contains(t,i.x,i.y)},L.containsRect=function(t,i){return!(t.volume>i.volume)&&(t.x>=i.x&&t.y>=i.y&&t.right<i.right&&t.bottom<i.bottom)},L.intersects=function(t,i){return!(t.width<=0||t.height<=0||i.width<=0||i.height<=0)&&!(t.right<i.x||t.bottom<i.y||t.x>i.right||t.y>i.bottom)};var O=new L(0,0,0,0),B=2*Math.PI,D=function(){this.position=new F(0,0),this.scale=new F(1,1),this.pivot=new F(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.renderable=!1,this.parent=null,this.worldAlpha=1,this.worldTransform=new R,this._sr=0,this._cr=1,this._cacheAsBitmap=!1};D.prototype.constructor=D,D.prototype.destroy=function(){this.parent&&this.parent.remove(this),this.parent=null,this.worldTransform=null,this.visible=!1,this.renderable=!1,this._destroyCachedSprite()},Object.defineProperty(D.prototype,'worldVisible',{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}}),Object.defineProperty(D.prototype,'cacheAsBitmap',{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap!==t&&(t?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=t)}}),D.prototype.updateTransform=function(){if(this.parent){var t,i,e,s,r,n,h=this.parent.worldTransform,a=this.worldTransform;this.rotation%B?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),t=this._cr*this.scale.x,i=this._sr*this.scale.x,e=-this._sr*this.scale.y,s=this._cr*this.scale.y,r=this.position.x,n=this.position.y,(this.pivot.x||this.pivot.y)&&(r-=this.pivot.x*t+this.pivot.y*e,n-=this.pivot.x*i+this.pivot.y*s),a.a=t*h.a+i*h.c,a.b=t*h.b+i*h.d,a.c=e*h.a+s*h.c,a.d=e*h.b+s*h.d,a.tx=r*h.a+n*h.c+h.tx,a.ty=r*h.b+n*h.d+h.ty):(t=this.scale.x,s=this.scale.y,r=this.position.x-this.pivot.x*t,n=this.position.y-this.pivot.y*s,a.a=t*h.a,a.b=t*h.b,a.c=s*h.c,a.d=s*h.d,a.tx=r*h.a+n*h.c+h.tx,a.ty=r*h.b+n*h.d+h.ty),this.worldAlpha=this.alpha*this.parent.worldAlpha}},D.prototype.displayObjectUpdateTransform=D.prototype.updateTransform,D.prototype.getBounds=function(t){return O},D.prototype.getLocalBounds=function(){return this.getBounds(I)},D.prototype.generateTexture=function(t,i){var e=this.getLocalBounds(),s=new Tiny.RenderTexture(0|e.width,0|e.height,i,t);return D._tempMatrix.tx=-e.x,D._tempMatrix.ty=-e.y,s.render(this,D._tempMatrix),s},D.prototype.updateCache=function(){this._generateCachedSprite()},D.prototype.toGlobal=function(t){return this.displayObjectUpdateTransform(),this.worldTransform.apply(t)},D.prototype.toLocal=function(t,i){return i&&(t=i.toGlobal(t)),this.displayObjectUpdateTransform(),this.worldTransform.applyInverse(t)},D.prototype._renderCachedSprite=function(t){this._cachedSprite.worldAlpha=this.worldAlpha,Tiny.Sprite.prototype.render.call(this._cachedSprite,t)},D.prototype._generateCachedSprite=function(){this._cachedSprite=null,this._cacheAsBitmap=!1;var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.texture.resize(0|t.width,0|t.height);else{var i=new Tiny.RenderTexture(0|t.width,0|t.height);this._cachedSprite=new Tiny.Sprite(i),this._cachedSprite.worldTransform=this.worldTransform}D._tempMatrix.tx=-t.x,D._tempMatrix.ty=-t.y,this._cachedSprite.texture.render(this,D._tempMatrix,!0),this._cachedSprite.anchor.x=-t.x/t.width,this._cachedSprite.anchor.y=-t.y/t.height,this._cacheAsBitmap=!0},D.prototype._destroyCachedSprite=function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)},D.prototype.render=function(t){},Object.defineProperty(D.prototype,'x',{get:function(){return this.position.x},set:function(t){this.position.x=t}}),Object.defineProperty(D.prototype,'y',{get:function(){return this.position.y},set:function(t){this.position.y=t}}),D._tempMatrix=new R;var U=function(){D.call(this),this.children=[],this._bounds=new L(0,0,1,1),this._currentBounds=null,this._mask=null};(U.prototype=Object.create(D.prototype)).constructor=U,Object.defineProperty(U.prototype,'width',{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var i=this.getLocalBounds().width;this.scale.x=0!==i?t/i:1,this._width=t}}),Object.defineProperty(U.prototype,'height',{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var i=this.getLocalBounds().height;this.scale.y=0!==i?t/i:1,this._height=t}}),Object.defineProperty(U.prototype,'mask',{get:function(){return this._mask},set:function(t){this._mask&&(this._mask.isMask=!1),this._mask=t,this._mask&&(this._mask.isMask=!0)}}),U.prototype.destroy=function(){for(var t=this.children.length;t--;)this.children[t].destroy();this.children=[],D.prototype.destroy.call(this),this._bounds=null,this._currentBounds=null,this._mask=null,this.input&&this.input.system.remove(this)},U.prototype.add=function(t){return this.addChildAt(t,this.children.length)},U.prototype.addChildAt=function(t,i){if(i>=0&&i<=this.children.length)return t.parent&&t.parent.remove(t),t.parent=this,this.game&&(t.game=this.game),this.children.splice(i,0,t),t;throw new Error(t+'addChildAt: The index '+i+' supplied is out of bounds '+this.children.length)},U.prototype.swapChildren=function(t,i){if(t!==i){var e=this.getChildIndex(t),s=this.getChildIndex(i);if(e<0||s<0)throw new Error('swapChildren: Both the supplied Objects must be a child of the caller.');this.children[e]=i,this.children[s]=t}},U.prototype.getChildIndex=function(t){var i=this.children.indexOf(t);if(-1===i)throw new Error('The supplied Object must be a child of the caller');return i},U.prototype.setChildIndex=function(t,i){if(i<0||i>=this.children.length)throw new Error('The supplied index is out of bounds');var e=this.getChildIndex(t);this.children.splice(e,1),this.children.splice(i,0,t)},U.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error('getChildAt: Supplied index '+t+' does not exist in the child list, or the supplied Object must be a child of the caller');return this.children[t]},U.prototype.remove=function(t){var i=this.children.indexOf(t);if(-1!==i)return this.removeChildAt(i)},U.prototype.removeChildAt=function(t){var i=this.getChildAt(t);return i.parent=void 0,this.children.splice(t,1),i},U.prototype.updateTransform=function(){if(this.visible&&(this.displayObjectUpdateTransform(),!this._cacheAsBitmap))for(var t=0,i=this.children.length;t<i;t++)this.children[t].updateTransform()},U.prototype.displayObjectContainerUpdateTransform=U.prototype.updateTransform,U.prototype.getBounds=function(){if(0===this.children.length)return O;if(this._cachedSprite)return this._cachedSprite.getBounds();for(var t,i,e,s=1/0,r=1/0,n=-1/0,h=-1/0,a=!1,o=0,u=this.children.length;o<u;o++){this.children[o].visible&&(a=!0,s=s<(t=this.children[o].getBounds()).x?s:t.x,r=r<t.y?r:t.y,n=n>(i=t.width+t.x)?n:i,h=h>(e=t.height+t.y)?h:e)}if(!a)return O;var l=this._bounds;return l.x=s,l.y=r,l.width=n-s,l.height=h-r,l},U.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=I;for(var i=0,e=this.children.length;i<e;i++)this.children[i].updateTransform();var s=this.getBounds();return this.worldTransform=t,s},U.prototype.render=function(t){if(!1!==this.visible&&0!==this.alpha)if(this._cacheAsBitmap)this._renderCachedSprite(t);else{this._mask&&t.maskManager.pushMask(this._mask,t);for(var i=0;i<this.children.length;i++)this.children[i].render(t);this._mask&&t.maskManager.popMask(t)}};var j=function(t){U.call(this),this.worldTransform=new R,this.game=t};(j.prototype=Object.create(U.prototype)).constructor=j,j.prototype.updateTransform=function(){this.worldAlpha=1;for(var t=0;t<this.children.length;t++)this.children[t].updateTransform()},Tiny.TextureCacheIdGenerator=0,Tiny.TextureSilentFail=!1;var W=function(t,i,e,s){if(this.noFrame=!1,this.resolution=1,this.hasLoaded=!1,i||(this.noFrame=!0,i=new L(0,0,1,1)),'string'==typeof t){var r=t;if(!(t=f.image[r]))throw new Error('Cache Error: image '+r+' does`t found in cache');f.texture[r]=this,this.key=r}if(this.source=t,this.frame=i,this.trim=s,this.valid=!1,this.width=0,this.height=0,this.crop=e||new L(0,0,1,1),(this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this.onSourceLoaded();else{var n=this;this.source.onload=function(){n.onSourceLoaded()}}};W.prototype.constructor=W,W.prototype.onSourceLoaded=function(){this.hasLoaded=!0,this.width=this.source.naturalWidth||this.source.width,this.height=this.source.naturalHeight||this.source.height,this.noFrame&&(this.frame=new L(0,0,this.width,this.height)),this.setFrame(this.frame)},W.prototype.addToCache=function(t,i){this.key=this.key||t,this.frame.name=this.frame.name||i,this.frame.name&&(t+='.'+this.frame.name),f.texture[t]=this},W.prototype.destroy=function(){this.key&&delete f.texture[this.key],this.source=null,this.valid=!1},W.prototype.setFrame=function(t){if(this.noFrame=!1,this.frame=t,this.valid=t&&t.width&&t.height&&this.source&&this.hasLoaded,this.valid)if(this.crop.x=t.x,this.crop.y=t.y,this.crop.width=t.width,this.crop.height=t.height,this.trim||!(t.x+t.width>this.width||t.y+t.height>this.height))this.trim&&(this.frame.width=this.trim.width,this.frame.height=this.trim.height);else{if(!TextureSilentFail)throw new Error('Texture Error: frame does not fit inside the base Texture dimensions '+this);this.valid=!1}},W.fromCanvas=function(t){return new W(t)};var q=function(t,i){U.call(this),this.anchor=new F,this.setTexture(t,i,!1),this._width=0,this._height=0,this.tint='#ffffff',this.blendMode='source-over',this.texture.hasLoaded&&this.onTextureUpdate(),this.renderable=!0};(q.prototype=Object.create(U.prototype)).constructor=q,Object.defineProperty(q.prototype,'frameName',{get:function(){return this.texture.frame.name},set:function(t){this.texture.frame.name&&this.setTexture(f.texture[this.texture.key+'.'+t])}}),Object.defineProperty(q.prototype,'width',{get:function(){return this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(q.prototype,'height',{get:function(){return this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),q.prototype.setTexture=function(t,i,e){if('string'==typeof t){var s=t;null!=i&&(s=s+'.'+i),(t=f.texture[s])||(t=new W(s))}return this.texture!==t&&(this.texture=t,this.cachedTint='#ffffff',!0===e&&this.onTextureUpdate(),!0)},q.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height)},q.prototype.getBounds=function(t){var i=this.texture.frame.width/this.texture.resolution,e=this.texture.frame.height/this.texture.resolution,s=i*(1-this.anchor.x),r=i*-this.anchor.x,n=e*(1-this.anchor.y),h=e*-this.anchor.y,a=t||this.worldTransform,o=a.a,u=a.b,l=a.c,c=a.d,d=a.tx,p=a.ty,f=-1/0,m=-1/0,y=1/0,g=1/0;if(0===u&&0===l)o<0?(y=o*s+d,f=o*r+d):(y=o*r+d,f=o*s+d),c<0?(g=c*n+p,m=c*h+p):(g=c*h+p,m=c*n+p);else{var x=o*r+l*h+d,v=c*h+u*r+p,_=o*s+l*h+d,w=c*h+u*s+p,b=o*s+l*n+d,M=c*n+u*s+p,T=o*r+l*n+d,A=c*n+u*r+p;y=T<(y=b<(y=_<(y=x<y?x:y)?_:y)?b:y)?T:y,g=A<(g=M<(g=w<(g=v<g?v:g)?w:g)?M:g)?A:g,f=T>(f=b>(f=_>(f=x>f?x:f)?_:f)?b:f)?T:f,m=A>(m=M>(m=w>(m=v>m?v:m)?w:m)?M:m)?A:m}var C=this._bounds;return C.x=y,C.width=f-y,C.y=g,C.height=m-g,this._currentBounds=C,C},q.prototype.render=function(t){if(!(!1===this.visible||0===this.alpha||!1===this.renderable||this.texture.crop.width<=0||this.texture.crop.height<=0)){if(this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,t.context.globalCompositeOperation=t.currentBlendMode),this._mask&&t.maskManager.pushMask(this._mask,t),this.texture.valid){var i=this.texture.resolution/t.resolution;t.context.globalAlpha=this.worldAlpha;var e=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,s=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height;t.roundPixels?(t.context.setTransform(this.worldTransform.a,this.worldTransform.b,this.worldTransform.c,this.worldTransform.d,this.worldTransform.tx*t.resolution|0,this.worldTransform.ty*t.resolution|0),e|=0,s|=0):t.context.setTransform(this.worldTransform.a,this.worldTransform.b,this.worldTransform.c,this.worldTransform.d,this.worldTransform.tx*t.resolution,this.worldTransform.ty*t.resolution),'#ffffff'!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=Tiny.CanvasTinter.getTintedTexture(this,this.tint)),t.context.drawImage(this.tintedTexture,0,0,this.texture.crop.width,this.texture.crop.height,e/i,s/i,this.texture.crop.width/i,this.texture.crop.height/i)):t.context.drawImage(this.texture.source,this.texture.crop.x,this.texture.crop.y,this.texture.crop.width,this.texture.crop.height,e/i,s/i,this.texture.crop.width/i,this.texture.crop.height/i)}for(var r=0;r<this.children.length;r++)this.children[r].render(t);this._mask&&t.maskManager.popMask(t)}};var V=function(t,i){this.canvas=document.createElement('canvas'),this.context=this.canvas.getContext('2d'),this.resolution=1,q.call(this,W.fromCanvas(this.canvas)),this.setText(t),this.setStyle(i)};(V.prototype=Object.create(q.prototype)).constructor=V,Object.defineProperty(V.prototype,'width',{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(V.prototype,'height',{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),V.prototype.setStyle=function(t){(t=t||{}).font=t.font||'bold 20pt Arial',t.fill=t.fill||'black',t.align=t.align||'left',t.stroke=t.stroke||'black',t.strokeThickness=t.strokeThickness||0,t.wordWrap=t.wordWrap||!1,t.lineSpacing=t.lineSpacing||0,t.wordWrapWidth=void 0!==t.wordWrapWidth?t.wordWrapWidth:100,t.dropShadow=t.dropShadow||!1,t.dropShadowAngle=void 0!==t.dropShadowAngle?t.dropShadowAngle:Math.PI/6,t.dropShadowDistance=void 0!==t.dropShadowDistance?t.dropShadowDistance:4,t.dropShadowColor=t.dropShadowColor||'black',this.style=t,this.dirty=!0},V.prototype.setText=function(t){this.text=t.toString()||' ',this.dirty=!0},V.prototype.updateText=function(){this.texture.resolution=this.resolution,this.context.font=this.style.font;var t=this.text;this.style.wordWrap&&(t=this.wordWrap(this.text));for(var i=t.split(/(?:\r\n|\r|\n)/),e=[],s=0,r=this.determineFontProperties(this.style.font),n=0;n<i.length;n++){var h=this.context.measureText(i[n]).width;e[n]=h,s=Math.max(s,h)}var a=s+this.style.strokeThickness;this.style.dropShadow&&(a+=this.style.dropShadowDistance),this.canvas.width=(a+this.context.lineWidth)*this.resolution;var o,u,l=r.fontSize+this.style.strokeThickness+this.style.lineSpacing,c=l*i.length;if(this.style.dropShadow&&(c+=this.style.dropShadowDistance),this.canvas.height=(c-this.style.lineSpacing)*this.resolution,this.context.scale(this.resolution,this.resolution),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline='alphabetic',this.context.miterLimit=2,this.style.dropShadow){this.context.fillStyle=this.style.dropShadowColor;var d=Math.sin(this.style.dropShadowAngle)*this.style.dropShadowDistance,p=Math.cos(this.style.dropShadowAngle)*this.style.dropShadowDistance;for(n=0;n<i.length;n++)o=this.style.strokeThickness/2,u=this.style.strokeThickness/2+n*l+r.ascent,'right'===this.style.align?o+=s-e[n]:'center'===this.style.align&&(o+=(s-e[n])/2),this.style.fill&&this.context.fillText(i[n],o+d,u+p)}for(this.context.fillStyle=this.style.fill,n=0;n<i.length;n++)o=this.style.strokeThickness/2,u=this.style.strokeThickness/2+n*l+r.ascent,'right'===this.style.align?o+=s-e[n]:'center'===this.style.align&&(o+=(s-e[n])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(i[n],o,u),this.style.fill&&this.context.fillText(i[n],o,u);this.updateTexture()},V.prototype.updateTexture=function(){this.texture.width=this.canvas.width,this.texture.height=this.canvas.height,this.texture.crop.width=this.texture.frame.width=this.canvas.width,this.texture.crop.height=this.texture.frame.height=this.canvas.height,this._width=this.canvas.width,this._height=this.canvas.height},V.prototype.render=function(t){(this.dirty||this.resolution!==t.resolution)&&(this.resolution=t.resolution,this.updateText(),this.dirty=!1),q.prototype.render.call(this,t)},V.prototype.determineFontProperties=function(t){var i=V.fontPropertiesCache[t];if(!i){i={};var e=V.fontPropertiesCanvas,s=V.fontPropertiesContext;s.font=t;var r=Math.ceil(s.measureText('|MÉq').width),n=Math.ceil(s.measureText('|MÉq').width),h=2*n;n=1.4*n|0,e.width=r,e.height=h,s.fillStyle='#f00',s.fillRect(0,0,r,h),s.font=t,s.textBaseline='alphabetic',s.fillStyle='#000',s.fillText('|MÉq',0,n);var a,o,u=s.getImageData(0,0,r,h).data,l=u.length,c=4*r,d=0,p=!1;for(a=0;a<n;a++){for(o=0;o<c;o+=4)if(255!==u[d+o]){p=!0;break}if(p)break;d+=c}for(i.ascent=n-a,d=l-c,p=!1,a=h;a>n;a--){for(o=0;o<c;o+=4)if(255!==u[d+o]){p=!0;break}if(p)break;d-=c}i.descent=a-n,i.descent+=6,i.fontSize=i.ascent+i.descent,V.fontPropertiesCache[t]=i}return i},V.prototype.wordWrap=function(t){for(var i='',e=t.split('\n'),s=0;s<e.length;s++){for(var r=this.style.wordWrapWidth,n=e[s].split(' '),h=0;h<n.length;h++){var a=this.context.measureText(n[h]).width,o=a+this.context.measureText(' ').width;0===h||o>r?(h>0&&(i+='\n'),i+=n[h],r=this.style.wordWrapWidth-a):(r-=o,i+=' '+n[h])}s<e.length-1&&(i+='\n')}return i},V.prototype.getBounds=function(t){return this.dirty&&(this.updateText(),this.dirty=!1),q.prototype.getBounds.call(this,t)},V.prototype.destroy=function(){this.context=null,this.canvas=null,this.texture.destroy(),q.prototype.destroy.call(this)},V.fontPropertiesCache={},V.fontPropertiesCanvas=document.createElement('canvas'),V.fontPropertiesContext=V.fontPropertiesCanvas.getContext('2d');var G=function(t,i,e){t=t||0,i=i||0,e=e||0,this.x=t,this.y=i,this._diameter=e,this._radius=0,e>0&&(this._radius=.5*e),this.type=Tiny.Primitives.CIRC};(G.prototype={getBounds:function(){return new L(this.x-this.radius,this.y-this.radius,this.diameter,this.diameter)},setTo:function(t,i,e){return this.x=t,this.y=i,this._diameter=e,this._radius=.5*e,this},copyFrom:function(t){return this.setTo(t.x,t.y,t.diameter)},copyTo:function(t){return t.x=this.x,t.y=this.y,t.diameter=this._diameter,t},distance:function(t,i){var e=Tiny.Math.distance(this.x,this.y,t.x,t.y);return i?Math.round(e):e},clone:function(t){return null==t?t=new G(this.x,this.y,this.diameter):t.setTo(this.x,this.y,this.diameter),t},contains:function(t,i){return G.contains(this,t,i)},offset:function(t,i){return this.x+=t,this.y+=i,this},offsetPoint:function(t){return this.offset(t.x,t.y)}}).constructor=G,Object.defineProperty(G.prototype,'diameter',{get:function(){return this._diameter},set:function(t){t>0&&(this._diameter=t,this._radius=.5*t)}}),Object.defineProperty(G.prototype,'radius',{get:function(){return this._radius},set:function(t){t>0&&(this._radius=t,this._diameter=2*t)}}),Object.defineProperty(G.prototype,'left',{get:function(){return this.x-this._radius},set:function(t){t>this.x?(this._radius=0,this._diameter=0):this.radius=this.x-t}}),Object.defineProperty(G.prototype,'right',{get:function(){return this.x+this._radius},set:function(t){t<this.x?(this._radius=0,this._diameter=0):this.radius=t-this.x}}),Object.defineProperty(G.prototype,'top',{get:function(){return this.y-this._radius},set:function(t){t>this.y?(this._radius=0,this._diameter=0):this.radius=this.y-t}}),Object.defineProperty(G.prototype,'bottom',{get:function(){return this.y+this._radius},set:function(t){t<this.y?(this._radius=0,this._diameter=0):this.radius=t-this.y}}),Object.defineProperty(G.prototype,'area',{get:function(){return this._radius>0?Math.PI*this._radius*this._radius:0}}),Object.defineProperty(G.prototype,'empty',{get:function(){return 0===this._diameter},set:function(t){!0===t&&this.setTo(0,0,0)}}),G.contains=function(t,i,e){return t.radius>0&&i>=t.left&&i<=t.right&&e>=t.top&&e<=t.bottom&&(t.x-i)*(t.x-i)+(t.y-e)*(t.y-e)<=t.radius*t.radius},G.equals=function(t,i){return t.x==i.x&&t.y==i.y&&t.diameter==i.diameter},G.intersects=function(t,i){return Tiny.Math.distance(t.x,t.y,i.x,i.y)<=t.radius+i.radius},G.intersectsRectangle=function(t,i){var e=Math.abs(t.x-i.x-i.halfWidth);if(e>i.halfWidth+t.radius)return!1;var s=Math.abs(t.y-i.y-i.halfHeight);if(s>i.halfHeight+t.radius)return!1;if(e<=i.halfWidth||s<=i.halfHeight)return!0;var r=e-i.halfWidth,n=s-i.halfHeight;return r*r+n*n<=t.radius*t.radius};var N=function(){this.area=0,this._points=[],arguments.length>0&&this.setTo.apply(this,arguments),this.closed=!0,this.type=Tiny.Primitives.POLY};N.prototype={toNumberArray:function(t){void 0===t&&(t=[]);for(var i=0;i<this._points.length;i++)'number'==typeof this._points[i]?(t.push(this._points[i]),t.push(this._points[i+1]),i++):(t.push(this._points[i].x),t.push(this._points[i].y));return t},flatten:function(){return this._points=this.toNumberArray(),this},clone:function(t){var i=this._points.slice();return null==t?t=new N(i):t.setTo(i),t},contains:function(t,i){for(var e=this._points.length,s=!1,r=-1,n=e-1;++r<e;n=r){var h=this._points[r].x,a=this._points[r].y,o=this._points[n].x,u=this._points[n].y;(a<=i&&i<u||u<=i&&i<a)&&t<(o-h)*(i-a)/(u-a)+h&&(s=!s)}return s},setTo:function(t){if(this.area=0,this._points=[],arguments.length>0){Array.isArray(t)||(t=Array.prototype.slice.call(arguments));for(var i=Number.MAX_VALUE,e=0,s=t.length;e<s;e++){if('number'==typeof t[e]){var r=new F(t[e],t[e+1]);e++}else r=new F(t[e].x,t[e].y);this._points.push(r),r.y<i&&(i=r.y)}this.calculateArea(i)}return this},calculateArea:function(t){for(var i,e,s,r,n=0,h=this._points.length;n<h;n++)i=this._points[n],e=n===h-1?this._points[0]:this._points[n+1],s=(i.y-t+(e.y-t))/2,r=i.x-e.x,this.area+=s*r;return this.area}},N.prototype.constructor=N,Object.defineProperty(N.prototype,'points',{get:function(){return this._points},set:function(t){null!=t?this.setTo(t):this.setTo()}});var X=function(t,i,e,s,r){this.x=t||0,this.y=i||0,this.width=e||0,this.height=s||0,this.radius=r||0,this.type=Tiny.Primitives.RREC};X.prototype.clone=function(){return new X(this.x,this.y,this.width,this.height,this.radius)},X.prototype.contains=function(t,i){if(this.width<=0||this.height<=0)return!1;var e=this.x;if(t>=e&&t<=e+this.width){var s=this.y;if(i>=s&&i<=s+this.height)return!0}return!1},X.prototype.constructor=X;var H=function(t,i,e,s,r,n,h){this.lineWidth=t,this.lineColor=i,this.lineAlpha=e,this._lineTint=i,this.fillColor=s,this.fillAlpha=r,this._fillTint=s,this.fill=n,this.shape=h,this.type=h.type};H.prototype.constructor=H,H.prototype.clone=function(){return new H(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)};var Y=function(){U.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=0,this.lineColor='#000000',this.graphicsData=[],this.tint='#ffffff',this.blendMode='source-over',this.currentPath=null,this.isMask=!1,this.boundsPadding=0,this._localBounds=new L(0,0,1,1),this._boundsDirty=!0,this.cachedSpriteDirty=!1};(Y.prototype=Object.create(U.prototype)).constructor=Y,Y.prototype.lineStyle=function(t,i,e){return this.lineWidth=t||0,this.lineColor=i||'#000000',this.lineAlpha=void 0===e?1:e,this.currentPath&&(this.currentPath.shape.points.length?this.drawShape(new N(this.currentPath.shape.points.slice(-2))):(this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha)),this},Y.prototype.moveTo=function(t,i){return this.drawShape(new N([t,i])),this},Y.prototype.lineTo=function(t,i){return this.currentPath||this.moveTo(0,0),this.currentPath.shape.points.push(t,i),this._boundsDirty=!0,this.cachedSpriteDirty=!0,this},Y.prototype.quadraticCurveTo=function(t,i,e,s){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var r,n,h=this.currentPath.shape.points;0===h.length&&this.moveTo(0,0);for(var a=h[h.length-2],o=h[h.length-1],u=0,l=1;l<=20;++l)r=a+(t-a)*(u=l/20),n=o+(i-o)*u,h.push(r+(t+(e-t)*u-r)*u,n+(i+(s-i)*u-n)*u);return this._boundsDirty=!0,this.cachedSpriteDirty=!0,this},Y.prototype.bezierCurveTo=function(t,i,e,s,r,n){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var h,a,o,u,l,c=this.currentPath.shape.points,d=c[c.length-2],p=c[c.length-1],f=0,m=1;m<=20;++m)o=(a=(h=1-(f=m/20))*h)*h,l=(u=f*f)*f,c.push(o*d+3*a*f*t+3*h*u*e+l*r,o*p+3*a*f*i+3*h*u*s+l*n);return this._boundsDirty=!0,this.cachedSpriteDirty=!0,this},Y.prototype.arcTo=function(t,i,e,s,r){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,i):this.moveTo(t,i);var n=this.currentPath.shape.points,h=n[n.length-2],a=n[n.length-1]-i,o=h-t,u=s-i,l=e-t,c=Math.abs(a*l-o*u);if(c<1e-8||0===r)n[n.length-2]===t&&n[n.length-1]===i||n.push(t,i);else{var d=a*a+o*o,p=u*u+l*l,f=a*u+o*l,m=r*Math.sqrt(d)/c,y=r*Math.sqrt(p)/c,g=m*f/d,x=y*f/p,v=m*l+y*o,_=m*u+y*a,w=o*(y+g),b=a*(y+g),M=l*(m+x),T=u*(m+x),A=Math.atan2(b-_,w-v),C=Math.atan2(T-_,M-v);this.arc(v+t,_+i,r,A,C,o*u>l*a)}return this._boundsDirty=!0,this.cachedSpriteDirty=!0,this},Y.prototype.arc=function(t,i,e,s,r,n){if(s===r)return this;void 0===n&&(n=!1),!n&&r<=s?r+=2*Math.PI:n&&s<=r&&(s+=2*Math.PI);var h=n?-1*(s-r):r-s,a=40*Math.ceil(Math.abs(h)/(2*Math.PI));if(0===h)return this;var o=t+Math.cos(s)*e,u=i+Math.sin(s)*e;n&&this.filling?this.moveTo(t,i):this.moveTo(o,u);for(var l=this.currentPath.shape.points,c=h/(2*a),d=2*c,p=Math.cos(c),f=Math.sin(c),m=a-1,y=m%1/m,g=0;g<=m;g++){var x=c+s+d*(g+y*g),v=Math.cos(x),_=-Math.sin(x);l.push((p*v+f*_)*e+t,(p*-_+f*v)*e+i)}return this._boundsDirty=!0,this.cachedSpriteDirty=!0,this},Y.prototype.beginFill=function(t,i){return this.filling=!0,this.fillColor=t||'#000000',this.fillAlpha=void 0===i?1:i,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},Y.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},Y.prototype.drawRect=function(t,i,e,s){return this.drawShape(new L(t,i,e,s)),this},Y.prototype.drawRoundedRect=function(t,i,e,s,r){return r>0?this.drawShape(new X(t,i,e,s,r)):this.drawRect(t,i,e,s),this},Y.prototype.drawCircle=function(t,i,e){return this.drawShape(new G(t,i,e)),this},Y.prototype.drawPolygon=function(t){var i=t;if(!Array.isArray(i)){i=new Array(arguments.length);for(var e=0;e<i.length;++e)i[e]=arguments[e]}return this.drawShape(new N(i)),this},Y.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this._boundsDirty=!0,this.cachedSpriteDirty=!0,this.graphicsData=[],this.updateLocalBounds(),this},Y.prototype.destroy=function(t){U.prototype.destroy.call(this),this.clear()},Y.prototype.generateTexture=function(t){t=t||1;var i=this.getBounds(),e=new k(i.width*t,i.height*t),s=W.fromCanvas(e.canvas);return s.resolution=t,e.context.scale(t,t),e.context.translate(-i.x,-i.y),Tiny.CanvasGraphics.renderGraphics(this,e.context),s},Y.prototype.render=function(t){if(!0!==this.isMask){if(this._prevTint!==this.tint&&(this._boundsDirty=!0,this._prevTint=this.tint),this._cacheAsBitmap)return this.cachedSpriteDirty&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this._boundsDirty=!1),this._cachedSprite.alpha=this.alpha,void q.prototype.render.call(this._cachedSprite,t);var i=t.context,e=this.worldTransform;this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,i.globalCompositeOperation=t.currentBlendMode),this._mask&&t.maskManager.pushMask(this._mask,t);var s=t.resolution;i.setTransform(e.a*s,e.b*s,e.c*s,e.d*s,e.tx*s,e.ty*s),Tiny.CanvasGraphics.renderGraphics(this,i);for(var r=0;r<this.children.length;r++)this.children[r].render(t);this._mask&&t.maskManager.popMask(t)}},Y.prototype.getBounds=function(t){if(!this._currentBounds||this._boundsDirty){if(!this.renderable)return O;this._boundsDirty&&(this.updateLocalBounds(),this.cachedSpriteDirty=!0,this._boundsDirty=!1);var i=this._localBounds,e=i.x,s=i.width+i.x,r=i.y,n=i.height+i.y,h=t||this.worldTransform,a=h.a,o=h.b,u=h.c,l=h.d,c=h.tx,d=h.ty,p=a*s+u*n+c,f=l*n+o*s+d,m=a*e+u*n+c,y=l*n+o*e+d,g=a*e+u*r+c,x=l*r+o*e+d,v=a*s+u*r+c,_=l*r+o*s+d,w=p,b=f,M=p,T=f;M=v<(M=g<(M=m<M?m:M)?g:M)?v:M,T=_<(T=x<(T=y<T?y:T)?x:T)?_:T,w=v>(w=g>(w=m>w?m:w)?g:w)?v:w,b=_>(b=x>(b=y>b?y:b)?x:b)?_:b,this._bounds.x=M,this._bounds.width=w-M,this._bounds.y=T,this._bounds.height=b-T,this._currentBounds=this._bounds}return this._currentBounds},Y.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,tempPoint);for(var i=this.graphicsData,e=0;e<i.length;e++){var s=i[e];if(s.fill&&(s.shape&&s.shape.contains(tempPoint.x,tempPoint.y)))return!0}return!1},Y.prototype.updateLocalBounds=function(){var t=1/0,i=-1/0,e=1/0,s=-1/0;if(this.graphicsData.length)for(var r,n,h,a,o,u,l=0;l<this.graphicsData.length;l++){var c=this.graphicsData[l],d=c.type,p=c.lineWidth;if(r=c.shape,d===Tiny.Primitives.RECT||d===Tiny.Primitives.RREC)h=r.x-p/2,a=r.y-p/2,t=h<t?h:t,i=h+(o=r.width+p)>i?h+o:i,e=a<e?a:e,s=a+(u=r.height+p)>s?a+u:s;else if(d===Tiny.Primitives.CIRC)h=r.x,a=r.y,t=h-(o=r.radius+p/2)<t?h-o:t,i=h+o>i?h+o:i,e=a-(u=r.radius+p/2)<e?a-u:e,s=a+u>s?a+u:s;else if(d===Tiny.Primitives.ELIP)h=r.x,a=r.y,t=h-(o=r.width+p/2)<t?h-o:t,i=h+o>i?h+o:i,e=a-(u=r.height+p/2)<e?a-u:e,s=a+u>s?a+u:s;else{n=r.points;for(var f=0;f<n.length;f++)n[f]instanceof F?(h=n[f].x,a=n[f].y):(h=n[f],a=n[f+1],f<n.length-1&&f++),t=h-p<t?h-p:t,i=h+p>i?h+p:i,e=a-p<e?a-p:e,s=a+p>s?a+p:s}}else t=0,i=0,e=0,s=0;var m=this.boundsPadding;this._localBounds.x=t-m,this._localBounds.width=i-t+2*m,this._localBounds.y=e-m,this._localBounds.height=s-e+2*m},Y.prototype._generateCachedSprite=function(){var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.buffer.resize(t.width,t.height);else{var i=new k(t.width,t.height),e=W.fromCanvas(i.canvas);this._cachedSprite=new q(e),this._cachedSprite.buffer=i,this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-t.x/t.width,this._cachedSprite.anchor.y=-t.y/t.height,this._cachedSprite.buffer.context.translate(-t.x,-t.y),this.worldAlpha=1,Tiny.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context),this._cachedSprite.alpha=this.alpha},Y.prototype.updateCachedSpriteTexture=function(){var t=this._cachedSprite,i=t.texture,e=t.buffer.canvas;i.width=e.width,i.height=e.height,i.crop.width=i.frame.width=e.width,i.crop.height=i.frame.height=e.height,t._width=e.width,t._height=e.height},Y.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0),this._cachedSprite=null},Y.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null,t instanceof N&&t.flatten();var i=new H(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,t);return this.graphicsData.push(i),i.type===Tiny.Primitives.POLY&&(i.shape.closed=this.filling,this.currentPath=i),this._boundsDirty=!0,this.cachedSpriteDirty=!0,i},Object.defineProperty(Y.prototype,'cacheAsBitmap',{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap=t,this._cacheAsBitmap?this._generateCachedSprite():(this.destroyCachedSprite(),this._boundsDirty=!0)}});var Z=function(t,i,e,s){this.width=t||100,this.height=i||100,s=s||1,this.textureBuffer=new k(this.width*s,this.height*s),W.call(this,this.textureBuffer.canvas,new L(0,0,Math.floor(this.width*s),Math.floor(this.height*s))),this.resolution=s,this.renderer=e||Tiny.defaultRenderer,this.valid=!0};function Q(t,i,e,s){this.x=t||0,this.y=i||0,this.z=e||0,this.w=void 0!==s?s:1}(Z.prototype=Object.create(W.prototype)).constructor=Z,Z.prototype.resize=function(t,i,e){t===this.width&&i===this.height||(this.valid=t>0&&i>0,this.width=t,this.height=i,this.frame.width=this.crop.width=t*this.resolution,this.frame.height=this.crop.height=i*this.resolution,this.valid&&this.textureBuffer.resize(this.width*this.resolution,this.height*this.resolution))},Z.prototype.clear=function(){this.valid&&this.textureBuffer.clear()},Z.prototype.render=function(t,i,e){if(this.valid){var s=t.worldTransform;s.identity(),i&&s.append(i),t.worldAlpha=1;for(var r=t.children,n=0,h=r.length;n<h;n++)r[n].updateTransform();e&&this.textureBuffer.clear();var a=this.textureBuffer.context,o=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderObject(t,a),this.renderer.resolution=o}},Z.prototype.getImage=function(){var t=new Image;return t.src=this.getBase64(),t},Z.prototype.getBase64=function(){return this.getCanvas().toDataURL()},Z.prototype.getCanvas=function(){return this.textureBuffer.canvas},Tiny.BaseObject2D=D,Tiny.Object2D=U,Tiny.Scene=j,Tiny.Sprite=q,Tiny.Text=V,Tiny.Graphics=Y,Tiny.Texture=W,Tiny.RenderTexture=Z,Tiny.Rectangle=L,Object.defineProperties(Q.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(Q.prototype,{isVector4:!0,set:function(t,i,e,s){return this.x=t,this.y=i,this.z=e,this.w=s,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error('index is out of range: '+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error('index is out of range: '+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,i){return void 0!==i?this.addVectors(t,i):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this.w=t.w+i.w,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this.w+=t.w*i,this},sub:function(t,i){return void 0!==i?this.subVectors(t,i):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this.w=t.w-i.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var i=this.x,e=this.y,s=this.z,r=this.w,n=t.elements;return this.x=n[0]*i+n[4]*e+n[8]*s+n[12]*r,this.y=n[1]*i+n[5]*e+n[9]*s+n[13]*r,this.z=n[2]*i+n[6]*e+n[10]*s+n[14]*r,this.w=n[3]*i+n[7]*e+n[11]*s+n[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var i=Math.sqrt(1-t.w*t.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/i,this.y=t.y/i,this.z=t.z/i),this},setAxisAngleFromRotationMatrix:function(t){var i,e,s,r,n=.01,h=.1,a=t.elements,o=a[0],u=a[4],l=a[8],c=a[1],d=a[5],p=a[9],f=a[2],m=a[6],y=a[10];if(Math.abs(u-c)<n&&Math.abs(l-f)<n&&Math.abs(p-m)<n){if(Math.abs(u+c)<h&&Math.abs(l+f)<h&&Math.abs(p+m)<h&&Math.abs(o+d+y-3)<h)return this.set(1,0,0,0),this;i=Math.PI;var g=(o+1)/2,x=(d+1)/2,v=(y+1)/2,_=(u+c)/4,w=(l+f)/4,b=(p+m)/4;return g>x&&g>v?g<n?(e=0,s=.707106781,r=.707106781):(s=_/(e=Math.sqrt(g)),r=w/e):x>v?x<n?(e=.707106781,s=0,r=.707106781):(e=_/(s=Math.sqrt(x)),r=b/s):v<n?(e=.707106781,s=.707106781,r=0):(e=w/(r=Math.sqrt(v)),s=b/r),this.set(e,s,r,i),this}var M=Math.sqrt((m-p)*(m-p)+(l-f)*(l-f)+(c-u)*(c-u));return Math.abs(M)<.001&&(M=1),this.x=(m-p)/M,this.y=(l-f)/M,this.z=(c-u)/M,this.w=Math.acos((o+d+y-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this.w=Math.max(t.w,Math.min(i.w,this.w)),this},clampScalar:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this.w=Math.max(t,Math.min(i,this.w)),this},clampLength:function(t,i){var e=this.length();return this.divideScalar(e||1).multiplyScalar(Math.max(t,Math.min(i,e)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this.w+=(t.w-this.w)*i,this},lerpVectors:function(t,i,e){return this.subVectors(i,t).multiplyScalar(e).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,i){return void 0===i&&(i=0),this.x=t[i],this.y=t[i+1],this.z=t[i+2],this.w=t[i+3],this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t[i+3]=this.w,t},fromBufferAttribute:function(t,i,e){return this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this.w=t.getW(i),this}});for(var K=[],$=0;$<256;$++)K[$]=($<16?'0':'')+$.toString(16);var J={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,s=4294967295*Math.random()|0;return(K[255&t]+K[t>>8&255]+K[t>>16&255]+K[t>>24&255]+'-'+K[255&i]+K[i>>8&255]+'-'+K[i>>16&15|64]+K[i>>24&255]+'-'+K[63&e|128]+K[e>>8&255]+'-'+K[e>>16&255]+K[e>>24&255]+K[255&s]+K[s>>8&255]+K[s>>16&255]+K[s>>24&255]).toUpperCase()},clamp:function(t,i,e){return Math.max(i,Math.min(e,t))},euclideanModulo:function(t,i){return(t%i+i)%i},mapLinear:function(t,i,e,s,r){return s+(t-i)*(r-s)/(e-i)},lerp:function(t,i,e){return(1-e)*t+e*i},smoothstep:function(t,i,e){return t<=i?0:t>=e?1:(t=(t-i)/(e-i))*t*(3-2*t)},smootherstep:function(t,i,e){return t<=i?0:t>=e?1:(t=(t-i)/(e-i))*t*t*(t*(6*t-15)+10)},randInt:function(t,i){return t+Math.floor(Math.random()*(i-t+1))},randFloat:function(t,i){return t+Math.random()*(i-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*J.DEG2RAD},radToDeg:function(t){return t*J.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};function tt(t,i,e,s){this._x=t||0,this._y=i||0,this._z=e||0,this._w=void 0!==s?s:1}Object.assign(tt,{slerp:function(t,i,e,s){return e.copy(t).slerp(i,s)},slerpFlat:function(t,i,e,s,r,n,h){var a=e[s+0],o=e[s+1],u=e[s+2],l=e[s+3],c=r[n+0],d=r[n+1],p=r[n+2],f=r[n+3];if(l!==f||a!==c||o!==d||u!==p){var m=1-h,y=a*c+o*d+u*p+l*f,g=y>=0?1:-1,x=1-y*y;if(x>Number.EPSILON){var v=Math.sqrt(x),_=Math.atan2(v,y*g);m=Math.sin(m*_)/v,h=Math.sin(h*_)/v}var w=h*g;if(a=a*m+c*w,o=o*m+d*w,u=u*m+p*w,l=l*m+f*w,m===1-h){var b=1/Math.sqrt(a*a+o*o+u*u+l*l);a*=b,o*=b,u*=b,l*=b}}t[i]=a,t[i+1]=o,t[i+2]=u,t[i+3]=l}}),Object.defineProperties(tt.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(tt.prototype,{isQuaternion:!0,set:function(t,i,e,s){return this._x=t,this._y=i,this._z=e,this._w=s,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,i){if(!t||!t.isEuler)throw new Error('THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.');var e=t._x,s=t._y,r=t._z,n=t.order,h=Math.cos,a=Math.sin,o=h(e/2),u=h(s/2),l=h(r/2),c=a(e/2),d=a(s/2),p=a(r/2);return'XYZ'===n?(this._x=c*u*l+o*d*p,this._y=o*d*l-c*u*p,this._z=o*u*p+c*d*l,this._w=o*u*l-c*d*p):'YXZ'===n?(this._x=c*u*l+o*d*p,this._y=o*d*l-c*u*p,this._z=o*u*p-c*d*l,this._w=o*u*l+c*d*p):'ZXY'===n?(this._x=c*u*l-o*d*p,this._y=o*d*l+c*u*p,this._z=o*u*p+c*d*l,this._w=o*u*l-c*d*p):'ZYX'===n?(this._x=c*u*l-o*d*p,this._y=o*d*l+c*u*p,this._z=o*u*p-c*d*l,this._w=o*u*l+c*d*p):'YZX'===n?(this._x=c*u*l+o*d*p,this._y=o*d*l+c*u*p,this._z=o*u*p-c*d*l,this._w=o*u*l-c*d*p):'XZY'===n&&(this._x=c*u*l-o*d*p,this._y=o*d*l-c*u*p,this._z=o*u*p+c*d*l,this._w=o*u*l+c*d*p),!1!==i&&this._onChangeCallback(),this},setFromAxisAngle:function(t,i){var e=i/2,s=Math.sin(e);return this._x=t.x*s,this._y=t.y*s,this._z=t.z*s,this._w=Math.cos(e),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var i,e=t.elements,s=e[0],r=e[4],n=e[8],h=e[1],a=e[5],o=e[9],u=e[2],l=e[6],c=e[10],d=s+a+c;return d>0?(i=.5/Math.sqrt(d+1),this._w=.25/i,this._x=(l-o)*i,this._y=(n-u)*i,this._z=(h-r)*i):s>a&&s>c?(i=2*Math.sqrt(1+s-a-c),this._w=(l-o)/i,this._x=.25*i,this._y=(r+h)/i,this._z=(n+u)/i):a>c?(i=2*Math.sqrt(1+a-s-c),this._w=(n-u)/i,this._x=(r+h)/i,this._y=.25*i,this._z=(o+l)/i):(i=2*Math.sqrt(1+c-s-a),this._w=(h-r)/i,this._x=(n+u)/i,this._y=(o+l)/i,this._z=.25*i),this._onChangeCallback(),this},setFromUnitVectors:function(t,i){var e=t.dot(i)+1;return e<1e-6?(e=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=e):(this._x=0,this._y=-t.z,this._z=t.y,this._w=e)):(this._x=t.y*i.z-t.z*i.y,this._y=t.z*i.x-t.x*i.z,this._z=t.x*i.y-t.y*i.x,this._w=e),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(J.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,i){var e=this.angleTo(t);if(0===e)return this;var s=Math.min(1,i/e);return this.slerp(t,s),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,i){return void 0!==i?this.multiplyQuaternions(t,i):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,i){var e=t._x,s=t._y,r=t._z,n=t._w,h=i._x,a=i._y,o=i._z,u=i._w;return this._x=e*u+n*h+s*o-r*a,this._y=s*u+n*a+r*h-e*o,this._z=r*u+n*o+e*a-s*h,this._w=n*u-e*h-s*a-r*o,this._onChangeCallback(),this},slerp:function(t,i){if(0===i)return this;if(1===i)return this.copy(t);var e=this._x,s=this._y,r=this._z,n=this._w,h=n*t._w+e*t._x+s*t._y+r*t._z;if(h<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,h=-h):this.copy(t),h>=1)return this._w=n,this._x=e,this._y=s,this._z=r,this;var a=1-h*h;if(a<=Number.EPSILON){var o=1-i;return this._w=o*n+i*this._w,this._x=o*e+i*this._x,this._y=o*s+i*this._y,this._z=o*r+i*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(a),l=Math.atan2(u,h),c=Math.sin((1-i)*l)/u,d=Math.sin(i*l)/u;return this._w=n*c+this._w*d,this._x=e*c+this._x*d,this._y=s*c+this._y*d,this._z=r*c+this._z*d,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,i){return void 0===i&&(i=0),this._x=t[i],this._y=t[i+1],this._z=t[i+2],this._w=t[i+3],this._onChangeCallback(),this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._w,t},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var it=new st,et=new tt;function st(t,i,e){this.x=t||0,this.y=i||0,this.z=e||0}function rt(t,i){this.x=t||0,this.y=i||0}Object.assign(st.prototype,{isVector3:!0,set:function(t,i,e){return this.x=t,this.y=i,this.z=e,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error('index is out of range: '+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error('index is out of range: '+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,i){return void 0!==i?this.addVectors(t,i):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this},sub:function(t,i){return void 0!==i?this.subVectors(t,i):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this},multiply:function(t,i){return void 0!==i?this.multiplyVectors(t,i):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this},applyEuler:function(t){return!t||t.isEuler,this.applyQuaternion(et.setFromEuler(t))},applyAxisAngle:function(t,i){return this.applyQuaternion(et.setFromAxisAngle(t,i))},applyMatrix3:function(t){var i=this.x,e=this.y,s=this.z,r=t.elements;return this.x=r[0]*i+r[3]*e+r[6]*s,this.y=r[1]*i+r[4]*e+r[7]*s,this.z=r[2]*i+r[5]*e+r[8]*s,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var i=this.x,e=this.y,s=this.z,r=t.elements,n=1/(r[3]*i+r[7]*e+r[11]*s+r[15]);return this.x=(r[0]*i+r[4]*e+r[8]*s+r[12])*n,this.y=(r[1]*i+r[5]*e+r[9]*s+r[13])*n,this.z=(r[2]*i+r[6]*e+r[10]*s+r[14])*n,this},applyQuaternion:function(t){var i=this.x,e=this.y,s=this.z,r=t.x,n=t.y,h=t.z,a=t.w,o=a*i+n*s-h*e,u=a*e+h*i-r*s,l=a*s+r*e-n*i,c=-r*i-n*e-h*s;return this.x=o*a+c*-r+u*-h-l*-n,this.y=u*a+c*-n+l*-r-o*-h,this.z=l*a+c*-h+o*-n-u*-r,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var i=this.x,e=this.y,s=this.z,r=t.elements;return this.x=r[0]*i+r[4]*e+r[8]*s,this.y=r[1]*i+r[5]*e+r[9]*s,this.z=r[2]*i+r[6]*e+r[10]*s,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this},clampScalar:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this},clampLength:function(t,i){var e=this.length();return this.divideScalar(e||1).multiplyScalar(Math.max(t,Math.min(i,e)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this},lerpVectors:function(t,i,e){return this.subVectors(i,t).multiplyScalar(e).add(t)},cross:function(t,i){return void 0!==i?this.crossVectors(t,i):this.crossVectors(this,t)},crossVectors:function(t,i){var e=t.x,s=t.y,r=t.z,n=i.x,h=i.y,a=i.z;return this.x=s*a-r*h,this.y=r*n-e*a,this.z=e*h-s*n,this},projectOnVector:function(t){var i=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(i)},projectOnPlane:function(t){return it.copy(this).projectOnVector(t),this.sub(it)},reflect:function(t){return this.sub(it.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var i=Math.sqrt(this.lengthSq()*t.lengthSq()),e=this.dot(t)/i;return Math.acos(J.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,e=this.y-t.y,s=this.z-t.z;return i*i+e*e+s*s},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,i,e){var s=Math.sin(i)*t;return this.x=s*Math.sin(e),this.y=Math.cos(i)*t,this.z=s*Math.cos(e),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,i,e){return this.x=t*Math.sin(i),this.y=e,this.z=t*Math.cos(i),this},setFromMatrixPosition:function(t){var i=t.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this},setFromMatrixScale:function(t){var i=this.setFromMatrixColumn(t,0).length(),e=this.setFromMatrixColumn(t,1).length(),s=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=e,this.z=s,this},setFromMatrixColumn:function(t,i){return this.fromArray(t.elements,4*i)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,i){return void 0===i&&(i=0),this.x=t[i],this.y=t[i+1],this.z=t[i+2],this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t},fromBufferAttribute:function(t,i,e){return this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this}}),Object.defineProperties(rt.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(rt.prototype,{isVector2:!0,set:function(t,i){return this.x=t,this.y=i,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error('index is out of range: '+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error('index is out of range: '+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,i){return void 0!==i?this.addVectors(t,i):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this},sub:function(t,i){return void 0!==i?this.subVectors(t,i):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var i=this.x,e=this.y,s=t.elements;return this.x=s[0]*i+s[3]*e+s[6],this.y=s[1]*i+s[4]*e+s[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this},clampScalar:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this},clampLength:function(t,i){var e=this.length();return this.divideScalar(e||1).multiplyScalar(Math.max(t,Math.min(i,e)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,e=this.y-t.y;return i*i+e*e},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this},lerpVectors:function(t,i,e){return this.subVectors(i,t).multiplyScalar(e).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,i){return void 0===i&&(i=0),this.x=t[i],this.y=t[i+1],this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t},fromBufferAttribute:function(t,i,e){return this.x=t.getX(i),this.y=t.getY(i),this},rotateAround:function(t,i){var e=Math.cos(i),s=Math.sin(i),r=this.x-t.x,n=this.y-t.y;return this.x=r*e-n*s+t.x,this.y=r*s+n*e+t.y,this}});var nt=new st,ht=new dt,at=new st(0,0,0),ot=new st(1,1,1),ut=new st,lt=new st,ct=new st;function dt(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}Object.assign(dt.prototype,{isMatrix4:!0,set:function(t,i,e,s,r,n,h,a,o,u,l,c,d,p,f,m){var y=this.elements;return y[0]=t,y[4]=i,y[8]=e,y[12]=s,y[1]=r,y[5]=n,y[9]=h,y[13]=a,y[2]=o,y[6]=u,y[10]=l,y[14]=c,y[3]=d,y[7]=p,y[11]=f,y[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new dt).fromArray(this.elements)},copy:function(t){var i=this.elements,e=t.elements;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],this},copyPosition:function(t){var i=this.elements,e=t.elements;return i[12]=e[12],i[13]=e[13],i[14]=e[14],this},extractBasis:function(t,i,e){return t.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),e.setFromMatrixColumn(this,2),this},makeBasis:function(t,i,e){return this.set(t.x,i.x,e.x,0,t.y,i.y,e.y,0,t.z,i.z,e.z,0,0,0,0,1),this},extractRotation:function(t){var i=this.elements,e=t.elements,s=1/nt.setFromMatrixColumn(t,0).length(),r=1/nt.setFromMatrixColumn(t,1).length(),n=1/nt.setFromMatrixColumn(t,2).length();return i[0]=e[0]*s,i[1]=e[1]*s,i[2]=e[2]*s,i[3]=0,i[4]=e[4]*r,i[5]=e[5]*r,i[6]=e[6]*r,i[7]=0,i[8]=e[8]*n,i[9]=e[9]*n,i[10]=e[10]*n,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},makeRotationFromEuler:function(t){!t||t.isEuler;var i=this.elements,e=t.x,s=t.y,r=t.z,n=Math.cos(e),h=Math.sin(e),a=Math.cos(s),o=Math.sin(s),u=Math.cos(r),l=Math.sin(r);if('XYZ'===t.order){var c=n*u,d=n*l,p=h*u,f=h*l;i[0]=a*u,i[4]=-a*l,i[8]=o,i[1]=d+p*o,i[5]=c-f*o,i[9]=-h*a,i[2]=f-c*o,i[6]=p+d*o,i[10]=n*a}else if('YXZ'===t.order){var m=a*u,y=a*l,g=o*u,x=o*l;i[0]=m+x*h,i[4]=g*h-y,i[8]=n*o,i[1]=n*l,i[5]=n*u,i[9]=-h,i[2]=y*h-g,i[6]=x+m*h,i[10]=n*a}else if('ZXY'===t.order){m=a*u,y=a*l,g=o*u,x=o*l;i[0]=m-x*h,i[4]=-n*l,i[8]=g+y*h,i[1]=y+g*h,i[5]=n*u,i[9]=x-m*h,i[2]=-n*o,i[6]=h,i[10]=n*a}else if('ZYX'===t.order){c=n*u,d=n*l,p=h*u,f=h*l;i[0]=a*u,i[4]=p*o-d,i[8]=c*o+f,i[1]=a*l,i[5]=f*o+c,i[9]=d*o-p,i[2]=-o,i[6]=h*a,i[10]=n*a}else if('YZX'===t.order){var v=n*a,_=n*o,w=h*a,b=h*o;i[0]=a*u,i[4]=b-v*l,i[8]=w*l+_,i[1]=l,i[5]=n*u,i[9]=-h*u,i[2]=-o*u,i[6]=_*l+w,i[10]=v-b*l}else if('XZY'===t.order){v=n*a,_=n*o,w=h*a,b=h*o;i[0]=a*u,i[4]=-l,i[8]=o*u,i[1]=v*l+b,i[5]=n*u,i[9]=_*l-w,i[2]=w*l-_,i[6]=h*u,i[10]=b*l+v}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(at,t,ot)},lookAt:function(t,i,e){var s=this.elements;return ct.subVectors(t,i),0===ct.lengthSq()&&(ct.z=1),ct.normalize(),ut.crossVectors(e,ct),0===ut.lengthSq()&&(1===Math.abs(e.z)?ct.x+=1e-4:ct.z+=1e-4,ct.normalize(),ut.crossVectors(e,ct)),ut.normalize(),lt.crossVectors(ct,ut),s[0]=ut.x,s[4]=lt.x,s[8]=ct.x,s[1]=ut.y,s[5]=lt.y,s[9]=ct.y,s[2]=ut.z,s[6]=lt.z,s[10]=ct.z,this},multiply:function(t,i){return void 0!==i?this.multiplyMatrices(t,i):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,i){var e=t.elements,s=i.elements,r=this.elements,n=e[0],h=e[4],a=e[8],o=e[12],u=e[1],l=e[5],c=e[9],d=e[13],p=e[2],f=e[6],m=e[10],y=e[14],g=e[3],x=e[7],v=e[11],_=e[15],w=s[0],b=s[4],M=s[8],T=s[12],A=s[1],C=s[5],S=s[9],z=s[13],E=s[2],P=s[6],k=s[10],F=s[14],R=s[3],I=s[7],L=s[11],O=s[15];return r[0]=n*w+h*A+a*E+o*R,r[4]=n*b+h*C+a*P+o*I,r[8]=n*M+h*S+a*k+o*L,r[12]=n*T+h*z+a*F+o*O,r[1]=u*w+l*A+c*E+d*R,r[5]=u*b+l*C+c*P+d*I,r[9]=u*M+l*S+c*k+d*L,r[13]=u*T+l*z+c*F+d*O,r[2]=p*w+f*A+m*E+y*R,r[6]=p*b+f*C+m*P+y*I,r[10]=p*M+f*S+m*k+y*L,r[14]=p*T+f*z+m*F+y*O,r[3]=g*w+x*A+v*E+_*R,r[7]=g*b+x*C+v*P+_*I,r[11]=g*M+x*S+v*k+_*L,r[15]=g*T+x*z+v*F+_*O,this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this},applyToBufferAttribute:function(t){for(var i=0,e=t.count;i<e;i++)nt.x=t.getX(i),nt.y=t.getY(i),nt.z=t.getZ(i),nt.applyMatrix4(this),t.setXYZ(i,nt.x,nt.y,nt.z);return t},determinant:function(){var t=this.elements,i=t[0],e=t[4],s=t[8],r=t[12],n=t[1],h=t[5],a=t[9],o=t[13],u=t[2],l=t[6],c=t[10],d=t[14];return t[3]*(+r*a*l-s*o*l-r*h*c+e*o*c+s*h*d-e*a*d)+t[7]*(+i*a*d-i*o*c+r*n*c-s*n*d+s*o*u-r*a*u)+t[11]*(+i*o*l-i*h*d-r*n*l+e*n*d+r*h*u-e*o*u)+t[15]*(-s*h*u-i*a*l+i*h*c+s*n*l-e*n*c+e*a*u)},transpose:function(){var t,i=this.elements;return t=i[1],i[1]=i[4],i[4]=t,t=i[2],i[2]=i[8],i[8]=t,t=i[6],i[6]=i[9],i[9]=t,t=i[3],i[3]=i[12],i[12]=t,t=i[7],i[7]=i[13],i[13]=t,t=i[11],i[11]=i[14],i[14]=t,this},setPosition:function(t,i,e){var s=this.elements;return t.isVector3?(s[12]=t.x,s[13]=t.y,s[14]=t.z):(s[12]=t,s[13]=i,s[14]=e),this},getInverse:function(t,i){var e=this.elements,s=t.elements,r=s[0],n=s[1],h=s[2],a=s[3],o=s[4],u=s[5],l=s[6],c=s[7],d=s[8],p=s[9],f=s[10],m=s[11],y=s[12],g=s[13],x=s[14],v=s[15],_=p*x*c-g*f*c+g*l*m-u*x*m-p*l*v+u*f*v,w=y*f*c-d*x*c-y*l*m+o*x*m+d*l*v-o*f*v,b=d*g*c-y*p*c+y*u*m-o*g*m-d*u*v+o*p*v,M=y*p*l-d*g*l-y*u*f+o*g*f+d*u*x-o*p*x,T=r*_+n*w+h*b+a*M;if(0===T){if(!0===i)throw new Error("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");return this.identity()}var A=1/T;return e[0]=_*A,e[1]=(g*f*a-p*x*a-g*h*m+n*x*m+p*h*v-n*f*v)*A,e[2]=(u*x*a-g*l*a+g*h*c-n*x*c-u*h*v+n*l*v)*A,e[3]=(p*l*a-u*f*a-p*h*c+n*f*c+u*h*m-n*l*m)*A,e[4]=w*A,e[5]=(d*x*a-y*f*a+y*h*m-r*x*m-d*h*v+r*f*v)*A,e[6]=(y*l*a-o*x*a-y*h*c+r*x*c+o*h*v-r*l*v)*A,e[7]=(o*f*a-d*l*a+d*h*c-r*f*c-o*h*m+r*l*m)*A,e[8]=b*A,e[9]=(y*p*a-d*g*a-y*n*m+r*g*m+d*n*v-r*p*v)*A,e[10]=(o*g*a-y*u*a+y*n*c-r*g*c-o*n*v+r*u*v)*A,e[11]=(d*u*a-o*p*a-d*n*c+r*p*c+o*n*m-r*u*m)*A,e[12]=M*A,e[13]=(d*g*h-y*p*h+y*n*f-r*g*f-d*n*x+r*p*x)*A,e[14]=(y*u*h-o*g*h-y*n*l+r*g*l+o*n*x-r*u*x)*A,e[15]=(o*p*h-d*u*h+d*n*l-r*p*l-o*n*f+r*u*f)*A,this},scale:function(t){var i=this.elements,e=t.x,s=t.y,r=t.z;return i[0]*=e,i[4]*=s,i[8]*=r,i[1]*=e,i[5]*=s,i[9]*=r,i[2]*=e,i[6]*=s,i[10]*=r,i[3]*=e,i[7]*=s,i[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],e=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],s=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(i,e,s))},makeTranslation:function(t,i,e){return this.set(1,0,0,t,0,1,0,i,0,0,1,e,0,0,0,1),this},makeRotationX:function(t){var i=Math.cos(t),e=Math.sin(t);return this.set(1,0,0,0,0,i,-e,0,0,e,i,0,0,0,0,1),this},makeRotationY:function(t){var i=Math.cos(t),e=Math.sin(t);return this.set(i,0,e,0,0,1,0,0,-e,0,i,0,0,0,0,1),this},makeRotationZ:function(t){var i=Math.cos(t),e=Math.sin(t);return this.set(i,-e,0,0,e,i,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,i){var e=Math.cos(i),s=Math.sin(i),r=1-e,n=t.x,h=t.y,a=t.z,o=r*n,u=r*h;return this.set(o*n+e,o*h-s*a,o*a+s*h,0,o*h+s*a,u*h+e,u*a-s*n,0,o*a-s*h,u*a+s*n,r*a*a+e,0,0,0,0,1),this},makeScale:function(t,i,e){return this.set(t,0,0,0,0,i,0,0,0,0,e,0,0,0,0,1),this},makeShear:function(t,i,e){return this.set(1,i,e,0,t,1,e,0,t,i,1,0,0,0,0,1),this},compose:function(t,i,e){var s=this.elements,r=i._x,n=i._y,h=i._z,a=i._w,o=r+r,u=n+n,l=h+h,c=r*o,d=r*u,p=r*l,f=n*u,m=n*l,y=h*l,g=a*o,x=a*u,v=a*l,_=e.x,w=e.y,b=e.z;return s[0]=(1-(f+y))*_,s[1]=(d+v)*_,s[2]=(p-x)*_,s[3]=0,s[4]=(d-v)*w,s[5]=(1-(c+y))*w,s[6]=(m+g)*w,s[7]=0,s[8]=(p+x)*b,s[9]=(m-g)*b,s[10]=(1-(c+f))*b,s[11]=0,s[12]=t.x,s[13]=t.y,s[14]=t.z,s[15]=1,this},decompose:function(t,i,e){var s=this.elements,r=nt.set(s[0],s[1],s[2]).length(),n=nt.set(s[4],s[5],s[6]).length(),h=nt.set(s[8],s[9],s[10]).length();this.determinant()<0&&(r=-r),t.x=s[12],t.y=s[13],t.z=s[14],ht.copy(this);var a=1/r,o=1/n,u=1/h;return ht.elements[0]*=a,ht.elements[1]*=a,ht.elements[2]*=a,ht.elements[4]*=o,ht.elements[5]*=o,ht.elements[6]*=o,ht.elements[8]*=u,ht.elements[9]*=u,ht.elements[10]*=u,i.setFromRotationMatrix(ht),e.x=r,e.y=n,e.z=h,this},makePerspective:function(t,i,e,s,r,n){var h=this.elements,a=2*r/(i-t),o=2*r/(e-s),u=(i+t)/(i-t),l=(e+s)/(e-s),c=-(n+r)/(n-r),d=-2*n*r/(n-r);return h[0]=a,h[4]=0,h[8]=u,h[12]=0,h[1]=0,h[5]=o,h[9]=l,h[13]=0,h[2]=0,h[6]=0,h[10]=c,h[14]=d,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this},makeOrthographic:function(t,i,e,s,r,n){var h=this.elements,a=1/(i-t),o=1/(e-s),u=1/(n-r),l=(i+t)*a,c=(e+s)*o,d=(n+r)*u;return h[0]=2*a,h[4]=0,h[8]=0,h[12]=-l,h[1]=0,h[5]=2*o,h[9]=0,h[13]=-c,h[2]=0,h[6]=0,h[10]=-2*u,h[14]=-d,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this},equals:function(t){for(var i=this.elements,e=t.elements,s=0;s<16;s++)if(i[s]!==e[s])return!1;return!0},fromArray:function(t,i){void 0===i&&(i=0);for(var e=0;e<16;e++)this.elements[e]=t[e+i];return this},toArray:function(t,i){void 0===t&&(t=[]),void 0===i&&(i=0);var e=this.elements;return t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=e[3],t[i+4]=e[4],t[i+5]=e[5],t[i+6]=e[6],t[i+7]=e[7],t[i+8]=e[8],t[i+9]=e[9],t[i+10]=e[10],t[i+11]=e[11],t[i+12]=e[12],t[i+13]=e[13],t[i+14]=e[14],t[i+15]=e[15],t}});var pt=new dt,ft=new tt;function mt(t,i,e,s){this._x=t||0,this._y=i||0,this._z=e||0,this._order=s||mt.DefaultOrder}mt.RotationOrders=['XYZ','YZX','ZXY','XZY','YXZ','ZYX'],mt.DefaultOrder='XYZ',Object.defineProperties(mt.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(mt.prototype,{isEuler:!0,set:function(t,i,e,s){return this._x=t,this._y=i,this._z=e,this._order=s||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,i,e){var s=J.clamp,r=t.elements,n=r[0],h=r[4],a=r[8],o=r[1],u=r[5],l=r[9],c=r[2],d=r[6],p=r[10];return'XYZ'===(i=i||this._order)?(this._y=Math.asin(s(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-l,p),this._z=Math.atan2(-h,n)):(this._x=Math.atan2(d,u),this._z=0)):'YXZ'===i?(this._x=Math.asin(-s(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(a,p),this._z=Math.atan2(o,u)):(this._y=Math.atan2(-c,n),this._z=0)):'ZXY'===i?(this._x=Math.asin(s(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-c,p),this._z=Math.atan2(-h,u)):(this._y=0,this._z=Math.atan2(o,n))):'ZYX'===i?(this._y=Math.asin(-s(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(o,n)):(this._x=0,this._z=Math.atan2(-h,u))):'YZX'===i?(this._z=Math.asin(s(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-l,u),this._y=Math.atan2(-c,n)):(this._x=0,this._y=Math.atan2(a,p))):'XZY'===i&&(this._z=Math.asin(-s(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(a,n)):(this._x=Math.atan2(-l,p),this._y=0)),this._order=i,!1!==e&&this._onChangeCallback(),this},setFromQuaternion:function(t,i,e){return pt.makeRotationFromQuaternion(t),this.setFromRotationMatrix(pt,i,e)},setFromVector3:function(t,i){return this.set(t.x,t.y,t.z,i||this._order)},reorder:function(t){return ft.setFromEuler(this),this.setFromQuaternion(ft,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new st(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var yt=new st;function gt(){this.elements=[1,0,0,0,1,0,0,0,1]}Object.assign(gt.prototype,{isMatrix3:!0,set:function(t,i,e,s,r,n,h,a,o){var u=this.elements;return u[0]=t,u[1]=s,u[2]=h,u[3]=i,u[4]=r,u[5]=a,u[6]=e,u[7]=n,u[8]=o,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var i=this.elements,e=t.elements;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],this},setFromMatrix4:function(t){var i=t.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this},applyToBufferAttribute:function(t){for(var i=0,e=t.count;i<e;i++)yt.x=t.getX(i),yt.y=t.getY(i),yt.z=t.getZ(i),yt.applyMatrix3(this),t.setXYZ(i,yt.x,yt.y,yt.z);return t},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,i){var e=t.elements,s=i.elements,r=this.elements,n=e[0],h=e[3],a=e[6],o=e[1],u=e[4],l=e[7],c=e[2],d=e[5],p=e[8],f=s[0],m=s[3],y=s[6],g=s[1],x=s[4],v=s[7],_=s[2],w=s[5],b=s[8];return r[0]=n*f+h*g+a*_,r[3]=n*m+h*x+a*w,r[6]=n*y+h*v+a*b,r[1]=o*f+u*g+l*_,r[4]=o*m+u*x+l*w,r[7]=o*y+u*v+l*b,r[2]=c*f+d*g+p*_,r[5]=c*m+d*x+p*w,r[8]=c*y+d*v+p*b,this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=t,i[4]*=t,i[7]*=t,i[2]*=t,i[5]*=t,i[8]*=t,this},determinant:function(){var t=this.elements,i=t[0],e=t[1],s=t[2],r=t[3],n=t[4],h=t[5],a=t[6],o=t[7],u=t[8];return i*n*u-i*h*o-e*r*u+e*h*a+s*r*o-s*n*a},getInverse:function(t,i){t&&t.isMatrix4;var e=t.elements,s=this.elements,r=e[0],n=e[1],h=e[2],a=e[3],o=e[4],u=e[5],l=e[6],c=e[7],d=e[8],p=d*o-u*c,f=u*l-d*a,m=c*a-o*l,y=r*p+n*f+h*m;if(0===y){if(!0===i)throw new Error("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");return this.identity()}var g=1/y;return s[0]=p*g,s[1]=(h*c-d*n)*g,s[2]=(u*n-h*o)*g,s[3]=f*g,s[4]=(d*r-h*l)*g,s[5]=(h*a-u*r)*g,s[6]=m*g,s[7]=(n*l-c*r)*g,s[8]=(o*r-n*a)*g,this},transpose:function(){var t,i=this.elements;return t=i[1],i[1]=i[3],i[3]=t,t=i[2],i[2]=i[6],i[6]=t,t=i[5],i[5]=i[7],i[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var i=this.elements;return t[0]=i[0],t[1]=i[3],t[2]=i[6],t[3]=i[1],t[4]=i[4],t[5]=i[7],t[6]=i[2],t[7]=i[5],t[8]=i[8],this},setUvTransform:function(t,i,e,s,r,n,h){var a=Math.cos(r),o=Math.sin(r);this.set(e*a,e*o,-e*(a*n+o*h)+n+t,-s*o,s*a,-s*(-o*n+a*h)+h+i,0,0,1)},scale:function(t,i){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=i,e[4]*=i,e[7]*=i,this},rotate:function(t){var i=Math.cos(t),e=Math.sin(t),s=this.elements,r=s[0],n=s[3],h=s[6],a=s[1],o=s[4],u=s[7];return s[0]=i*r+e*a,s[3]=i*n+e*o,s[6]=i*h+e*u,s[1]=-e*r+i*a,s[4]=-e*n+i*o,s[7]=-e*h+i*u,this},translate:function(t,i){var e=this.elements;return e[0]+=t*e[2],e[3]+=t*e[5],e[6]+=t*e[8],e[1]+=i*e[2],e[4]+=i*e[5],e[7]+=i*e[8],this},equals:function(t){for(var i=this.elements,e=t.elements,s=0;s<9;s++)if(i[s]!==e[s])return!1;return!0},fromArray:function(t,i){void 0===i&&(i=0);for(var e=0;e<9;e++)this.elements[e]=t[e+i];return this},toArray:function(t,i){void 0===t&&(t=[]),void 0===i&&(i=0);var e=this.elements;return t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=e[3],t[i+4]=e[4],t[i+5]=e[5],t[i+6]=e[6],t[i+7]=e[7],t[i+8]=e[8],t}});var xt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},vt={h:0,s:0,l:0},_t={h:0,s:0,l:0};function wt(t,i,e){return void 0===i&&void 0===e?this.set(t):this.setRGB(t,i,e)}function bt(t,i,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+6*(i-t)*e:e<.5?i:e<2/3?t+6*(i-t)*(2/3-e):t}function Mt(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Tt(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}Object.assign(wt.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):'number'==typeof t?this.setHex(t):'string'==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,i,e){return this.r=t,this.g=i,this.b=e,this},setHSL:function(t,i,e){if(t=J.euclideanModulo(t,1),i=J.clamp(i,0,1),e=J.clamp(e,0,1),0===i)this.r=this.g=this.b=e;else{var s=e<=.5?e*(1+i):e+i-e*i,r=2*e-s;this.r=bt(r,s,t+1/3),this.g=bt(r,s,t),this.b=bt(r,s,t-1/3)}return this},setStyle:function(t){function i(t){void 0!==t&&parseFloat(t)}var e;if(e=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var s,r=e[1],n=e[2];switch(r){case'rgb':case'rgba':if(s=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,i(s[5]),this;if(s=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,i(s[5]),this;break;case'hsl':case'hsla':if(s=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n)){var h=parseFloat(s[1])/360,a=parseInt(s[2],10)/100,o=parseInt(s[3],10)/100;return i(s[5]),this.setHSL(h,a,o)}}}else if(e=/^\#([A-Fa-f0-9]+)$/.exec(t)){var u=e[1],l=u.length;if(3===l)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},setColorName:function(t){var i=xt[t];return void 0!==i&&this.setHex(i),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,i){return void 0===i&&(i=2),this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this},copyLinearToGamma:function(t,i){void 0===i&&(i=2);var e=i>0?1/i:1;return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=Mt(t.r),this.g=Mt(t.g),this.b=Mt(t.b),this},copyLinearToSRGB:function(t){return this.r=Tt(t.r),this.g=Tt(t.g),this.b=Tt(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return('000000'+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(t={h:0,s:0,l:0});var i,e,s=this.r,r=this.g,n=this.b,h=Math.max(s,r,n),a=Math.min(s,r,n),o=(a+h)/2;if(a===h)i=0,e=0;else{var u=h-a;switch(e=o<=.5?u/(h+a):u/(2-h-a),h){case s:i=(r-n)/u+(r<n?6:0);break;case r:i=(n-s)/u+2;break;case n:i=(s-r)/u+4}i/=6}return t.h=i,t.s=e,t.l=o,t},getStyle:function(){return'rgb('+(255*this.r|0)+','+(255*this.g|0)+','+(255*this.b|0)+')'},offsetHSL:function(t,i,e){return this.getHSL(vt),vt.h+=t,vt.s+=i,vt.l+=e,this.setHSL(vt.h,vt.s,vt.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this},lerpHSL:function(t,i){this.getHSL(vt),t.getHSL(_t);var e=J.lerp(vt.h,_t.h,i),s=J.lerp(vt.s,_t.s,i),r=J.lerp(vt.l,_t.l,i);return this.setHSL(e,s,r),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,i){return void 0===i&&(i=0),this.r=t[i],this.g=t[i+1],this.b=t[i+2],this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t},toJSON:function(){return this.getHex()}}),wt.WHITE=new wt(1,1,1),wt.NAMES=xt,Tiny.Color=wt;const At=new Uint8Array(4);function Ct(t){return 0==(t&t-1)}let St=1;class zt{constructor(t,{image:i,target:e=t.TEXTURE_2D,type:s=t.UNSIGNED_BYTE,format:r=t.RGBA,internalFormat:n=r,wrapS:h=t.CLAMP_TO_EDGE,wrapT:a=t.CLAMP_TO_EDGE,generateMipmaps:o=!0,minFilter:u=(o?t.NEAREST_MIPMAP_LINEAR:t.LINEAR),magFilter:l=t.LINEAR,premultiplyAlpha:c=!1,unpackAlignment:d=4,flipY:p=e==t.TEXTURE_2D,anisotropy:f=0,level:m=0,width:y,height:g=y}={}){this.gl=t,this.id=St++,this.image=i,this.target=e,this.type=s,this.format=r,this.internalFormat=n,this.minFilter=u,this.magFilter=l,this.wrapS=h,this.wrapT=a,this.generateMipmaps=o,this.premultiplyAlpha=c,this.unpackAlignment=d,this.flipY=p,this.anisotropy=Math.min(f,this.gl.renderer.parameters.maxAnisotropy),this.level=m,this.width=y,this.height=g,this.texture=this.gl.createTexture(),this.store={image:null},this.glState=this.gl.renderer.state,this.state={},this.state.minFilter=this.gl.NEAREST_MIPMAP_LINEAR,this.state.magFilter=this.gl.LINEAR,this.state.wrapS=this.gl.REPEAT,this.state.wrapT=this.gl.REPEAT,this.state.anisotropy=0}bind(){this.glState.textureUnits[this.glState.activeTextureUnit]!==this.id&&(this.gl.bindTexture(this.target,this.texture),this.glState.textureUnits[this.glState.activeTextureUnit]=this.id)}update(t=0){const i=!(this.image===this.store.image&&!this.needsUpdate);if((i||this.glState.textureUnits[t]!==this.id)&&(this.gl.renderer.activeTexture(t),this.bind()),i){if(this.needsUpdate=!1,this.flipY!==this.glState.flipY&&(this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,this.flipY),this.glState.flipY=this.flipY),this.premultiplyAlpha!==this.glState.premultiplyAlpha&&(this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),this.glState.premultiplyAlpha=this.premultiplyAlpha),this.unpackAlignment!==this.glState.unpackAlignment&&(this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,this.unpackAlignment),this.glState.unpackAlignment=this.unpackAlignment),this.minFilter!==this.state.minFilter&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_MIN_FILTER,this.minFilter),this.state.minFilter=this.minFilter),this.magFilter!==this.state.magFilter&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_MAG_FILTER,this.magFilter),this.state.magFilter=this.magFilter),this.wrapS!==this.state.wrapS&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_S,this.wrapS),this.state.wrapS=this.wrapS),this.wrapT!==this.state.wrapT&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_T,this.wrapT),this.state.wrapT=this.wrapT),this.anisotropy&&this.anisotropy!==this.state.anisotropy&&(this.gl.texParameterf(this.target,this.gl.renderer.getExtension('EXT_texture_filter_anisotropic').TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropy),this.state.anisotropy=this.anisotropy),this.image){if(this.image.width&&(this.width=this.image.width,this.height=this.image.height),this.target===this.gl.TEXTURE_CUBE_MAP)for(let t=0;t<6;t++)this.gl.texImage2D(this.gl.TEXTURE_CUBE_MAP_POSITIVE_X+t,this.level,this.internalFormat,this.format,this.type,this.image[t]);else if(ArrayBuffer.isView(this.image))this.gl.texImage2D(this.target,this.level,this.internalFormat,this.width,this.height,0,this.format,this.type,this.image);else if(this.image.isCompressedTexture)for(let t=0;t<this.image.length;t++)this.gl.compressedTexImage2D(this.target,t,this.internalFormat,this.image[t].width,this.image[t].height,0,this.image[t].data);else this.gl.texImage2D(this.target,this.level,this.internalFormat,this.format,this.type,this.image);this.generateMipmaps&&(this.gl.renderer.isWebgl2||Ct(this.image.width)&&Ct(this.image.height)?this.gl.generateMipmap(this.target):(this.generateMipmaps=!1,this.wrapS=this.wrapT=this.gl.CLAMP_TO_EDGE,this.minFilter=this.gl.LINEAR)),this.onUpdate&&this.onUpdate()}else if(this.target===this.gl.TEXTURE_CUBE_MAP)for(let t=0;t<6;t++)this.gl.texImage2D(this.gl.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,At);else this.width?this.gl.texImage2D(this.target,this.level,this.internalFormat,this.width,this.height,0,this.format,this.type,null):this.gl.texImage2D(this.target,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,At);this.store.image=this.image}}}const Et=new st;let Pt=1;Tiny.WebGLRenderer=class{constructor({canvas:t=document.createElement('canvas'),width:i=300,height:e=150,dpr:s=1,alpha:r=!1,depth:n=!0,stencil:h=!0,antialias:a=!1,premultipliedAlpha:o=!1,preserveDrawingBuffer:u=!0,powerPreference:l="default",autoClear:c=!0,webgl:d=2}={}){const p={alpha:r,depth:n,stencil:h,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:u,powerPreference:l};this.dpr=s,this.alpha=r,this.color=!0,this.depth=n,this.stencil=h,this.premultipliedAlpha=o,this.autoClear=c,this.id=Pt++,this.domElement=t,2===d&&(this.gl=t.getContext('webgl2',p)),this.isWebgl2=!!this.gl,this.gl||(this.gl=t.getContext('webgl',p)),this.gl,this.gl.renderer=this,this.resize(i,e),this.state={},this.state.blendFunc={src:this.gl.ONE,dst:this.gl.ZERO},this.state.blendEquation={modeRGB:this.gl.FUNC_ADD},this.state.cullFace=null,this.state.frontFace=this.gl.CCW,this.state.depthMask=!0,this.state.depthFunc=this.gl.LESS,this.state.premultiplyAlpha=!1,this.state.flipY=!1,this.state.unpackAlignment=4,this.state.framebuffer=null,this.state.viewport={x:0,y:0,width:null,height:null},this.state.textureUnits=[],this.state.activeTextureUnit=0,this.state.boundBuffer=null,this.state.uniformLocations=new Map,this.state.currentProgram=null,this.extensions={},this.isWebgl2?(this.getExtension('EXT_color_buffer_float'),this.getExtension('OES_texture_float_linear')):(this.getExtension('OES_texture_float'),this.getExtension('OES_texture_float_linear'),this.getExtension('OES_texture_half_float'),this.getExtension('OES_texture_half_float_linear'),this.getExtension('OES_element_index_uint'),this.getExtension('OES_standard_derivatives'),this.getExtension('EXT_sRGB'),this.getExtension('WEBGL_depth_texture'),this.getExtension('WEBGL_draw_buffers')),this.getExtension('WEBGL_compressed_texture_astc'),this.getExtension('EXT_texture_compression_bptc'),this.getExtension('WEBGL_compressed_texture_s3tc'),this.getExtension('WEBGL_compressed_texture_etc1'),this.getExtension('WEBGL_compressed_texture_pvrtc'),this.getExtension('WEBKIT_WEBGL_compressed_texture_pvrtc'),this.vertexAttribDivisor=this.getExtension('ANGLE_instanced_arrays','vertexAttribDivisor','vertexAttribDivisorANGLE'),this.drawArraysInstanced=this.getExtension('ANGLE_instanced_arrays','drawArraysInstanced','drawArraysInstancedANGLE'),this.drawElementsInstanced=this.getExtension('ANGLE_instanced_arrays','drawElementsInstanced','drawElementsInstancedANGLE'),this.createVertexArray=this.getExtension('OES_vertex_array_object','createVertexArray','createVertexArrayOES'),this.bindVertexArray=this.getExtension('OES_vertex_array_object','bindVertexArray','bindVertexArrayOES'),this.deleteVertexArray=this.getExtension('OES_vertex_array_object','deleteVertexArray','deleteVertexArrayOES'),this.drawBuffers=this.getExtension('WEBGL_draw_buffers','drawBuffers','drawBuffersWEBGL'),this.parameters={},this.parameters.maxTextureUnits=this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.parameters.maxAnisotropy=this.getExtension('EXT_texture_filter_anisotropic')?this.gl.getParameter(this.getExtension('EXT_texture_filter_anisotropic').MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,zt.WHITE=new zt(this.gl,{image:new Uint8Array([255,255,255,255]),width:1,height:1})}setClearColor(t,i){this.gl.clearColor(t.r,t.g,t.b,i)}setPixelRatio(t){this.dpr=t,this.resize(this.width,this.height)}resize(t,i){this.width=t,this.height=i,this.gl.canvas.width=t*this.dpr,this.gl.canvas.height=i*this.dpr,this.gl.canvas.style&&Object.assign(this.gl.canvas.style,{width:t+'px',height:i+'px'})}setViewport(t,i,e=0,s=0){this.state.viewport.width===t&&this.state.viewport.height===i||(this.state.viewport.width=t,this.state.viewport.height=i,this.state.viewport.x=e,this.state.viewport.y=s,this.gl.viewport(e,s,t,i))}setScissor(t,i,e=0,s=0){this.gl.scissor(e,s,t,i)}enable(t){!0!==this.state[t]&&(this.gl.enable(t),this.state[t]=!0)}disable(t){!1!==this.state[t]&&(this.gl.disable(t),this.state[t]=!1)}setBlendFunc(t,i,e,s){this.state.blendFunc.src===t&&this.state.blendFunc.dst===i&&this.state.blendFunc.srcAlpha===e&&this.state.blendFunc.dstAlpha===s||(this.state.blendFunc.src=t,this.state.blendFunc.dst=i,this.state.blendFunc.srcAlpha=e,this.state.blendFunc.dstAlpha=s,void 0!==e?this.gl.blendFuncSeparate(t,i,e,s):this.gl.blendFunc(t,i))}setBlendEquation(t,i){t=t||this.gl.FUNC_ADD,this.state.blendEquation.modeRGB===t&&this.state.blendEquation.modeAlpha===i||(this.state.blendEquation.modeRGB=t,this.state.blendEquation.modeAlpha=i,void 0!==i?this.gl.blendEquationSeparate(t,i):this.gl.blendEquation(t))}setCullFace(t){this.state.cullFace!==t&&(this.state.cullFace=t,this.gl.cullFace(t))}setFrontFace(t){this.state.frontFace!==t&&(this.state.frontFace=t,this.gl.frontFace(t))}setDepthMask(t){this.state.depthMask!==t&&(this.state.depthMask=t,this.gl.depthMask(t))}setDepthFunc(t){this.state.depthFunc!==t&&(this.state.depthFunc=t,this.gl.depthFunc(t))}activeTexture(t){this.state.activeTextureUnit!==t&&(this.state.activeTextureUnit=t,this.gl.activeTexture(this.gl.TEXTURE0+t))}bindFramebuffer({target:t=this.gl.FRAMEBUFFER,buffer:i=null}={}){this.state.framebuffer!==i&&(this.state.framebuffer=i,this.gl.bindFramebuffer(t,i))}getExtension(t,i,e){return i&&this.gl[i]?this.gl[i].bind(this.gl):(this.extensions[t]||(this.extensions[t]=this.gl.getExtension(t)),i?this.extensions[t]?this.extensions[t][e].bind(this.extensions[t]):null:this.extensions[t])}sortOpaque(t,i){return t.renderOrder!==i.renderOrder?t.renderOrder-i.renderOrder:t.program.id!==i.program.id?t.program.id-i.program.id:t.zDepth!==i.zDepth?t.zDepth-i.zDepth:i.id-t.id}sortTransparent(t,i){return t.renderOrder!==i.renderOrder?t.renderOrder-i.renderOrder:t.zDepth!==i.zDepth?i.zDepth-t.zDepth:i.id-t.id}sortUI(t,i){return t.renderOrder!==i.renderOrder?t.renderOrder-i.renderOrder:t.program.id!==i.program.id?t.program.id-i.program.id:i.id-t.id}getRenderList({scene:t,camera:i,frustumCull:e,sort:s}){let r=[];if(i&&e&&i.updateFrustum(),t.traverse((t=>{if(!t.visible)return!0;t.draw&&(e&&t.frustumCulled&&i&&!i.frustumIntersectsMesh(t)||r.push(t))})),s){const t=[],e=[],s=[];r.forEach((r=>{r.program.transparent?r.program.depthTest?e.push(r):s.push(r):t.push(r),r.zDepth=0,0===r.renderOrder&&r.program.depthTest&&i&&(Et.set(r.worldMatrix.elements[12],r.worldMatrix.elements[13],r.worldMatrix.elements[14]),Et.applyMatrix4(i.projectionViewMatrix),r.zDepth=Et.z)})),t.sort(this.sortOpaque),e.sort(this.sortTransparent),s.sort(this.sortUI),r=t.concat(e,s)}return r}render({scene:t,camera:i,directionalLight:e,ambientLight:s,target:r=null,update:n=!0,sort:h=!0,frustumCull:a=!0,clear:o}){null===r?(this.bindFramebuffer(),this.setViewport(this.width*this.dpr,this.height*this.dpr)):(this.bindFramebuffer(r),this.setViewport(r.width,r.height)),(o||this.autoClear&&!1!==o)&&(!this.depth||r&&!r.depth||(this.enable(this.gl.DEPTH_TEST),this.setDepthMask(!0)),this.gl.clear((this.color?this.gl.COLOR_BUFFER_BIT:0)|(this.depth?this.gl.DEPTH_BUFFER_BIT:0)|(this.stencil?this.gl.STENCIL_BUFFER_BIT:0))),n&&t.updateMatrixWorld(),i&&i.updateMatrixWorld();this.getRenderList({scene:t,camera:i,frustumCull:a,sort:h}).forEach((t=>{t.geometry.gl||t.geometry.initialize(this.gl),t.program.gl||t.program.initialize(this.gl),t.draw({camera:i,directionalLight:e,ambientLight:s})}))}};new st;var kt=new tt,Ft=new dt,Rt=new st,It=new st;new st,new tt,new st(1,0,0),new st(0,1,0),new st(0,0,1);class Lt{constructor(){this.parent=null,this.children=[],this.visible=!0,this.matrix=new dt,this.worldMatrix=new dt,this.matrixAutoUpdate=!0,this.position=new st,this.quaternion=new tt,this.scale=new st(1,1,1),this.rotation=new mt,this.up=new st(0,1,0),this.rotation._onChange((()=>{this.quaternion.setFromEuler(this.rotation,!1)})),this.quaternion._onChange((()=>{this.rotation.setFromQuaternion(this.quaternion,void 0,!1)}))}clone(t){return(new this.constructor).copy(this,t)}copy(){}getObjectByName(t=""){let i=null;return this.traverse((e=>{e.name===t&&(i=e)})),i}setParent(t,i=!0){this.parent&&t!==this.parent&&this.parent.removeChild(this,!1),this.parent=t,i&&t&&t.add(this,!1)}add(t,i=!0){~this.children.indexOf(t)||this.children.push(t),i&&t.setParent(this,!1)}removeChild(t,i=!0){~this.children.indexOf(t)&&this.children.splice(this.children.indexOf(t),1),i&&t.setParent(null,!1)}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.worldMatrixNeedsUpdate||t)&&(null===this.parent?this.worldMatrix.copy(this.matrix):this.worldMatrix.multiplyMatrices(this.parent.worldMatrix,this.matrix),this.worldMatrixNeedsUpdate=!1,t=!0);for(let i=0,e=this.children.length;i<e;i++)this.children[i].updateMatrixWorld(t)}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.worldMatrixNeedsUpdate=!0}traverse(t){if(!t(this))for(let i=0,e=this.children.length;i<e;i++)this.children[i].traverse(t)}decompose(){this.matrix.getTranslation(this.position),this.matrix.getRotation(this.quaternion),this.matrix.getScaling(this.scale),this.rotation.fromQuaternion(this.quaternion)}lookAt(t,i,e){t.isVector3?Rt.copy(t):Rt.set(t,i,e);var s=this.parent;this.updateMatrixWorld(!0,!1),It.setFromMatrixPosition(this.worldMatrix),this.isCamera||this.isLight?Ft.lookAt(It,Rt,this.up):Ft.lookAt(Rt,It,this.up),this.quaternion.setFromRotationMatrix(Ft),s&&(Ft.extractRotation(s.worldMatrix),kt.setFromRotationMatrix(Ft),this.quaternion.premultiply(kt.inverse()))}}Tiny.Object3D=Lt;let Ot=0;Tiny.Mesh=class extends Lt{constructor(t,i,{mode:e=WebGLRenderingContext.TRIANGLES,frustumCulled:s=!0,renderOrder:r=0}={}){super(),this.id=Ot++,this.geometry=t,this.program=i,this.mode=e,this.frustumCulled=s,this.renderOrder=r,this.modelViewMatrix=new dt,this.normalMatrix=new gt,this.beforeRenderCallbacks=[],this.afterRenderCallbacks=[]}onBeforeRender(t){return this.beforeRenderCallbacks.push(t),this}onAfterRender(t){return this.afterRenderCallbacks.push(t),this}draw({camera:t,directionalLight:i,ambientLight:e}={}){t&&(this.program.uniforms.modelMatrix||Object.assign(this.program.uniforms,{modelMatrix:{value:null},viewMatrix:{value:null},modelViewMatrix:{value:null},normalMatrix:{value:null},projectionMatrix:{value:null},cameraPosition:{value:null},directionalLightColor:{value:[0,0,0,0]},directionalLightDirection:{value:[0,0,0]},ambientLightColor:{value:[0,0,0,0]}}),this.program.uniforms.projectionMatrix.value=t.projectionMatrix.elements,this.program.uniforms.cameraPosition.value=t.worldPosition.toArray(),this.program.uniforms.viewMatrix.value=t.viewMatrix.elements,this.modelViewMatrix.multiplyMatrices(t.viewMatrix,this.worldMatrix),this.normalMatrix.getNormalMatrix(this.modelViewMatrix),this.program.uniforms.modelMatrix.value=this.worldMatrix.elements,this.program.uniforms.modelViewMatrix.value=this.modelViewMatrix.elements,this.program.uniforms.normalMatrix.value=this.normalMatrix.elements,e&&(this.program.uniforms.ambientLightColor.value=[e.color.r,e.color.g,e.color.b,e.visible?e.intensity:0]),i&&(this.program.uniforms.directionalLightColor.value=[i.color.r,i.color.g,i.color.b,i.visible?i.intensity:0],this.program.uniforms.directionalLightDirection.value=i.position.toArray())),this.beforeRenderCallbacks.forEach((i=>i&&i({mesh:this,camera:t})));let s=this.program.cullFace&&this.worldMatrix.determinant()<0;this.program.use({flipFaces:s}),this.geometry.draw({mode:this.mode,program:this.program}),this.afterRenderCallbacks.forEach((i=>i&&i({mesh:this,camera:t})))}};let Bt=1;const Dt={};class Ut{constructor({vertex:t,fragment:i,uniforms:e={},transparent:s=!1,cullFace:r=WebGLRenderingContext.BACK,frontFace:n=WebGLRenderingContext.CCW,depthTest:h=!0,depthWrite:a=!0,depthFunc:o=WebGLRenderingContext.LESS}={}){this.uniforms=e,this.id=Bt++,this.vertex=t,this.fragment=i,this.transparent=s,this.cullFace=r,this.frontFace=n,this.depthTest=h,this.depthWrite=a,this.depthFunc=o,this.blendFunc={},this.blendEquation={}}initialize(t){const{vertex:i,fragment:e}=this;this.gl=t,this.transparent&&!this.blendFunc.src&&(this.gl.renderer.premultipliedAlpha?this.setBlendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA):this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA));const s=t.createShader(t.VERTEX_SHADER);t.shaderSource(s,i),t.compileShader(s),t.getShaderInfoLog(s);const r=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(r,e),t.compileShader(r),t.getShaderInfoLog(r),this.program=t.createProgram(),t.attachShader(this.program,s),t.attachShader(this.program,r),t.linkProgram(this.program),!t.getProgramParameter(this.program,t.LINK_STATUS))return;t.deleteShader(s),t.deleteShader(r),this.uniformLocations=new Map;let n=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS);for(let i=0;i<n;i++){let e=t.getActiveUniform(this.program,i);this.uniformLocations.set(e,t.getUniformLocation(this.program,e.name));const s=e.name.match(/(\w+)/g);e.uniformName=s[0],e.nameComponents=s.slice(1)}this.attributeLocations=new Map;const h=[],a=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES);for(let i=0;i<a;i++){const e=t.getActiveAttrib(this.program,i),s=t.getAttribLocation(this.program,e.name);-1!==s&&(h[s]=e.name,this.attributeLocations.set(e,s))}this.attributeOrder=h.join('')}setBlendFunc(t,i,e,s){this.blendFunc.src=t,this.blendFunc.dst=i,this.blendFunc.srcAlpha=e,this.blendFunc.dstAlpha=s,t&&(this.transparent=!0)}setBlendEquation(t,i){this.blendEquation.modeRGB=t,this.blendEquation.modeAlpha=i}applyState(){this.depthTest?this.gl.renderer.enable(this.gl.DEPTH_TEST):this.gl.renderer.disable(this.gl.DEPTH_TEST),this.cullFace?this.gl.renderer.enable(this.gl.CULL_FACE):this.gl.renderer.disable(this.gl.CULL_FACE),this.blendFunc.src?this.gl.renderer.enable(this.gl.BLEND):this.gl.renderer.disable(this.gl.BLEND),this.cullFace&&this.gl.renderer.setCullFace(this.cullFace),this.gl.renderer.setFrontFace(this.frontFace),this.gl.renderer.setDepthMask(this.depthWrite),this.gl.renderer.setDepthFunc(this.depthFunc),this.blendFunc.src&&this.gl.renderer.setBlendFunc(this.blendFunc.src,this.blendFunc.dst,this.blendFunc.srcAlpha,this.blendFunc.dstAlpha),this.gl.renderer.setBlendEquation(this.blendEquation.modeRGB,this.blendEquation.modeAlpha)}use({flipFaces:t=!1}={}){let i=-1;this.gl.renderer.state.currentProgram===this.id||(this.gl.useProgram(this.program),this.gl.renderer.state.currentProgram=this.id),this.uniformLocations.forEach(((t,e)=>{let s=this.uniforms[e.uniformName];for(const t of e.nameComponents){if(!s)break;if(!(t in s)){if(Array.isArray(s.value))break;s=void 0;break}s=s[t]}return s?s&&void 0===s.value?qt(`${e.name} uniform is missing a value parameter`):s.value.texture?(i+=1,s.value.update(i),jt(this.gl,e.type,t,i)):(e.name,void jt(this.gl,e.type,t,s.value)):qt(`Active uniform ${e.name} has not been supplied`)})),this.applyState(),t&&this.gl.renderer.setFrontFace(this.frontFace===this.gl.CCW?this.gl.CW:this.gl.CCW)}remove(){this.gl.deleteProgram(this.program)}}function jt(t,i,e,s){s=Array.isArray(s)?function(t){const i=t.length,e=t[0].length;if(void 0===e)return t;const s=i*e;let r=Dt[s];r||(Dt[s]=r=new Float32Array(s));for(let s=0;s<i;s++)r.set(t[s],s*e);return r}(s):s;const r=t.renderer.state.uniformLocations.get(e);if(Array.isArray(s))if(void 0===r||r.length!==s.length)t.renderer.state.uniformLocations.set(e,s.slice(0));else{if(function(t,i){if(t.length!==i.length)return!1;for(let e=0,s=t.length;e<s;e++)if(t[e]!==i[e])return!1;return!0}(r,s))return;r.set?r.set(s):function(t,i){for(let e=0,s=t.length;e<s;e++)t[e]=i[e]}(r,s),t.renderer.state.uniformLocations.set(e,r)}else{if(r===s)return;t.renderer.state.uniformLocations.set(e,s)}switch(i){case 5126:return Array.isArray(s)?t.uniform1fv(e,s):t.uniform1f(e,s);case 35664:return t.uniform2fv(e,s);case 35665:return t.uniform3fv(e,s);case 35666:return t.uniform4fv(e,s);case 35670:case 5124:case 35678:case 35680:return Array.isArray(s)?t.uniform1iv(e,s):t.uniform1i(e,s);case 35671:case 35667:return t.uniform2iv(e,s);case 35672:case 35668:return t.uniform3iv(e,s);case 35673:case 35669:return t.uniform4iv(e,s);case 35674:return t.uniformMatrix2fv(e,!1,s);case 35675:return t.uniformMatrix3fv(e,!1,s);case 35676:return t.uniformMatrix4fv(e,!1,s)}}let Wt=0;function qt(t){Wt>100||Wt++}Tiny.Material=Ut;class Vt{constructor(t){Object.assign(this,t)}getX(t){return this.data[t*this.size]}getY(t){return this.data[t*this.size+1]}getZ(t){return this.data[t*this.size+2]}setXYZ(t,i,e,s){const{data:r,size:n}=this;return r[(t*=n)+0]=i,r[t+1]=e,r[t+2]=s,this}}const Gt=new st;let Nt=1,Xt=1,Ht=!1;class Yt{constructor(t={}){this.attributes=t,this.id=Nt++,this.VAOs={},this.drawRange={start:0,count:0},this.instancedCount=0}initialize(t){const{attributes:i}=this;this.gl=t,this.gl.renderer.bindVertexArray(null),this.gl.renderer.currentGeometry=null,this.glState=this.gl.renderer.state;for(let t in i)this.addAttribute(t,i[t])}addAttribute(t,i){if((i=this.attributes[t]=new Vt(i)).id=Xt++,i.size=i.size||1,i.type=i.type||(i.data.constructor===Float32Array?this.gl.FLOAT:i.data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT),i.target='index'===t?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,i.normalized=i.normalized||!1,i.stride=i.stride||0,i.offset=i.offset||0,i.count=i.count||(i.stride?i.data.byteLength/i.stride:i.data.length/i.size),i.divisor=i.instanced||0,i.needsUpdate=!1,i.usage=i.usage||this.gl.STATIC_DRAW,i.buffer||this.updateAttribute(i),i.divisor){if(this.isInstanced=!0,this.instancedCount&&this.instancedCount!==i.count*i.divisor)return this.instancedCount=Math.min(this.instancedCount,i.count*i.divisor);this.instancedCount=i.count*i.divisor}else'index'===t?this.drawRange.count=i.count:this.attributes.index||(this.drawRange.count=Math.max(this.drawRange.count,i.count));return i}updateAttribute(t){const i=!t.buffer;i&&(t.buffer=this.gl.createBuffer()),this.glState.boundBuffer!==t.buffer&&(this.gl.bindBuffer(t.target,t.buffer),this.glState.boundBuffer=t.buffer),i?this.gl.bufferData(t.target,t.data,t.usage):this.gl.bufferSubData(t.target,0,t.data),t.needsUpdate=!1}setIndex(t){this.addAttribute('index',t)}setDrawRange(t,i){this.drawRange.start=t,this.drawRange.count=i}setInstancedCount(t){this.instancedCount=t}createVAO(t){this.VAOs[t.attributeOrder]=this.gl.renderer.createVertexArray(),this.gl.renderer.bindVertexArray(this.VAOs[t.attributeOrder]),this.bindAttributes(t)}bindAttributes(t){t.attributeLocations.forEach(((t,{name:i,type:e})=>{if(!this.attributes[i])return;const s=this.attributes[i];this.gl.bindBuffer(s.target,s.buffer),this.glState.boundBuffer=s.buffer;let r=1;35674===e&&(r=2),35675===e&&(r=3),35676===e&&(r=4);const n=s.size/r,h=1===r?0:r*r*4,a=1===r?0:4*r;for(let i=0;i<r;i++)this.gl.vertexAttribPointer(t+i,n,s.type,s.normalized,s.stride+h,s.offset+i*a),this.gl.enableVertexAttribArray(t+i),this.gl.renderer.vertexAttribDivisor(t+i,s.divisor)})),this.attributes.index&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.attributes.index.buffer)}draw({program:t,mode:i=WebGLRenderingContext.TRIANGLES}){this.gl.renderer.currentGeometry!==`${this.id}_${t.attributeOrder}`&&(this.VAOs[t.attributeOrder]||this.createVAO(t),this.gl.renderer.bindVertexArray(this.VAOs[t.attributeOrder]),this.gl.renderer.currentGeometry=`${this.id}_${t.attributeOrder}`),t.attributeLocations.forEach(((t,{name:i})=>{const e=this.attributes[i];e.needsUpdate&&this.updateAttribute(e)}));let e=2;this.attributes.index?.type===this.gl.UNSIGNED_INT&&(e=4),this.isInstanced?this.attributes.index?this.gl.renderer.drawElementsInstanced(i,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*e,this.instancedCount):this.gl.renderer.drawArraysInstanced(i,this.drawRange.start,this.drawRange.count,this.instancedCount):this.attributes.index?this.gl.drawElements(i,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*e):this.gl.drawArrays(i,this.drawRange.start,this.drawRange.count)}getPosition(){const t=this.attributes.position;return t.data?t:Ht?void 0:Ht=!0}computeBoundingBox(t){t||(t=this.getPosition());const i=t.data,e=t.size;this.bounds||(this.bounds={min:new st,max:new st,center:new st,scale:new st,radius:1/0});const s=this.bounds.min,r=this.bounds.max,n=this.bounds.center,h=this.bounds.scale;s.set(1/0),r.set(-1/0);for(let t=0,n=i.length;t<n;t+=e){const e=i[t],n=i[t+1],h=i[t+2];s.x=Math.min(e,s.x),s.y=Math.min(n,s.y),s.z=Math.min(h,s.z),r.x=Math.max(e,r.x),r.y=Math.max(n,r.y),r.z=Math.max(h,r.z)}h.subVectors(r,s),n.subVectors(s,r).divideScalar(2)}computeBoundingSphere(t){t||(t=this.getPosition());const i=t.data,e=t.size;this.bounds||this.computeBoundingBox(t);let s=0;for(let t=0,r=i.length;t<r;t+=e)Gt.fromArray(i,t),s=Math.max(s,this.bounds.center.distanceToSquared(Gt));this.bounds.radius=Math.sqrt(s)}computeVertexNormals(){const t=this.attributes.index,i=this.attributes.position;if(void 0!==i){let e=this.attributes.normal;void 0===e&&(e=this.addAttribute('normal',{size:3,data:new Float32Array(3*i.count)}));const s=new st,r=new st,n=new st,h=new st,a=new st,o=new st,u=new st,l=new st;if(t)for(let c=0,d=t.count;c<d;c+=3){const d=t.getX(c),p=t.getX(c+1),f=t.getX(c+2);s.fromBufferAttribute(i,d),r.fromBufferAttribute(i,p),n.fromBufferAttribute(i,f),u.subVectors(n,r),l.subVectors(s,r),u.cross(l),h.fromBufferAttribute(e,d),a.fromBufferAttribute(e,p),o.fromBufferAttribute(e,f),h.add(u),a.add(u),o.add(u),e.setXYZ(d,h.x,h.y,h.z),e.setXYZ(p,a.x,a.y,a.z),e.setXYZ(f,o.x,o.y,o.z)}e.needsUpdate=!0}}remove(){for(let t in this.VAOs)this.gl.renderer.deleteVertexArray(this.VAOs[t]),delete this.VAOs[t];for(let t in this.attributes)this.gl.deleteBuffer(this.attributes[t].buffer),delete this.attributes[t]}}Tiny.Geometry=Yt;class Zt extends Lt{constructor(){super(),this.isCamera=!0}updateProjectionMatrix(){}}Tiny.Camera=Zt;const Qt=new dt,Kt=new st,$t=new st;Tiny.OrthographicCamera=class extends Zt{constructor(t=.1,i=100,e=-1,s=1,r=-1,n=1,h=1){super(),this.isOrthographicCamera=!0,this.near=t,this.far=i,this.left=e,this.right=s,this.bottom=r,this.top=n,this.zoom=h,this.view=null,this.projectionMatrix=new dt,this.viewMatrix=new dt,this.projectionViewMatrix=new dt,this.worldPosition=new st,this.updateProjectionMatrix()}updateProjectionMatrix(){super.updateProjectionMatrix();var t=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),e=(this.right+this.left)/2,s=(this.top+this.bottom)/2,r=e-t,n=e+t,h=s+i,a=s-i;if(null!==this.view&&this.view.enabled){var o=this.zoom/(this.view.width/this.view.fullWidth),u=this.zoom/(this.view.height/this.view.fullHeight),l=(this.right-this.left)/this.view.width,c=(this.top-this.bottom)/this.view.height;n=(r+=l*(this.view.offsetX/o))+l*(this.view.width/o),a=(h-=c*(this.view.offsetY/u))-c*(this.view.height/u)}this.projectionMatrix.makeOrthographic(r,n,h,a,this.near,this.far)}updateMatrixWorld(){return super.updateMatrixWorld(),this.viewMatrix.getInverse(this.worldMatrix),this.projectionViewMatrix.multiplyMatrices(this.projectionMatrix,this.viewMatrix),this}project(t){return t.applyMatrix4(this.viewMatrix),t.applyMatrix4(this.projectionMatrix),this}unproject(t){return t.applyMatrix4(Qt.inverse(this.projectionMatrix)),t.applyMatrix4(this.worldMatrix),this}updateFrustum(){this.frustum||(this.frustum=[new st,new st,new st,new st,new st,new st]);const t=this.projectionViewMatrix.elements;this.frustum[0].set(t[3]-t[0],t[7]-t[4],t[11]-t[8]).constant=t[15]-t[12],this.frustum[1].set(t[3]+t[0],t[7]+t[4],t[11]+t[8]).constant=t[15]+t[12],this.frustum[2].set(t[3]+t[1],t[7]+t[5],t[11]+t[9]).constant=t[15]+t[13],this.frustum[3].set(t[3]-t[1],t[7]-t[5],t[11]-t[9]).constant=t[15]-t[13],this.frustum[4].set(t[3]-t[2],t[7]-t[6],t[11]-t[10]).constant=t[15]-t[14],this.frustum[5].set(t[3]+t[2],t[7]+t[6],t[11]+t[10]).constant=t[15]+t[14];for(let t=0;t<6;t++){const i=1/this.frustum[t].length();this.frustum[t].multiplyScalar(i),this.frustum[t].constant*=i}}frustumIntersectsMesh(t,i=t.worldMatrix){if(!t.geometry.attributes.position)return!0;if(t.geometry.bounds&&t.geometry.bounds.radius!==1/0||t.geometry.computeBoundingSphere(),!t.geometry.bounds)return!0;const e=Kt;e.copy(t.geometry.bounds.center),e.applyMatrix4(i);const s=t.geometry.bounds.radius*i.getMaxScaleOnAxis();return this.frustumIntersectsSphere(e,s)}frustumIntersectsSphere(t,i){const e=$t;for(let s=0;s<6;s++){const r=this.frustum[s];if(e.copy(r).dot(t)+r.constant<-i)return!1}return!0}};new st,new rt,new rt;class Jt extends Yt{constructor(t=1,i=1,e=1,s=1){const r=e,n=s,h=(r+1)*(n+1),a=r*n*6,o=new Float32Array(3*h),u=new Float32Array(3*h),l=new Float32Array(2*h),c=a>65536?new Uint32Array(a):new Uint16Array(a);Jt.buildPlane(o,u,l,c,t,i,0,r,n),super({position:{size:3,data:o},normal:{size:3,data:u},uv:{size:2,data:l},index:{data:c}})}static buildPlane(t,i,e,s,r,n,h,a,o,u=0,l=1,c=2,d=1,p=-1,f=0,m=0){const y=f,g=r/a,x=n/o;for(let v=0;v<=o;v++){let _=v*x-n/2;for(let n=0;n<=a;n++,f++){let x=n*g-r/2;if(t[3*f+u]=x*d,t[3*f+l]=_*p,t[3*f+c]=h/2,i[3*f+u]=0,i[3*f+l]=0,i[3*f+c]=h>=0?1:-1,e[2*f]=n/a,e[2*f+1]=1-v/o,v===o||n===a)continue;let w=y+n+v*(a+1),b=y+n+(v+1)*(a+1),M=y+n+(v+1)*(a+1)+1,T=y+n+v*(a+1)+1;s[6*m]=w,s[6*m+1]=b,s[6*m+2]=T,s[6*m+3]=b,s[6*m+4]=M,s[6*m+5]=T,m++}}}}Tiny.PlaneGeometry=Jt;Tiny.BoxGeometry=class extends Yt{constructor(t=1,i=1,e=1,s=1,r=1,n=1){const h=s,a=r,o=n,u=(h+1)*(a+1)*2+(h+1)*(o+1)*2+(a+1)*(o+1)*2,l=6*(h*a*2+h*o*2+a*o*2),c=new Float32Array(3*u),d=new Float32Array(3*u),p=new Float32Array(2*u),f=u>65536?new Uint32Array(l):new Uint16Array(l);let m=0,y=0;Jt.buildPlane(c,d,p,f,e,i,t,o,a,2,1,0,-1,-1,m,y),m+=(o+1)*(a+1),y+=o*a,Jt.buildPlane(c,d,p,f,e,i,-t,o,a,2,1,0,1,-1,m,y),m+=(o+1)*(a+1),y+=o*a,Jt.buildPlane(c,d,p,f,t,e,i,o,h,0,2,1,1,1,m,y),m+=(h+1)*(o+1),y+=h*o,Jt.buildPlane(c,d,p,f,t,e,-i,o,h,0,2,1,1,-1,m,y),m+=(h+1)*(o+1),y+=h*o,Jt.buildPlane(c,d,p,f,t,i,-e,h,a,0,1,2,-1,-1,m,y),m+=(h+1)*(a+1),y+=h*a,Jt.buildPlane(c,d,p,f,t,i,e,h,a,0,1,2,1,-1,m,y),super({position:{size:3,data:c},normal:{size:3,data:d},uv:{size:2,data:p},index:{data:f}})}};Tiny.MeshBasicMaterial=class extends Ut{constructor({map:t=zt.WHITE,color:i=wt.WHITE,opacity:e=1,transparent:s=!1,cullFace:r=WebGLRenderingContext.BACK,frontFace:n=WebGLRenderingContext.CCW,depthTest:h=!0,depthWrite:a=!0,depthFunc:o=WebGLRenderingContext.LESS}={}){super({vertex:"\n    attribute vec2 uv;\n    attribute vec3 position;\n\n    uniform mat4 modelViewMatrix;\n    uniform mat4 projectionMatrix;\n\n    varying vec2 vUv;\n\n    void main() {\n        vUv = uv;\n        \n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n",fragment:"\n    precision highp float;\n\n    uniform sampler2D uMap;\n    uniform vec3 uColor;\n    uniform float uOpacity;\n\n    varying vec2 vUv;\n\n    void main() {\n        vec4 tex = texture2D(uMap, vUv);\n        \n        gl_FragColor = tex * vec4(uColor, uOpacity);\n    }\n",uniforms:{uMap:{value:t},uColor:{value:i.toArray()},uOpacity:{value:e}},transparent:s,cullFace:r,frontFace:n,depthTest:h,depthWrite:a,depthFunc:o})}};Tiny.MeshLambertMaterial=class extends Ut{constructor(t,{map:i=zt.WHITE,color:e=wt.WHITE,opacity:s=1,transparent:r=!1,cullFace:n=t.BACK,frontFace:h=t.CCW,depthTest:a=!0,depthWrite:o=!0,depthFunc:u=t.LESS}={}){super(t,{vertex:"\n    attribute vec2 uv;\n    attribute vec3 position;\n    attribute vec3 normal;\n\n    uniform mat4 modelViewMatrix;\n    uniform mat4 projectionMatrix;\n    uniform mat3 normalMatrix;\n    uniform mat4 modelMatrix;\n\n    varying vec2 vUv;\n    varying vec3 vNormal;\n\n    void main() {\n        vUv = uv;\n        vNormal = mat3(modelMatrix) * normal;\n        \n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n",fragment:"\n    precision highp float;\n    \n    uniform vec4 ambientLightColor;\n    \n    uniform vec4 directionalLightColor;\n    uniform vec3 directionalLightDirection;\n\n    uniform sampler2D uMap;\n    uniform vec3 uColor;\n\n    varying vec2 vUv;\n    varying vec3 vNormal;\n\n    void main() {\n        vec3 normal = normalize(vNormal);\n        vec3 tex = texture2D(uMap, vUv).rgb;\n        \n        float directional = max(dot(normal, normalize(directionalLightDirection)), 0.0);\n        \n        vec3 directLightColor = directionalLightColor.rgb * directionalLightColor.a * directional;\n        \n        vec3 ambLightColor = ambientLightColor.rgb * ambientLightColor.a;\n        \n        gl_FragColor.rgb = tex * uColor * (ambLightColor + directLightColor);\n        gl_FragColor.a = 1.0;\n    }\n",uniforms:{uColor:{value:e.toArray()},uMap:{value:i},uOpacity:{value:s}},transparent:r,cullFace:n,frontFace:h,depthTest:a,depthWrite:o,depthFunc:u}),this.isMeshLambertMaterial=!0}};Tiny.PointsMaterial=class extends Ut{constructor(t,{map:i=zt.WHITE,color:e=wt.WHITE,opacity:s=1,transparent:r=!1,cullFace:n=t.BACK,frontFace:h=t.CCW,depthTest:a=!0,depthWrite:o=!0,depthFunc:u=t.LESS}={}){super(t,{vertex:"\n    attribute vec3 position;\n    attribute float size;\n\n    uniform mat4 modelViewMatrix;\n    uniform mat4 projectionMatrix;\n\n    void main() {\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        gl_PointSize = size;\n    }\n",fragment:"\n    precision highp float;\n\n    uniform sampler2D uMap;\n    uniform vec3 uColor;\n    uniform float uOpacity;\n    \n    void main() {\n      vec4 tex = texture2D(uMap, gl_PointCoord);\n        \n      gl_FragColor = tex * vec4(uColor, uOpacity);\n    }\n",uniforms:{uMap:{value:i},uColor:{value:e.toArray()},uOpacity:{value:s}},transparent:r,cullFace:n,frontFace:h,depthTest:a,depthWrite:o,depthFunc:u})}};new st,new st,new st,new st,new tt,new tt,new tt,new tt;new dt,new dt;Uint8Array,Int16Array,Uint16Array,Uint32Array,Float32Array,Uint8Array,Uint8Array;var ti=function(t,i,e){e=e||{},this.resolution=null!=e.resolution?e.resolution:1,this.clearBeforeRender=null==e.clearBeforeRender||e.clearBeforeRender,this.transparent=null!=e.transparent&&e.transparent,this.autoResize=e.autoResize||!1,Tiny.defaultRenderer||(Tiny.defaultRenderer=this);var s=this.domElement=e.domElement||document.createElement('canvas');this.context=s.getContext('2d',{alpha:this.transparent}),this.resize(t||800,i||600),this.setClearColor('#ffffff'),Tiny.CanvasMaskManager&&(this.maskManager=new Tiny.CanvasMaskManager),this.renderSession={context:this.context,maskManager:this.maskManager,smoothProperty:null,roundPixels:!1},'imageSmoothingEnabled'in this.context?this.renderSession.smoothProperty='imageSmoothingEnabled':'webkitImageSmoothingEnabled'in this.context?this.renderSession.smoothProperty='webkitImageSmoothingEnabled':'mozImageSmoothingEnabled'in this.context?this.renderSession.smoothProperty='mozImageSmoothingEnabled':'oImageSmoothingEnabled'in this.context?this.renderSession.smoothProperty='oImageSmoothingEnabled':'msImageSmoothingEnabled'in this.context&&(this.renderSession.smoothProperty='msImageSmoothingEnabled')};ti.prototype.constructor=ti,ti.prototype.setClearColor=function(t){this.clearColor=t},ti.prototype.render=function(t){t.updateTransform(),this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.renderSession.currentBlendMode='source-over',this.context.globalCompositeOperation='source-over',navigator.isCocoonJS&&this.domElement.screencanvas&&(this.context.fillStyle='black',this.context.clear()),this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width*this.resolution,this.height*this.resolution):(this.context.fillStyle=this.clearColor,this.context.fillRect(0,0,this.width*this.resolution,this.height*this.resolution))),this.renderObject(t)},ti.prototype.destroy=function(t){void 0===t&&(t=!0),t&&this.domElement.parentNode&&this.domElement.parentNode.removeChild(this.domElement),this.domElement=null,this.context=null,this.maskManager=null,this.renderSession=null,Tiny.defaultRenderer===this&&(Tiny.defaultRenderer=null)},ti.prototype.resize=function(t,i){this.width=t,this.height=i;var e=this.domElement;e.width=Math.floor(this.width*this.resolution),e.height=Math.floor(this.height*this.resolution),this.autoResize&&(e.style.width=t+'px',e.style.height=i+'px')},ti.prototype.setPixelRatio=function(t){this.resolution=t;var i=this.domElement;i.width=Math.floor(this.width*this.resolution),i.height=Math.floor(this.height*this.resolution)},ti.prototype.renderObject=function(t,i){this.renderSession.context=i||this.context,this.renderSession.resolution=this.resolution,t.render(this.renderSession)};var ii=function(){};ii.prototype.constructor=ii,ii.prototype.pushMask=function(t,i){var e=i.context;e.save();var s=t.alpha,r=t.worldTransform,n=i.resolution;e.setTransform(r.a*n,r.b*n,r.c*n,r.d*n,r.tx*n,r.ty*n),Tiny.CanvasGraphics.renderGraphicsMask(t,e),e.clip(),t.worldAlpha=s},ii.prototype.popMask=function(t){t.context.restore()};var ei,si,ri,ni=function(){};ni.getTintedTexture=function(t,i){var e=t.texture;if(e._tintCache||(e._tintCache={}),e._tintCache[i])return e._tintCache[i];var s=ni.canvas||document.createElement('canvas');(ni.tintMethod(e,i,s),ni.convertTintToImage)?(new Image).src=s.toDataURL():ni.canvas=null;return ni.cacheTint&&(e._tintCache[i]=s),s},ni.tintWithMultiply=function(t,i,e){var s=e.getContext('2d'),r=t.crop;e.width=r.width,e.height=r.height,s.fillStyle=i,s.fillRect(0,0,r.width,r.height),s.globalCompositeOperation='multiply',s.drawImage(t.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height),s.globalCompositeOperation='destination-atop',s.drawImage(t.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height)},ni.tintWithPerPixel=function(t,i,e){var s=e.getContext('2d'),r=t.crop;e.width=r.width,e.height=r.height,s.globalCompositeOperation='copy',s.drawImage(t.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height);for(var n=Tiny.hex2rgb(Tiny.style2hex(i)),h=n[0],a=n[1],o=n[2],u=s.getImageData(0,0,r.width,r.height),l=u.data,c=0;c<l.length;c+=4)if(l[c+0]*=h,l[c+1]*=a,l[c+2]*=o,!Tiny.canHandleAlpha){var d=l[c+3];l[c+0]/=255/d,l[c+1]/=255/d,l[c+2]/=255/d}s.putImageData(u,0,0)},ni.convertTintToImage=!1,ni.cacheTint=!1,Tiny.canHandleAlpha=function(){var t=new k(2,1,{willReadFrequently:!0});t.context.fillStyle='rgba(10, 20, 30, 0.5)',t.context.fillRect(0,0,1,1);var i=t.context.getImageData(0,0,1,1);t.context.putImageData(i,1,0);var e=t.context.getImageData(1,0,1,1);return e.data[0]===i.data[0]&&e.data[1]===i.data[1]&&e.data[2]===i.data[2]&&e.data[3]===i.data[3]}(),Tiny.supportNewBlendModes=(ei='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/',si='AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==',(ri=new Image).onload=function(){var t=new Image;t.onload=function(){var i=document.createElement('canvas');i.width=6,i.height=1;var e=i.getContext('2d',{willReadFrequently:!0});if(e.globalCompositeOperation='multiply',e.drawImage(ri,0,0),e.drawImage(t,2,0),!e.getImageData(2,0,1,1))return!1;var s=e.getImageData(2,0,1,1).data;Tiny.supportNewBlendModes=255===s[0]&&0===s[1]&&0===s[2],ni.tintMethod=ni.tintWithMultiply},t.src=ei+'/wCKxvRF'+si},ri.src=ei+'AP804Oa6'+si,!1),ni.tintMethod=Tiny.supportNewBlendModes?ni.tintWithMultiply:ni.tintWithPerPixel;var hi=function(){};hi.renderGraphics=function(t,i){var e=t.worldAlpha;t.dirty&&(this.updateGraphicsTint(t),t.dirty=!1);for(var s=0;s<t.graphicsData.length;s++){var r=t.graphicsData[s],n=r.shape,h=r._fillTint,a=r._lineTint;if(i.lineWidth=r.lineWidth,r.type===Tiny.Primitives.POLY){i.beginPath();var o=n.points;i.moveTo(o[0],o[1]);for(var u=1;u<o.length/2;u++)i.lineTo(o[2*u],o[2*u+1]);n.closed&&i.lineTo(o[0],o[1]),o[0]===o[o.length-2]&&o[1]===o[o.length-1]&&i.closePath(),r.fill&&(i.globalAlpha=r.fillAlpha*e,i.fillStyle=h,i.fill()),r.lineWidth&&(i.globalAlpha=r.lineAlpha*e,i.strokeStyle=a,i.stroke())}else if(r.type===Tiny.Primitives.RECT)r.fillColor&&(i.globalAlpha=r.fillAlpha*e,i.fillStyle=h,i.fillRect(n.x,n.y,n.width,n.height)),r.lineWidth&&(i.globalAlpha=r.lineAlpha*e,i.strokeStyle=a,i.strokeRect(n.x,n.y,n.width,n.height));else if(r.type===Tiny.Primitives.CIRC)i.beginPath(),i.arc(n.x,n.y,n.radius,0,2*Math.PI),i.closePath(),r.fill&&(i.globalAlpha=r.fillAlpha*e,i.fillStyle=h,i.fill()),r.lineWidth&&(i.globalAlpha=r.lineAlpha*e,i.strokeStyle=a,i.stroke());else if(r.type===Tiny.Primitives.ELIP){var l=2*n.width,c=2*n.height,d=n.x-l/2,p=n.y-c/2;i.beginPath();var f=.5522848,m=l/2*f,y=c/2*f,g=d+l,x=p+c,v=d+l/2,_=p+c/2;i.moveTo(d,_),i.bezierCurveTo(d,_-y,v-m,p,v,p),i.bezierCurveTo(v+m,p,g,_-y,g,_),i.bezierCurveTo(g,_+y,v+m,x,v,x),i.bezierCurveTo(v-m,x,d,_+y,d,_),i.closePath(),r.fill&&(i.globalAlpha=r.fillAlpha*e,i.fillStyle=h,i.fill()),r.lineWidth&&(i.globalAlpha=r.lineAlpha*e,i.strokeStyle=a,i.stroke())}else if(r.type===Tiny.Primitives.RREC){var w=n.x,b=n.y,M=n.width,T=n.height,A=n.radius,C=Math.min(M,T)/2|0;A=A>C?C:A,i.beginPath(),i.moveTo(w,b+A),i.lineTo(w,b+T-A),i.quadraticCurveTo(w,b+T,w+A,b+T),i.lineTo(w+M-A,b+T),i.quadraticCurveTo(w+M,b+T,w+M,b+T-A),i.lineTo(w+M,b+A),i.quadraticCurveTo(w+M,b,w+M-A,b),i.lineTo(w+A,b),i.quadraticCurveTo(w,b,w,b+A),i.closePath(),r.fillColor&&(i.globalAlpha=r.fillAlpha*e,i.fillStyle=h,i.fill()),r.lineWidth&&(i.globalAlpha=r.lineAlpha*e,i.strokeStyle=a,i.stroke())}}},hi.renderGraphicsMask=function(t,i){var e=t.graphicsData.length;if(0!==e){i.beginPath();for(var s=0;s<e;s++){var r=t.graphicsData[s],n=r.shape;if(r.type===Tiny.Primitives.POLY){var h=n.points;i.moveTo(h[0],h[1]);for(var a=1;a<h.length/2;a++)i.lineTo(h[2*a],h[2*a+1]);h[0]===h[h.length-2]&&h[1]===h[h.length-1]&&i.closePath()}else if(r.type===Tiny.Primitives.RECT)i.rect(n.x,n.y,n.width,n.height),i.closePath();else if(r.type===Tiny.Primitives.CIRC)i.arc(n.x,n.y,n.radius,0,2*Math.PI),i.closePath();else if(r.type===Tiny.Primitives.ELIP){var o=2*n.width,u=2*n.height,l=n.x-o/2,c=n.y-u/2,d=.5522848,p=o/2*d,f=u/2*d,m=l+o,y=c+u,g=l+o/2,x=c+u/2;i.moveTo(l,x),i.bezierCurveTo(l,x-f,g-p,c,g,c),i.bezierCurveTo(g+p,c,m,x-f,m,x),i.bezierCurveTo(m,x+f,g+p,y,g,y),i.bezierCurveTo(g-p,y,l,x+f,l,x),i.closePath()}else if(r.type===Tiny.Primitives.RREC){var v=n.x,_=n.y,w=n.width,b=n.height,M=n.radius,T=Math.min(w,b)/2|0;M=M>T?T:M,i.moveTo(v,_+M),i.lineTo(v,_+b-M),i.quadraticCurveTo(v,_+b,v+M,_+b),i.lineTo(v+w-M,_+b),i.quadraticCurveTo(v+w,_+b,v+w,_+b-M),i.lineTo(v+w,_+M),i.quadraticCurveTo(v+w,_,v+w-M,_),i.lineTo(v+M,_),i.quadraticCurveTo(v,_,v,_+M),i.closePath()}}}},hi.updateGraphicsTint=function(t){if('#ffffff'!==t.tint)for(var i=Tiny.style2hex(t.tint),e=(i>>16&255)/255,s=(i>>8&255)/255,r=(255&i)/255,n=0;n<t.graphicsData.length;n++){var h=t.graphicsData[n],a=Tiny.style2hex(h.fillColor),o=Tiny.style2hex(h.lineColor);h._fillTint=((a>>16&255)/255*e*255<<16)+((a>>8&255)/255*s*255<<8)+(255&a)/255*r*255,h._lineTint=((o>>16&255)/255*e*255<<16)+((o>>8&255)/255*s*255<<8)+(255&o)/255*r*255,h._fillTint=Tiny.hex2style(h._fillTint),h._lineTint=Tiny.hex2style(h._lineTint)}},Tiny.CanvasRenderer=ti,Tiny.CanvasMaskManager=ii,Tiny.CanvasTinter=ni,Tiny.CanvasGraphics=hi}()}();